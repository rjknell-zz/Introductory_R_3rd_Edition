<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Correlation analysis | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</title>
  <meta name="description" content="null" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Correlation analysis | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="null" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Correlation analysis | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  
  <meta name="twitter:description" content="null" />
  

<meta name="author" content="Rob Knell" />


<meta name="date" content="2020-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"/>
<link rel="next" href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introductory R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i><b>1.1</b> Why this book?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.2</b> How to use this book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-first-r-session.html"><a href="a-first-r-session.html"><i class="fa fa-check"></i><b>2</b> A first R session</a><ul>
<li class="chapter" data-level="2.1" data-path="a-first-r-session.html"><a href="a-first-r-session.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="a-first-r-session.html"><a href="a-first-r-session.html#a-first-r-session-1"><i class="fa fa-check"></i><b>2.2</b> A first R session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html"><i class="fa fa-check"></i><b>3</b> Basics: arithmetic, objects and functions</a><ul>
<li class="chapter" data-level="3.0.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#arithmetic"><i class="fa fa-check"></i><b>3.0.1</b> Arithmetic</a></li>
<li class="chapter" data-level="3.0.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#logical-operations"><i class="fa fa-check"></i><b>3.0.2</b> Logical operations</a></li>
<li class="chapter" data-level="3.0.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects"><i class="fa fa-check"></i><b>3.0.3</b> Objects</a></li>
<li class="chapter" data-level="3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#kinds-of-data"><i class="fa fa-check"></i><b>3.1</b> Kinds of data</a></li>
<li class="chapter" data-level="3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#whats-in-my-workspace"><i class="fa fa-check"></i><b>3.2</b> What’s in my workspace?</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations"><i class="fa fa-check"></i><b>3.3.1</b> Calculations</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-1"><i class="fa fa-check"></i><b>3.3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-1"><i class="fa fa-check"></i><b>3.3.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#answers-to-exercises"><i class="fa fa-check"></i><b>3.4</b> Answers to exercises</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations-1"><i class="fa fa-check"></i><b>3.4.1</b> Calculations</a></li>
<li class="chapter" data-level="3.4.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-2"><i class="fa fa-check"></i><b>3.4.2</b> Objects</a></li>
<li class="chapter" data-level="3.4.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-2"><i class="fa fa-check"></i><b>3.4.3</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html"><i class="fa fa-check"></i><b>4</b> Data: Vectors, Matrices and Data Frames</a><ul>
<li class="chapter" data-level="4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices"><i class="fa fa-check"></i><b>4.2</b> Matrices</a></li>
<li class="chapter" data-level="4.3" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#factors-and-data-frames"><i class="fa fa-check"></i><b>4.3</b> Factors and Data frames</a></li>
<li class="chapter" data-level="4.4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-1"><i class="fa fa-check"></i><b>4.4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-1"><i class="fa fa-check"></i><b>4.4.2</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#answers-to-exercises-1"><i class="fa fa-check"></i><b>4.5</b> Answers to exercises</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-2"><i class="fa fa-check"></i><b>4.5.1</b> Vectors</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-2"><i class="fa fa-check"></i><b>4.5.2</b> Matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html"><i class="fa fa-check"></i><b>5</b> Choosing data: subscripts and subsetting</a><ul>
<li class="chapter" data-level="5.0.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts"><i class="fa fa-check"></i><b>5.0.1</b> Subscripts</a></li>
<li class="chapter" data-level="5.0.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#boolean-logic-and-more-complex-subscripting"><i class="fa fa-check"></i><b>5.0.2</b> Boolean logic and more complex subscripting</a></li>
<li class="chapter" data-level="5.0.3" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-in-matrices-and-data-frames"><i class="fa fa-check"></i><b>5.0.3</b> Subscripts in matrices and data frames</a></li>
<li class="chapter" data-level="5.0.4" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subset"><i class="fa fa-check"></i><b>5.0.4</b> Subset</a></li>
<li class="chapter" data-level="5.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#exercises-2"><i class="fa fa-check"></i><b>5.1</b> Exercises</a><ul>
<li class="chapter" data-level="5.1.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors"><i class="fa fa-check"></i><b>5.1.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.1.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices"><i class="fa fa-check"></i><b>5.1.2</b> Subscripts and matrices</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#answers-to-exercises-2"><i class="fa fa-check"></i><b>5.2</b> Answers to exercises</a><ul>
<li class="chapter" data-level="5.2.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors-1"><i class="fa fa-check"></i><b>5.2.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.2.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices-1"><i class="fa fa-check"></i><b>5.2.2</b> Subscripts and matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html"><i class="fa fa-check"></i><b>6</b> R scripts and your R workflow</a><ul>
<li class="chapter" data-level="6.1" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#writing-and-using-r-scripts"><i class="fa fa-check"></i><b>6.1</b> Writing and using R scripts</a></li>
<li class="chapter" data-level="6.2" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-an-r-script-window"><i class="fa fa-check"></i><b>6.2</b> Running code from an R script window</a></li>
<li class="chapter" data-level="6.3" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-files-using-source"><i class="fa fa-check"></i><b>6.3</b> Running code from files using <code>source()</code></a></li>
<li class="chapter" data-level="6.4" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#workflow-structure-or-what-should-i-put-in-my-script"><i class="fa fa-check"></i><b>6.4</b> Workflow structure, or what should I put in my script?</a></li>
<li class="chapter" data-level="6.5" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#keep-it-neat-making-your-script-easy-to-read"><i class="fa fa-check"></i><b>6.5</b> Keep it neat — making your script easy to read</a></li>
<li class="chapter" data-level="6.6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#i-wish-i-hadnt-commented-my-code-so-much-said-no-one-ever-4."><i class="fa fa-check"></i><b>6.6</b> “I wish I hadn’t commented my code so much”, said no-one, ever.</a></li>
<li class="chapter" data-level="6.7" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#using-rstudio-to-write-scripts"><i class="fa fa-check"></i><b>6.7</b> Using RStudio to write scripts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html"><i class="fa fa-check"></i><b>7</b> Help files and packages</a><ul>
<li class="chapter" data-level="7.1" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html#using-the-help-files"><i class="fa fa-check"></i><b>7.1</b> Using the help files</a></li>
<li class="chapter" data-level="7.2" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html#packages"><i class="fa fa-check"></i><b>7.2</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>8</b> Importing Data</a><ul>
<li class="chapter" data-level="8.1" data-path="importing-data.html"><a href="importing-data.html#the-rules"><i class="fa fa-check"></i><b>8.1</b> The Rules</a></li>
<li class="chapter" data-level="8.2" data-path="importing-data.html"><a href="importing-data.html#importing-your-text-file"><i class="fa fa-check"></i><b>8.2</b> Importing your Text File</a><ul>
<li class="chapter" data-level="8.2.1" data-path="importing-data.html"><a href="importing-data.html#the-simple-way"><i class="fa fa-check"></i><b>8.2.1</b> The simple way</a></li>
<li class="chapter" data-level="8.2.2" data-path="importing-data.html"><a href="importing-data.html#the-less-simple-way"><i class="fa fa-check"></i><b>8.2.2</b> The less simple way</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="importing-data.html"><a href="importing-data.html#importing-character-data"><i class="fa fa-check"></i><b>8.3</b> Importing character data</a></li>
<li class="chapter" data-level="8.4" data-path="importing-data.html"><a href="importing-data.html#data-on-the-web"><i class="fa fa-check"></i><b>8.4</b> Data on the web</a></li>
<li class="chapter" data-level="8.5" data-path="importing-data.html"><a href="importing-data.html#using-read.table"><i class="fa fa-check"></i><b>8.5</b> Using <code>read.table()</code></a></li>
<li class="chapter" data-level="8.6" data-path="importing-data.html"><a href="importing-data.html#what-to-do-once-youve-managed-to-import-your-data."><i class="fa fa-check"></i><b>8.6</b> What to do once you’ve managed to import your data.</a></li>
<li class="chapter" data-level="8.7" data-path="importing-data.html"><a href="importing-data.html#importing-data-directly-from-excel"><i class="fa fa-check"></i><b>8.7</b> Importing data directly from Excel</a></li>
<li class="chapter" data-level="8.8" data-path="importing-data.html"><a href="importing-data.html#other-data-formats"><i class="fa fa-check"></i><b>8.8</b> Other data formats</a></li>
<li class="chapter" data-level="8.9" data-path="importing-data.html"><a href="importing-data.html#importing-data-into-rstudio"><i class="fa fa-check"></i><b>8.9</b> Importing data into RStudio</a></li>
<li class="chapter" data-level="8.10" data-path="importing-data.html"><a href="importing-data.html#to-attach-or-not-to-attach"><i class="fa fa-check"></i><b>8.10</b> To attach or not to attach?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><i class="fa fa-check"></i><b>9</b> R graphics I — drawing graphs and changing plot symbols and colours using the base graphics system</a><ul>
<li class="chapter" data-level="9.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#base-graphics-versus-ggplot2-versus-lattice-versus-whaaat"><i class="fa fa-check"></i><b>9.1</b> Base graphics versus ggplot2 versus lattice versus whaaat???</a></li>
<li class="chapter" data-level="9.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#base-graphics-example-ufo-reports-again"><i class="fa fa-check"></i><b>9.2</b> Base graphics example: UFO reports again</a></li>
<li class="chapter" data-level="9.3" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#scatterplots"><i class="fa fa-check"></i><b>9.3</b> Scatterplots</a></li>
<li class="chapter" data-level="9.4" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#plot-symbols"><i class="fa fa-check"></i><b>9.4</b> Plot symbols</a></li>
<li class="chapter" data-level="9.5" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#colours"><i class="fa fa-check"></i><b>9.5</b> Colours</a></li>
<li class="chapter" data-level="9.6" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#plotting-multiple-symbols-or-colours"><i class="fa fa-check"></i><b>9.6</b> Plotting multiple symbols or colours</a></li>
<li class="chapter" data-level="9.7" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#colour-palettes-in-r"><i class="fa fa-check"></i><b>9.7</b> Colour palettes in R</a></li>
<li class="chapter" data-level="9.8" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#using-transparency-in-your-graphs"><i class="fa fa-check"></i><b>9.8</b> Using transparency in your graphs</a></li>
<li class="chapter" data-level="9.9" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#histograms-and-multiple-plots-in-the-same-window"><i class="fa fa-check"></i><b>9.9</b> Histograms and multiple plots in the same window</a></li>
<li class="chapter" data-level="9.10" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#boxplots"><i class="fa fa-check"></i><b>9.10</b> Boxplots</a></li>
<li class="chapter" data-level="9.11" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#bar-charts"><i class="fa fa-check"></i><b>9.11</b> Bar charts</a><ul>
<li class="chapter" data-level="9.11.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#more-complex-barplots"><i class="fa fa-check"></i><b>9.11.1</b> More complex barplots</a></li>
</ul></li>
<li class="chapter" data-level="9.12" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#other-types-of-plot"><i class="fa fa-check"></i><b>9.12</b> Other types of plot</a><ul>
<li class="chapter" data-level="9.12.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#histogram-with-overlaid-probability-density-estimate"><i class="fa fa-check"></i><b>9.12.1</b> Histogram with overlaid probability density estimate</a></li>
<li class="chapter" data-level="9.12.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#pie-graph"><i class="fa fa-check"></i><b>9.12.2</b> Pie graph</a></li>
<li class="chapter" data-level="9.12.3" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#d-scatterplot"><i class="fa fa-check"></i><b>9.12.3</b> 3D scatterplot</a></li>
<li class="chapter" data-level="9.12.4" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#contour-plot"><i class="fa fa-check"></i><b>9.12.4</b> Contour plot</a></li>
</ul></li>
<li class="chapter" data-level="9.13" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#exporting-graphics"><i class="fa fa-check"></i><b>9.13</b> Exporting Graphics</a><ul>
<li class="chapter" data-level="9.13.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#the-easy-way"><i class="fa fa-check"></i><b>9.13.1</b> The easy way</a></li>
<li class="chapter" data-level="9.13.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#the-hard-way"><i class="fa fa-check"></i><b>9.13.2</b> The hard way</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html"><i class="fa fa-check"></i><b>10</b> R graphics II — Adding elements to an existing graph</a><ul>
<li class="chapter" data-level="10.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#simple-regression-lines"><i class="fa fa-check"></i><b>10.1</b> Simple regression lines</a></li>
<li class="chapter" data-level="10.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#multiple-regression-lines"><i class="fa fa-check"></i><b>10.2</b> Multiple regression lines</a></li>
<li class="chapter" data-level="10.3" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#legends"><i class="fa fa-check"></i><b>10.3</b> Legends</a></li>
<li class="chapter" data-level="10.4" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#curves"><i class="fa fa-check"></i><b>10.4</b> Curves</a><ul>
<li class="chapter" data-level="10.4.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-a-curve-using-curve"><i class="fa fa-check"></i><b>10.4.1</b> Adding a curve using <code>curve()</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-a-curve-using-lines-or-points."><i class="fa fa-check"></i><b>10.4.2</b> Adding a curve using <code>lines()</code> or <code>points()</code>.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#text-and-arrows"><i class="fa fa-check"></i><b>10.5</b> Text and arrows</a></li>
<li class="chapter" data-level="10.6" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#confidence-bands-for-fitted-lines"><i class="fa fa-check"></i><b>10.6</b> Confidence bands for fitted lines</a><ul>
<li class="chapter" data-level="10.6.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-confidence-bands-using-lines"><i class="fa fa-check"></i><b>10.6.1</b> Adding confidence bands using <code>lines()</code></a></li>
<li class="chapter" data-level="10.6.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-confidence-intervals-to-fitted-lines-using-polygon"><i class="fa fa-check"></i><b>10.6.2</b> Adding confidence intervals to fitted lines using <code>polygon()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#error-bars"><i class="fa fa-check"></i><b>10.7</b> Error bars</a><ul>
<li class="chapter" data-level="10.7.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-error-bars-using-arrows"><i class="fa fa-check"></i><b>10.7.1</b> Adding error bars using <code>arrows()</code></a></li>
<li class="chapter" data-level="10.7.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#plotting-means-and-error-bars-using-plotmeans"><i class="fa fa-check"></i><b>10.7.2</b> Plotting means and error bars using <code>plotmeans()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>11</b> Graphics with ggplot2</a><ul>
<li class="chapter" data-level="11.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#ggplot2-introduced"><i class="fa fa-check"></i><b>11.1</b> ggplot2 introduced</a></li>
<li class="chapter" data-level="11.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#scaling-axes-and-varying-colour-or-shapes-by-factor-levels"><i class="fa fa-check"></i><b>11.2</b> Scaling axes and varying colour or shapes by factor levels</a></li>
<li class="chapter" data-level="11.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>11.3</b> Facets</a></li>
<li class="chapter" data-level="11.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>11.4</b> Histograms</a></li>
<li class="chapter" data-level="11.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#boxplots-1"><i class="fa fa-check"></i><b>11.5</b> Boxplots</a></li>
<li class="chapter" data-level="11.6" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#final-word"><i class="fa fa-check"></i><b>11.6</b> Final word</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html"><i class="fa fa-check"></i><b>12</b> Basic Statistical Concepts</a><ul>
<li class="chapter" data-level="12.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#populations-and-samples"><i class="fa fa-check"></i><b>12.1</b> Populations and Samples</a></li>
<li class="chapter" data-level="12.2" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#descriptive-and-exploratory-statistics"><i class="fa fa-check"></i><b>12.2</b> Descriptive and exploratory statistics</a><ul>
<li class="chapter" data-level="12.2.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#maximum-and-minimum"><i class="fa fa-check"></i><b>12.2.1</b> Maximum and minimum</a></li>
<li class="chapter" data-level="12.2.2" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#frequency-distribution"><i class="fa fa-check"></i><b>12.2.2</b> Frequency distribution</a></li>
<li class="chapter" data-level="12.2.3" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#kinds-of-frequency-distribution"><i class="fa fa-check"></i><b>12.2.3</b> Kinds of frequency distribution</a></li>
<li class="chapter" data-level="12.2.4" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>12.2.4</b> Measures of central tendency</a></li>
<li class="chapter" data-level="12.2.5" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#measures-of-dispersion"><i class="fa fa-check"></i><b>12.2.5</b> Measures of dispersion</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#standard-errors-and-confidence-intervals"><i class="fa fa-check"></i><b>12.3</b> Standard errors and confidence intervals</a><ul>
<li class="chapter" data-level="12.3.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#code-used-to-draw-figure-6"><i class="fa fa-check"></i><b>12.3.1</b> Code used to draw figure 6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html"><i class="fa fa-check"></i><b>13</b> What is statistical testing?</a><ul>
<li class="chapter" data-level="13.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#the-problem"><i class="fa fa-check"></i><b>13.1</b> The problem</a></li>
<li class="chapter" data-level="13.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#statistical-testing-in-a-nutshell"><i class="fa fa-check"></i><b>13.2</b> Statistical testing in a nutshell</a><ul>
<li class="chapter" data-level="13.2.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#decide-on-the-null-and-alternative-hypotheses."><i class="fa fa-check"></i><b>13.2.1</b> Decide on the null and alternative hypotheses.</a></li>
<li class="chapter" data-level="13.2.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#calculate-the-size-of-the-effect."><i class="fa fa-check"></i><b>13.2.2</b> Calculate the size of the effect.</a></li>
<li class="chapter" data-level="13.2.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#transform-the-effect-size-so-that-we-can-compare-it-to-an-expected-distribution."><i class="fa fa-check"></i><b>13.2.3</b> Transform the effect size so that we can compare it to an expected distribution.</a></li>
<li class="chapter" data-level="13.2.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#ask-what-the-probability-is-of-observing-an-effect-as-big-or-bigger-than-the-one-we-have-seen-assuming-the-null-hypothesis-to-be-true."><i class="fa fa-check"></i><b>13.2.4</b> Ask what the probability is of observing an effect as big, or bigger than the one we have seen, assuming the null hypothesis to be true.</a></li>
<li class="chapter" data-level="13.2.5" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#think-about-what-the-result-means."><i class="fa fa-check"></i><b>13.2.5</b> Think about what the result means.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#how-a-statistical-test-works"><i class="fa fa-check"></i><b>13.3</b> How a statistical test works</a><ul>
<li class="chapter" data-level="13.3.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-1-generating-our-null-and-alternative-hypotheses."><i class="fa fa-check"></i><b>13.3.1</b> Step 1 generating our null and alternative hypotheses.</a></li>
<li class="chapter" data-level="13.3.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-2-calculating-the-size-of-the-effect"><i class="fa fa-check"></i><b>13.3.2</b> Step 2 calculating the size of the effect</a></li>
<li class="chapter" data-level="13.3.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-3-transforming-the-effect-size-so-that-we-can-compare-it-to-an-expected-distribution."><i class="fa fa-check"></i><b>13.3.3</b> Step 3 Transforming the effect size so that we can compare it to an expected distribution.</a></li>
<li class="chapter" data-level="13.3.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-4-what-is-the-probability-is-of-observing-an-effect-as-big-or-bigger-than-the-one-we-have-seen-assuming-the-null-hypothesis-to-be-true"><i class="fa fa-check"></i><b>13.3.4</b> Step 4 What is the probability is of observing an effect as big, or bigger than the one we have seen, assuming the null hypothesis to be true?</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#what-statistical-testing-does-and-doesnt-tell-us"><i class="fa fa-check"></i><b>13.4</b> What statistical testing does and doesn’t tell us</a></li>
<li class="chapter" data-level="13.5" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#code-used-to-draw-figure-5"><i class="fa fa-check"></i><b>13.5</b> Code used to draw figure 5</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><i class="fa fa-check"></i><b>14</b> The Chi-squared Test and a Classic Dataset on Smoking and Cancer</a><ul>
<li class="chapter" data-level="14.1" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#are-lung-cancer-patients-who-smoke-more-likely-to-be-heavy-smokers"><i class="fa fa-check"></i><b>14.1</b> Are lung cancer patients who smoke more likely to be heavy smokers?</a></li>
<li class="chapter" data-level="14.2" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#the-chi-squared-test"><i class="fa fa-check"></i><b>14.2</b> The Chi-squared test</a></li>
<li class="chapter" data-level="14.3" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#chi-squared-test-with-contingency-tables"><i class="fa fa-check"></i><b>14.3</b> Chi-squared test with contingency tables</a></li>
<li class="chapter" data-level="14.4" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#assumptions-and-limitations-of-the-chi-squared-test"><i class="fa fa-check"></i><b>14.4</b> Assumptions and limitations of the chi-squared test</a></li>
<li class="chapter" data-level="14.5" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#are-lung-cancer-patients-more-likely-to-be-smokers-than-controls"><i class="fa fa-check"></i><b>14.5</b> Are lung cancer patients more likely to be smokers than controls?</a></li>
<li class="chapter" data-level="14.6" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#fishers-exact-test"><i class="fa fa-check"></i><b>14.6</b> Fisher’s exact test</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><i class="fa fa-check"></i><b>15</b> Comparing immune responses between two caterpillar species using a t-test</a><ul>
<li class="chapter" data-level="15.1" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#assumptions-and-limitations-of-standard-parametric-statistics"><i class="fa fa-check"></i><b>15.1</b> Assumptions and limitations of standard parametric statistics</a><ul>
<li class="chapter" data-level="15.1.1" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#normal-errors."><i class="fa fa-check"></i><b>15.1.1</b> Normal errors.</a></li>
<li class="chapter" data-level="15.1.2" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#independence-of-data-points."><i class="fa fa-check"></i><b>15.1.2</b> Independence of data points.</a></li>
<li class="chapter" data-level="15.1.3" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#equal-variances."><i class="fa fa-check"></i><b>15.1.3</b> Equal variances.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#importing-the-data"><i class="fa fa-check"></i><b>15.2</b> Importing the Data</a></li>
<li class="chapter" data-level="15.3" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#descriptives-and-initial-exploration"><i class="fa fa-check"></i><b>15.3</b> Descriptives and Initial Exploration</a></li>
<li class="chapter" data-level="15.4" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#comparing-two-means-with-a-t-test"><i class="fa fa-check"></i><b>15.4</b> Comparing Two Means With a t-test</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="correlation-analysis.html"><a href="correlation-analysis.html"><i class="fa fa-check"></i><b>16</b> Correlation analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#calculating-the-correlation-coefficient"><i class="fa fa-check"></i><b>16.1</b> Calculating the correlation coefficient</a><ul>
<li class="chapter" data-level="16.1.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#interpreting-our-correlation-coefficient."><i class="fa fa-check"></i><b>16.1.1</b> Interpreting our correlation coefficient.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="correlation-analysis.html"><a href="correlation-analysis.html#statistical-significance-of-r"><i class="fa fa-check"></i><b>16.2</b> Statistical significance of <em>r</em></a></li>
<li class="chapter" data-level="16.3" data-path="correlation-analysis.html"><a href="correlation-analysis.html#assumptions-of-correlation-analysis"><i class="fa fa-check"></i><b>16.3</b> Assumptions of correlation analysis</a><ul>
<li class="chapter" data-level="16.3.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#comparing-correlations-between-swim-run-and-bike-splits"><i class="fa fa-check"></i><b>16.3.1</b> Comparing correlations between swim, run and bike splits</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="correlation-analysis.html"><a href="correlation-analysis.html#correlation-causality-sample-size-and-significance."><i class="fa fa-check"></i><b>16.4</b> Correlation, causality, sample size and significance.</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><i class="fa fa-check"></i><b>17</b> Using Linear Regression to Analyse TB trends in the UK</a><ul>
<li class="chapter" data-level="17.0.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#least-squares-line-fitting"><i class="fa fa-check"></i><b>17.0.1</b> Least squares line fitting</a></li>
<li class="chapter" data-level="17.0.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#significance-tests-for-linear-regression"><i class="fa fa-check"></i><b>17.0.2</b> Significance tests for linear regression</a></li>
<li class="chapter" data-level="17.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#bovine-tb"><i class="fa fa-check"></i><b>17.1</b> Bovine TB</a></li>
<li class="chapter" data-level="17.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#assumptions-of-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Assumptions of linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#diagnostic-plots"><i class="fa fa-check"></i><b>17.2.1</b> Diagnostic plots</a></li>
<li class="chapter" data-level="17.2.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#diagnostic-plots-for-our-m.bovis-regression"><i class="fa fa-check"></i><b>17.2.2</b> Diagnostic plots for our <em>M.bovis</em> regression</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#interpreting-our-regression-and-predicting-future-cases"><i class="fa fa-check"></i><b>17.3</b> Interpreting our regression and predicting future cases</a></li>
<li class="chapter" data-level="17.4" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#multi-drug-resistant-tb"><i class="fa fa-check"></i><b>17.4</b> Multi-drug resistant TB</a></li>
<li class="chapter" data-level="17.5" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#fitting-a-quadratic-model"><i class="fa fa-check"></i><b>17.5</b> Fitting a quadratic model</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="anova-and-football.html"><a href="anova-and-football.html"><i class="fa fa-check"></i><b>18</b> ANOVA and Football</a><ul>
<li class="chapter" data-level="18.1" data-path="anova-and-football.html"><a href="anova-and-football.html#analysis-of-variance"><i class="fa fa-check"></i><b>18.1</b> Analysis of Variance</a></li>
<li class="chapter" data-level="18.2" data-path="anova-and-football.html"><a href="anova-and-football.html#interpreting-anova-results"><i class="fa fa-check"></i><b>18.2</b> Interpreting ANOVA results</a></li>
<li class="chapter" data-level="18.3" data-path="anova-and-football.html"><a href="anova-and-football.html#what-makes-a-professional-footballer"><i class="fa fa-check"></i><b>18.3</b> What makes a professional footballer?</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html"><i class="fa fa-check"></i><b>19</b> Yeast sex and two factor ANOVA.</a><ul>
<li class="chapter" data-level="19.1" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#yeast-sexual-selection"><i class="fa fa-check"></i><b>19.1</b> Yeast sexual selection</a></li>
<li class="chapter" data-level="19.2" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#understanding-the-coefficients-table"><i class="fa fa-check"></i><b>19.2</b> Understanding the coefficients table</a></li>
<li class="chapter" data-level="19.3" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#which-statistical-tests-to-use-with-lm"><i class="fa fa-check"></i><b>19.3</b> Which statistical tests to use with <code>lm()</code>?</a></li>
<li class="chapter" data-level="19.4" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#diagnostics"><i class="fa fa-check"></i><b>19.4</b> Diagnostics</a></li>
<li class="chapter" data-level="19.5" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#visualising-the-data"><i class="fa fa-check"></i><b>19.5</b> Visualising the data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="correlation-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 16</span> Correlation analysis</h1>
<p>Correlation. Heaven and hell in science: how nice to be presenting your results at a conference and to be able to say “…and as predicted, we found an clear negative correlation, providing strong support for our theory and suggesting that the alternative theory put forward by Dr Smythe (<em>bloke who turned me down for a job three years ago</em>) is unlikely to be correct”, how unpleasant when you submit your results to the <em>Journal of Awesome Science</em>, they send it out for review (to Dr Smythe?) and the first line of the comments reads “Of course, since this is only a correlational study we have no indication of cause and effect: in my opinion it is extremely difficult to draw any conclusions at all from the data presented here…”.</p>
<p>For those not familiar with it, correlation analysis is a statistical technique for telling you the extent by which variation in one variable is associated with variation in another variable. Are low values of variable 1 generally associated with low values of variable 2, and high values of variable 2 generally found with high values of variable 1? If so, then we have a <em>positive correlation</em> - our values for variable 2 tend to get bigger as values for variable 1 get bigger. If it’s the other way around, and we have low values of variable 1 associated with high values of variable 2 then we have a <em>negative correlation</em>. In this chapter we’re going to deviate a little from the mostly biological and medical data we’ve looked at elsewhere to use correlation analysis to look at the results from the Ironman Triathlon World Championships in Hawaii from 2012, a set of data which we’ve briefly seen already when looking at graphics. Just to remind you, these are the results from a race which involves competitors swimming 3.8km, cycling 180km and then running a full marathon (42.195km). If you think about the three sports involved, you might expect that cycling and running performance should be more closely correlated than cycling and swimming or running and swimming, since cycling and running both use the leg muscles and swimming is much more dependent on arm and shoulder muscles. We’ll start by looking at how closely correlated the times for the swim and for the cycle (called the ‘splits’) are with each other: are good swimmers also good bikers?. Let’s load the data and check it using <code>str()</code>.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="correlation-analysis.html#cb458-1"></a>IMH&lt;-<span class="kw">read.table</span>(<span class="st">&quot;Data/IMH2012.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb458-2"><a href="correlation-analysis.html#cb458-2"></a><span class="kw">str</span>(IMH)</span>
<span id="cb458-3"><a href="correlation-analysis.html#cb458-3"></a><span class="st">&#39;data.frame&#39;</span><span class="op">:</span><span class="st">   </span><span class="dv">1879</span> obs. of  <span class="dv">6</span> variables<span class="op">:</span></span>
<span id="cb458-4"><a href="correlation-analysis.html#cb458-4"></a><span class="st"> </span><span class="er">$</span><span class="st"> </span>Gender  <span class="op">:</span><span class="st"> </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">2</span> levels <span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span><span class="op">:</span><span class="st"> </span><span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> ...</span>
<span id="cb458-5"><a href="correlation-analysis.html#cb458-5"></a> <span class="op">$</span><span class="st"> </span>Category<span class="op">:</span><span class="st"> </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">14</span> levels <span class="st">&quot;18-24&quot;</span>,<span class="st">&quot;25-29&quot;</span>,..<span class="op">:</span><span class="st"> </span><span class="dv">14</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">14</span> ...</span>
<span id="cb458-6"><a href="correlation-analysis.html#cb458-6"></a> <span class="op">$</span><span class="st"> </span>Swim    <span class="op">:</span><span class="st"> </span>num  <span class="fl">0.858</span> <span class="fl">0.921</span> <span class="fl">0.86</span> <span class="fl">0.922</span> <span class="fl">0.861</span> ...</span>
<span id="cb458-7"><a href="correlation-analysis.html#cb458-7"></a> <span class="op">$</span><span class="st"> </span>Bike    <span class="op">:</span><span class="st"> </span>num  <span class="fl">4.59</span> <span class="fl">4.61</span> <span class="fl">4.59</span> <span class="fl">4.56</span> <span class="fl">4.6</span> ...</span>
<span id="cb458-8"><a href="correlation-analysis.html#cb458-8"></a> <span class="op">$</span><span class="st"> </span>Run     <span class="op">:</span><span class="st"> </span>num  <span class="fl">2.8</span> <span class="fl">2.79</span> <span class="fl">2.88</span> <span class="fl">2.91</span> <span class="fl">2.95</span> ...</span>
<span id="cb458-9"><a href="correlation-analysis.html#cb458-9"></a> <span class="op">$</span><span class="st"> </span>Overall <span class="op">:</span><span class="st"> </span>num  <span class="fl">8.31</span> <span class="fl">8.39</span> <span class="fl">8.4</span> <span class="fl">8.45</span> <span class="fl">8.48</span> ...</span></code></pre></div>
<p>We have data for 1879 competitors, and for each one we have gender, category (Pro or an age class) and then we have their swim, bike and run split and their overall time. Let’s plot the relationship between swim time and bike time. As in the graphics chapter, we’re using an <em>alpha channel</em> to make the points a bit transparent to make the high-density areas of the graph with lots of overlap more obvious. The hex code we’re using is the one that corresponds to the “steelblue” colour, which you might have noticed I have a bit of thing for.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="correlation-analysis.html#cb459-1"></a><span class="kw">plot</span>(</span>
<span id="cb459-2"><a href="correlation-analysis.html#cb459-2"></a>  IMH<span class="op">$</span>Swim,</span>
<span id="cb459-3"><a href="correlation-analysis.html#cb459-3"></a>  IMH<span class="op">$</span>Overall,</span>
<span id="cb459-4"><a href="correlation-analysis.html#cb459-4"></a>  <span class="dt">pch =</span> <span class="dv">16</span>,</span>
<span id="cb459-5"><a href="correlation-analysis.html#cb459-5"></a>  <span class="dt">col =</span> <span class="st">&quot;#4682B4A0&quot;</span>,</span>
<span id="cb459-6"><a href="correlation-analysis.html#cb459-6"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Swim split (hours)&quot;</span>,</span>
<span id="cb459-7"><a href="correlation-analysis.html#cb459-7"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Bike split (hours)&quot;</span></span>
<span id="cb459-8"><a href="correlation-analysis.html#cb459-8"></a>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-470"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-470-1.png" alt="Bike split versus swim split for IM Hawaii 2012" width="672" />
<p class="caption">
Figure 16.1: Bike split versus swim split for IM Hawaii 2012
</p>
</div>
<p>Just looking at this you can see that there’s an obvious relationship between swim split and bike time. Fast swimmers tend to be fast bikers, and slow swimmers tend to be slow bikers. The data are rather bunched up towards the bottom left hand corner of the graph, however, and it might be useful to try to spread them out a little more. We can do this by log-transforming each value, which gives us a graph like this.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="correlation-analysis.html#cb460-1"></a><span class="kw">plot</span>(</span>
<span id="cb460-2"><a href="correlation-analysis.html#cb460-2"></a>  <span class="kw">log</span>(IMH<span class="op">$</span>Swim),</span>
<span id="cb460-3"><a href="correlation-analysis.html#cb460-3"></a>  <span class="kw">log</span>(IMH<span class="op">$</span>Bike),</span>
<span id="cb460-4"><a href="correlation-analysis.html#cb460-4"></a>  <span class="dt">pch =</span> <span class="dv">16</span>,</span>
<span id="cb460-5"><a href="correlation-analysis.html#cb460-5"></a>  <span class="dt">col =</span> <span class="st">&quot;#4682B4A0&quot;</span>,</span>
<span id="cb460-6"><a href="correlation-analysis.html#cb460-6"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Log swim split (hours)&quot;</span>,</span>
<span id="cb460-7"><a href="correlation-analysis.html#cb460-7"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Log bike split (hours)&quot;</span></span>
<span id="cb460-8"><a href="correlation-analysis.html#cb460-8"></a>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-471"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-471-1.png" alt="Log bike split versus log swim split for IM Hawaii 2012" width="672" />
<p class="caption">
Figure 16.2: Log bike split versus log swim split for IM Hawaii 2012
</p>
</div>
<p>We can just look at a graph and see the relationship, but we also want to quantify how close that relationship is. For this we want to calculate a statistic which goes by the grandiose name of <em>Pearson’s Product-Moment Correlation Coefficient</em>: that’s a bit of a mouthful so most people just call it a correlation coefficient, or just <em>r</em>.</p>
<div id="calculating-the-correlation-coefficient" class="section level2">
<h2><span class="header-section-number">16.1</span> Calculating the correlation coefficient</h2>
<p>Firstly, let’s draw our graph again, but this time divided up into four quadrants by the mean values for the swim split and the overall time.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="correlation-analysis.html#cb461-1"></a><span class="kw">plot</span>(</span>
<span id="cb461-2"><a href="correlation-analysis.html#cb461-2"></a>  <span class="kw">log</span>(IMH<span class="op">$</span>Swim),</span>
<span id="cb461-3"><a href="correlation-analysis.html#cb461-3"></a>  <span class="kw">log</span>(IMH<span class="op">$</span>Bike),</span>
<span id="cb461-4"><a href="correlation-analysis.html#cb461-4"></a>  <span class="dt">pch =</span> <span class="dv">16</span>,</span>
<span id="cb461-5"><a href="correlation-analysis.html#cb461-5"></a>  <span class="dt">col =</span> <span class="st">&quot;#4682B4A0&quot;</span>,</span>
<span id="cb461-6"><a href="correlation-analysis.html#cb461-6"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Log swim split (hours)&quot;</span>,</span>
<span id="cb461-7"><a href="correlation-analysis.html#cb461-7"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Log bike split (hours)&quot;</span></span>
<span id="cb461-8"><a href="correlation-analysis.html#cb461-8"></a>)</span>
<span id="cb461-9"><a href="correlation-analysis.html#cb461-9"></a></span>
<span id="cb461-10"><a href="correlation-analysis.html#cb461-10"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">mean</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Swim)), <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb461-11"><a href="correlation-analysis.html#cb461-11"></a></span>
<span id="cb461-12"><a href="correlation-analysis.html#cb461-12"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Bike)), <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-472"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-472-1.png" alt="Log bike split versus log swim split for IM Hawaii 2012" width="672" />
<p class="caption">
Figure 16.3: Log bike split versus log swim split for IM Hawaii 2012
</p>
</div>
<p>Just looking at the graph you can see that the majority of the data points are in the lower left hand and upper right hand quadrants, with fewer points in the upper left and lower right ones. This is what we expect with a positive correlation: data points with low <em>x</em> values (lower than the mean) tend also to have low <em>y</em> values, and so they are found in the part of the graph that is below the mean for both variables, and data points with high <em>x</em> values tend also to have high <em>y</em> values and since they have both <em>x</em> and <em>y</em> values that are greater than the respeoctive mean they are found in the top right quadrant. For a negative correlation the opposite would be the case, with many data points having high <em>y</em> values but low <em>x</em> values, and being in the top left quadrant, or having high <em>x</em> values but low <em>y</em> values and being in the bottom right quadrant.</p>
<p>We can use this to start to calculate our correlation coefficient. For each data point we can subtract the mean value of <em>x</em>, <span class="math inline">\(\bar{x}\)</span>, from the <em>x</em> value, and the mean value of <em>y</em>, <span class="math inline">\(\bar{y}\)</span>, from the <em>y</em> value, and multiply the two numbers that we get together. The sign of the number that we end up with will depend on the quadrant of the graph that it’s in.</p>
<table>
<thead>
<tr class="header">
<th align="left">Quadrant</th>
<th align="left"><span class="math inline">\(x - \bar{x}\)</span></th>
<th align="left"><span class="math inline">\(y-\bar{y}\)</span></th>
<th align="left"><span class="math inline">\(x - \bar{x} * y - \bar{y}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bottom left</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">Positive</td>
</tr>
<tr class="even">
<td align="left">Bottom right</td>
<td align="left">Positive</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
</tr>
<tr class="odd">
<td align="left">Top left</td>
<td align="left">Negative</td>
<td align="left">Positive</td>
<td align="left">Positive</td>
</tr>
<tr class="even">
<td align="left">Top right</td>
<td align="left">Positive</td>
<td align="left">Positive</td>
<td align="left">Positive</td>
</tr>
</tbody>
</table>
<p>
<img alt="" src="../Images/Ch10Table1.png" width="350" />
</p>
<p>If we calculate <span class="math inline">\(x - \bar{x} * y - \bar{y}\)</span> for each data point, and add them together, therefore, we should end up with a number which tells us something about the direction of any correlation in the data. If the sum of these values is positive then the general trend should be towards a positive correlation, and if negative then a negative correlation is indicated. Let’s work this out for our triathlon data.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="correlation-analysis.html#cb462-1"></a><span class="kw">sum</span>((<span class="kw">log</span>(IMH<span class="op">$</span>Swim) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Swim))) <span class="op">*</span><span class="st"> </span>(<span class="kw">log</span>(IMH<span class="op">$</span>Bike) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Bike))))</span>
<span id="cb462-2"><a href="correlation-analysis.html#cb462-2"></a>[<span class="dv">1</span>] <span class="fl">28.773</span></span></code></pre></div>
<p>As we might expect, the answer is a reasonably large positive number. That’s telling us something about the nature of the relationship between the two variables, but as it is it’s not a lot of use. Because it’s just the sum of all the values we calculated it will depend on the sample size: for two dataset with the same relationship between <em>x</em> and <em>y</em>, the one with the larger sample size will give a more positive or more negative value. We can correct this by dividing our number by the sample size, <em>n</em> to give us an average value that should stay roughly the same as the sample size goes up or down. In fact we divide by the <em>degrees of freedom</em> which in this case is <em>n-1</em>. This gives us a figure called the <em>covariance</em>.</p>
<p><span class="math display">\[ \Large cov_{x,y} = \frac{\sum{(x-\bar{x})(y-\bar{y})}}{n-1}\]</span></p>
<p>To understand why we divide by the degrees of freedom instead of just <em>n</em> it’s useful to think about calculating a correlation when <em>n</em>=1 - if we just divided by <em>n</em> then we would end up with a figure of zero for our covariance, implying that there is neither a positive nor a negative relationship between <em>x</em> and <em>y</em>. This is not correct — in fact, we cannot make an estimate of the covariance between <em>x</em> and <em>y</em> if we only have a sample size of 1, and of dividing by n-1 gives us a division by zero so we cannot compute an answer.</p>
<p>The covariance for the dataset we’re interested in at the moment is easy to calculate.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="correlation-analysis.html#cb463-1"></a>cov1 &lt;-</span>
<span id="cb463-2"><a href="correlation-analysis.html#cb463-2"></a><span class="st">  </span><span class="kw">sum</span>((<span class="kw">log</span>(IMH<span class="op">$</span>Swim) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Swim))) <span class="op">*</span><span class="st"> </span>(<span class="kw">log</span>(IMH<span class="op">$</span>Bike) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Bike)))) <span class="op">/</span></span>
<span id="cb463-3"><a href="correlation-analysis.html#cb463-3"></a><span class="st">  </span>(<span class="kw">length</span>(IMH<span class="op">$</span>Swim) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb463-4"><a href="correlation-analysis.html#cb463-4"></a></span>
<span id="cb463-5"><a href="correlation-analysis.html#cb463-5"></a>cov1</span>
<span id="cb463-6"><a href="correlation-analysis.html#cb463-6"></a>[<span class="dv">1</span>] <span class="fl">0.015321</span></span></code></pre></div>
<p>This gives us a more useful statistic to help us understand the patterns in our data, but it’s still not especially useful for making comparisons between data sets because the value of the covariance will be determined by the variances of the <em>x</em> and <em>y</em> variables: a dataset with small variances will return a smaller value for the covariance than one with large variances. What we can do to correct for this is divide the covariance itself by the product of the standard deviations of the two variables <span class="math inline">\(s_{x}s_{y}\)</span>. This will <em>standardise</em> our covariance to a value between -1 and 1, giving us the Pearson’s Product Moment Correlation Coefficient, or <em>r</em>.</p>
<p><span class="math display">\[ \Large r = \frac{\sum{(x-\bar{x})(y-\bar{y})}}{n-1}/s_{x}s_{y}\]</span></p>
<p>We can calculate this easily from our covariance, which we’ve already calculated.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="correlation-analysis.html#cb464-1"></a>cor1 &lt;-<span class="st"> </span>cov1 <span class="op">/</span><span class="st"> </span>(<span class="kw">sd</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Swim)) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Bike)))</span>
<span id="cb464-2"><a href="correlation-analysis.html#cb464-2"></a></span>
<span id="cb464-3"><a href="correlation-analysis.html#cb464-3"></a>cor1</span>
<span id="cb464-4"><a href="correlation-analysis.html#cb464-4"></a>[<span class="dv">1</span>] <span class="fl">0.72254</span></span></code></pre></div>
<p>Of course, we don’t have to go through all of these calculations every time we want to calculate <em>r</em>. We can use the <code>cor()</code> function.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="correlation-analysis.html#cb465-1"></a><span class="kw">cor</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Swim), <span class="kw">log</span>(IMH<span class="op">$</span>Bike))</span>
<span id="cb465-2"><a href="correlation-analysis.html#cb465-2"></a>[<span class="dv">1</span>] <span class="fl">0.72254</span></span></code></pre></div>
<p>Gratifyingly this gives us exactly the same result to 4 decimal places.</p>
<div id="interpreting-our-correlation-coefficient." class="section level3">
<h3><span class="header-section-number">16.1.1</span> Interpreting our correlation coefficient.</h3>
<p>The interpetation of <em>r</em> is straightforward. If <em>r</em> is close to one then there is close to a perfect positive correlation, if it is zero there is no correlation and if it is close to -1 there is a nearly perfect negative correlation. Here are some figures to illustrate this.</p>
<div class="figure"><span id="fig:corr4"></span>
<img src="3rd_Edition_files/figure-html/corr4-1.png" alt="Strong and weak positive correlation" width="768" />
<p class="caption">
Figure 16.4: Strong and weak positive correlation
</p>
</div>
<div class="figure"><span id="fig:corr4a"></span>
<img src="3rd_Edition_files/figure-html/corr4a-1.png" alt="Strong and weak negative correlation" width="768" />
<p class="caption">
Figure 16.5: Strong and weak negative correlation
</p>
</div>
<div class="figure"><span id="fig:corr4b"></span>
<img src="3rd_Edition_files/figure-html/corr4b-1.png" alt="No correlation" width="384" />
<p class="caption">
Figure 16.6: No correlation
</p>
</div>
<p>One useful extension of our calculation of <em>r</em> is to calculate <em>r^2</em>. This is a value which is properly called the <em>coefficient of determination</em> but in practise everyone calls it “r-squared”. What r^2 tells us is the proportion of the variance in one variable which is accounted for by the variance in the other variable, so it’s a measure of how good a job one variable does in predicting the other. If r^2 is near to one then you have a very tight correlation and can predict <em>y</em> quite precisely if you know <em>x</em>. If r^2 is near to one then you’re probably also not an ecologist, or if you are you’re worried that you’ve done something wrong.</p>
</div>
</div>
<div id="statistical-significance-of-r" class="section level2">
<h2><span class="header-section-number">16.2</span> Statistical significance of <em>r</em></h2>
<p>We can test for the statistical significance of our estimate of <em>r</em> by doing a t-test, because if you do some algebra you can show that it’s possible to calculate a t-statistic from <em>r</em> as follows.</p>
<p><span class="math display">\[\Large t = \frac{r \sqrt{n-2}}{1-r^2}\]</span></p>
<p>If the null hypothesis, which in this case would be that there is no correlation between <em>x</em> and <em>y</em> is true then we would expect this value to be distributed on a t-distribution with <em>n-2</em> degrees of freedom. If we’re using R then we can do this using the <code>cor.test()</code> function.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="correlation-analysis.html#cb466-1"></a><span class="kw">cor.test</span>(<span class="kw">log</span>(IMH<span class="op">$</span>Swim), <span class="kw">log</span>(IMH<span class="op">$</span>Bike))</span>
<span id="cb466-2"><a href="correlation-analysis.html#cb466-2"></a></span>
<span id="cb466-3"><a href="correlation-analysis.html#cb466-3"></a>    Pearson<span class="st">&#39;s product-moment correlation</span></span>
<span id="cb466-4"><a href="correlation-analysis.html#cb466-4"></a></span>
<span id="cb466-5"><a href="correlation-analysis.html#cb466-5"></a><span class="st">data:  log(IMH$Swim) and log(IMH$Bike)</span></span>
<span id="cb466-6"><a href="correlation-analysis.html#cb466-6"></a><span class="st">t = 45.3, df = 1877, p-value &lt;2e-16</span></span>
<span id="cb466-7"><a href="correlation-analysis.html#cb466-7"></a><span class="st">alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb466-8"><a href="correlation-analysis.html#cb466-8"></a><span class="st">95 percent confidence interval:</span></span>
<span id="cb466-9"><a href="correlation-analysis.html#cb466-9"></a><span class="st"> 0.70020 0.74347</span></span>
<span id="cb466-10"><a href="correlation-analysis.html#cb466-10"></a><span class="st">sample estimates:</span></span>
<span id="cb466-11"><a href="correlation-analysis.html#cb466-11"></a><span class="st">    cor </span></span>
<span id="cb466-12"><a href="correlation-analysis.html#cb466-12"></a><span class="st">0.72254 </span></span></code></pre></div>
<p>The output from this gives us our t-test, and the statistical significance of our correlation turns out, unsurprisingly, to be a very small number indeed, meaning that we can provisionally reject the null hypothesis and accept the alternative. We also get the 95% confidence intervals for our estimate of <em>r</em>, which can be useful for all sorts of things.</p>
</div>
<div id="assumptions-of-correlation-analysis" class="section level2">
<h2><span class="header-section-number">16.3</span> Assumptions of correlation analysis</h2>
<p>The analysis we’ve used here is only really valid if our data meet three criteria. Firstly, this analysis assumes that both <em>x</em> and <em>y</em> variables are at least approximately normally distributed, and severe deviation from this is likely to cause problems. It’s worth noting here that this is one of the few analyses that assumes that the actual data are normally distributed, not that the <em>errors</em> are normal: there are sections on this in the assumptions sections of several of the other chapters. Secondly, it is assumed that the variannce in <em>y</em> stays roughly the same across the range of values of <em>x</em>, and <em>vice-versa</em>. If this is not the case (i.e. if the data look like the figure below) then this can cause spuriously high estimates of <em>r</em> to be produced. See the chapter on <em>linear regression</em> for more on this problem of <em>heteroscedasticity</em>.</p>
<div class="figure"><span id="fig:unnamed-chunk-478"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-478-1.png" alt="Example of data where the variance of y increases as x increases" width="672" />
<p class="caption">
Figure 16.7: Example of data where the variance of y increases as x increases
</p>
</div>
<p>Finally, this analysis assumes that the relationship between <em>x</em> and <em>y</em> is at least approximately a straight line. If the relationship is curved then a correlation analysis doesn’t mean much, and if it’s very curved then a correlation analysis can be quite misleading as shown below.</p>
<div class="figure"><span id="fig:unnamed-chunk-479"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-479-1.png" alt="Non-linear relationship between X and Y. In this case the correlation coefficient is -0.02, which is not even approaching being significantly different from zero (p=0.8). If you look at the graph you can clearly see the relationship between X and Y however." width="672" />
<p class="caption">
Figure 16.8: Non-linear relationship between X and Y. In this case the correlation coefficient is -0.02, which is not even approaching being significantly different from zero (p=0.8). If you look at the graph you can clearly see the relationship between X and Y however.
</p>
</div>
<div id="comparing-correlations-between-swim-run-and-bike-splits" class="section level3">
<h3><span class="header-section-number">16.3.1</span> Comparing correlations between swim, run and bike splits</h3>
<p>Now we’ve worked out our correlation coefficient for the correlation between swim times and bike times, but we also want to know about some other correlations, especially the ones between bike time and run time and swim time and run time. One thing to know about <code>cor()</code> is that if you feed it more than two numerical variables it will give you a correlation coefficient for all the pairwise comparisons, so we can give it the third, fourth and fifth columns in our data frame like this.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="correlation-analysis.html#cb467-1"></a><span class="kw">cor</span>(IMH[,<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb467-2"><a href="correlation-analysis.html#cb467-2"></a>        Swim    Bike     Run</span>
<span id="cb467-3"><a href="correlation-analysis.html#cb467-3"></a>Swim <span class="fl">1.00000</span> <span class="fl">0.72227</span> <span class="fl">0.59835</span></span>
<span id="cb467-4"><a href="correlation-analysis.html#cb467-4"></a>Bike <span class="fl">0.72227</span> <span class="fl">1.00000</span> <span class="fl">0.76019</span></span>
<span id="cb467-5"><a href="correlation-analysis.html#cb467-5"></a>Run  <span class="fl">0.59835</span> <span class="fl">0.76019</span> <span class="fl">1.00000</span></span></code></pre></div>
<p>Since <code>cor()</code> gives us <em>all</em> the pairwise comparisons you can see from the diagonal going from top right to bottom left that swim time perfectly correlates with swim time, and bike time with bike time… but the numbers we want are in the part of the matrix above the diagonal. You can see that bike time and run time are about as closely correlated as bike time and swim time, but that swim time and run time are correlated rather less well. So good swim times are associated with good bike times, and good bike times are associated with good run times, and good swim times are still somewhat associated with good run times but to a lesser extent than the other two relationships.</p>
</div>
</div>
<div id="correlation-causality-sample-size-and-significance." class="section level2">
<h2><span class="header-section-number">16.4</span> Correlation, causality, sample size and significance.</h2>
<p>You’ll hear it in every introductory statistics class, but it’s worth repeating: <em>correlation does not imply causality</em>. Just because <em>y</em> is correlated with <em>x</em>, it does not follow that <em>x</em> causes <em>y</em>. It is quite possible that a strong correlation is caused by a third variable which we haven’t measured. In the case of our swim and run splits, it’s not likely that swimming ability is causing the athletes to ride their bikes at a certain speed: the correlation is likely to reflect the athlete’s overall fitness plus a contribution from gender and age. This is an example where it’s fairly obvious that <em>x</em> does not cause <em>y</em>, but in other cases it can be easy to fall into the trap of attributing causality when you have only found a correlation. If you want to be confident about causality you need to do an experiment.</p>
<div class="figure"><span id="fig:unnamed-chunk-481"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-481-1.png" alt="Example of a 'spurious correlation' showing why care must be taken in interpreting correlations even when the relationship is strong (r is 0.98 for this relationship). While it might seem at first that use of Microsoft Internet Explorer is driving the US murder rate, if you look at the years you can see that in fact each is declining over time: the 'third variable' that each is correlated with is the year, and in fact there is no direct relationship between web browser choice and homicide." width="672" />
<p class="caption">
Figure 16.9: Example of a ‘spurious correlation’ showing why care must be taken in interpreting correlations even when the relationship is strong (r is 0.98 for this relationship). While it might seem at first that use of Microsoft Internet Explorer is driving the US murder rate, if you look at the years you can see that in fact each is declining over time: the ‘third variable’ that each is correlated with is the year, and in fact there is no direct relationship between web browser choice and homicide.
</p>
</div>
<p>A final caveat is that when you’re thinking about correlations it’s important to remember that statistical significance doesn’t tell you how strong the correlation is: with a large sample size it’s possible for a very weak correlation indeed to have statistical significance. You should always look at the <em>r</em> value or the <em>r^2</em> when you’re trying to work out what a correlation means. The constant media reporting of very large epidemiological studies finding correlations between everything you eat or do and either an increased or decreased risk of cancer (see <a href="http://www.anorak.co.uk/288298/scare-stories/the-daily-mails-list-of-things-that-give-you-cancer-from-a-to-z.html/">http://www.anorak.co.uk/288298/scare-stories/the-daily-mails-list-of-things-that-give-you-cancer-from-a-to-z.html/</a>) is at least partly driven by this: the next time someone tells you that yoga, bananas, coffee or underarm deodorant will either cure or cause cancer then the first thing to ask is what the <em>effect size</em> is: how strong is the relationship that has been found? The next thing to do, of course, is to emulate Dr Smythe and ask about causality.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["3rd_Edition.pdf", "3rd_Edition.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
