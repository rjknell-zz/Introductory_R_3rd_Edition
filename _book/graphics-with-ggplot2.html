<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Graphics with ggplot2 | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</title>
  <meta name="description" content="null" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Graphics with ggplot2 | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="null" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Graphics with ggplot2 | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  
  <meta name="twitter:description" content="null" />
  

<meta name="author" content="Rob Knell" />


<meta name="date" content="2020-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-graphics-ii-adding-elements-to-an-existing-graph.html"/>
<link rel="next" href="basic-statistical-concepts.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introductory R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i><b>1.1</b> Why this book?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.2</b> How to use this book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-first-r-session.html"><a href="a-first-r-session.html"><i class="fa fa-check"></i><b>2</b> A first R session</a><ul>
<li class="chapter" data-level="2.1" data-path="a-first-r-session.html"><a href="a-first-r-session.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="a-first-r-session.html"><a href="a-first-r-session.html#a-first-r-session-1"><i class="fa fa-check"></i><b>2.2</b> A first R session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html"><i class="fa fa-check"></i><b>3</b> Basics: arithmetic, objects and functions</a><ul>
<li class="chapter" data-level="3.0.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#arithmetic"><i class="fa fa-check"></i><b>3.0.1</b> Arithmetic</a></li>
<li class="chapter" data-level="3.0.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#logical-operations"><i class="fa fa-check"></i><b>3.0.2</b> Logical operations</a></li>
<li class="chapter" data-level="3.0.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects"><i class="fa fa-check"></i><b>3.0.3</b> Objects</a></li>
<li class="chapter" data-level="3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#kinds-of-data"><i class="fa fa-check"></i><b>3.1</b> Kinds of data</a></li>
<li class="chapter" data-level="3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#whats-in-my-workspace"><i class="fa fa-check"></i><b>3.2</b> What’s in my workspace?</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations"><i class="fa fa-check"></i><b>3.3.1</b> Calculations</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-1"><i class="fa fa-check"></i><b>3.3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-1"><i class="fa fa-check"></i><b>3.3.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#answers-to-exercises"><i class="fa fa-check"></i><b>3.4</b> Answers to exercises</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations-1"><i class="fa fa-check"></i><b>3.4.1</b> Calculations</a></li>
<li class="chapter" data-level="3.4.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-2"><i class="fa fa-check"></i><b>3.4.2</b> Objects</a></li>
<li class="chapter" data-level="3.4.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-2"><i class="fa fa-check"></i><b>3.4.3</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html"><i class="fa fa-check"></i><b>4</b> Data: Vectors, Matrices and Data Frames</a><ul>
<li class="chapter" data-level="4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices"><i class="fa fa-check"></i><b>4.2</b> Matrices</a></li>
<li class="chapter" data-level="4.3" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#factors-and-data-frames"><i class="fa fa-check"></i><b>4.3</b> Factors and Data frames</a></li>
<li class="chapter" data-level="4.4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-1"><i class="fa fa-check"></i><b>4.4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-1"><i class="fa fa-check"></i><b>4.4.2</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#answers-to-exercises-1"><i class="fa fa-check"></i><b>4.5</b> Answers to exercises</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-2"><i class="fa fa-check"></i><b>4.5.1</b> Vectors</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-2"><i class="fa fa-check"></i><b>4.5.2</b> Matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html"><i class="fa fa-check"></i><b>5</b> Choosing data: subscripts and subsetting</a><ul>
<li class="chapter" data-level="5.0.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts"><i class="fa fa-check"></i><b>5.0.1</b> Subscripts</a></li>
<li class="chapter" data-level="5.0.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#boolean-logic-and-more-complex-subscripting"><i class="fa fa-check"></i><b>5.0.2</b> Boolean logic and more complex subscripting</a></li>
<li class="chapter" data-level="5.0.3" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-in-matrices-and-data-frames"><i class="fa fa-check"></i><b>5.0.3</b> Subscripts in matrices and data frames</a></li>
<li class="chapter" data-level="5.0.4" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subset"><i class="fa fa-check"></i><b>5.0.4</b> Subset</a></li>
<li class="chapter" data-level="5.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#exercises-2"><i class="fa fa-check"></i><b>5.1</b> Exercises</a><ul>
<li class="chapter" data-level="5.1.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors"><i class="fa fa-check"></i><b>5.1.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.1.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices"><i class="fa fa-check"></i><b>5.1.2</b> Subscripts and matrices</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#answers-to-exercises-2"><i class="fa fa-check"></i><b>5.2</b> Answers to exercises</a><ul>
<li class="chapter" data-level="5.2.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors-1"><i class="fa fa-check"></i><b>5.2.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.2.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices-1"><i class="fa fa-check"></i><b>5.2.2</b> Subscripts and matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html"><i class="fa fa-check"></i><b>6</b> R scripts and your R workflow</a><ul>
<li class="chapter" data-level="6.1" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#writing-and-using-r-scripts"><i class="fa fa-check"></i><b>6.1</b> Writing and using R scripts</a></li>
<li class="chapter" data-level="6.2" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-an-r-script-window"><i class="fa fa-check"></i><b>6.2</b> Running code from an R script window</a></li>
<li class="chapter" data-level="6.3" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-files-using-source"><i class="fa fa-check"></i><b>6.3</b> Running code from files using <code>source()</code></a></li>
<li class="chapter" data-level="6.4" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#workflow-structure-or-what-should-i-put-in-my-script"><i class="fa fa-check"></i><b>6.4</b> Workflow structure, or what should I put in my script?</a></li>
<li class="chapter" data-level="6.5" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#keep-it-neat-making-your-script-easy-to-read"><i class="fa fa-check"></i><b>6.5</b> Keep it neat — making your script easy to read</a></li>
<li class="chapter" data-level="6.6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#i-wish-i-hadnt-commented-my-code-so-much-said-no-one-ever-4."><i class="fa fa-check"></i><b>6.6</b> “I wish I hadn’t commented my code so much”, said no-one, ever.</a></li>
<li class="chapter" data-level="6.7" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#using-rstudio-to-write-scripts"><i class="fa fa-check"></i><b>6.7</b> Using RStudio to write scripts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html"><i class="fa fa-check"></i><b>7</b> Help files and packages</a><ul>
<li class="chapter" data-level="7.1" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html#using-the-help-files"><i class="fa fa-check"></i><b>7.1</b> Using the help files</a></li>
<li class="chapter" data-level="7.2" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html#packages"><i class="fa fa-check"></i><b>7.2</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>8</b> Importing Data</a><ul>
<li class="chapter" data-level="8.1" data-path="importing-data.html"><a href="importing-data.html#the-rules"><i class="fa fa-check"></i><b>8.1</b> The Rules</a></li>
<li class="chapter" data-level="8.2" data-path="importing-data.html"><a href="importing-data.html#importing-your-text-file"><i class="fa fa-check"></i><b>8.2</b> Importing your Text File</a><ul>
<li class="chapter" data-level="8.2.1" data-path="importing-data.html"><a href="importing-data.html#the-simple-way"><i class="fa fa-check"></i><b>8.2.1</b> The simple way</a></li>
<li class="chapter" data-level="8.2.2" data-path="importing-data.html"><a href="importing-data.html#the-less-simple-way"><i class="fa fa-check"></i><b>8.2.2</b> The less simple way</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="importing-data.html"><a href="importing-data.html#importing-character-data"><i class="fa fa-check"></i><b>8.3</b> Importing character data</a></li>
<li class="chapter" data-level="8.4" data-path="importing-data.html"><a href="importing-data.html#data-on-the-web"><i class="fa fa-check"></i><b>8.4</b> Data on the web</a></li>
<li class="chapter" data-level="8.5" data-path="importing-data.html"><a href="importing-data.html#using-read.table"><i class="fa fa-check"></i><b>8.5</b> Using <code>read.table()</code></a></li>
<li class="chapter" data-level="8.6" data-path="importing-data.html"><a href="importing-data.html#what-to-do-once-youve-managed-to-import-your-data."><i class="fa fa-check"></i><b>8.6</b> What to do once you’ve managed to import your data.</a></li>
<li class="chapter" data-level="8.7" data-path="importing-data.html"><a href="importing-data.html#importing-data-directly-from-excel"><i class="fa fa-check"></i><b>8.7</b> Importing data directly from Excel</a></li>
<li class="chapter" data-level="8.8" data-path="importing-data.html"><a href="importing-data.html#other-data-formats"><i class="fa fa-check"></i><b>8.8</b> Other data formats</a></li>
<li class="chapter" data-level="8.9" data-path="importing-data.html"><a href="importing-data.html#importing-data-into-rstudio"><i class="fa fa-check"></i><b>8.9</b> Importing data into RStudio</a></li>
<li class="chapter" data-level="8.10" data-path="importing-data.html"><a href="importing-data.html#to-attach-or-not-to-attach"><i class="fa fa-check"></i><b>8.10</b> To attach or not to attach?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><i class="fa fa-check"></i><b>9</b> R graphics I — drawing graphs and changing plot symbols and colours using the base graphics system</a><ul>
<li class="chapter" data-level="9.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#base-graphics-versus-ggplot2-versus-lattice-versus-whaaat"><i class="fa fa-check"></i><b>9.1</b> Base graphics versus ggplot2 versus lattice versus whaaat???</a></li>
<li class="chapter" data-level="9.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#base-graphics-example-ufo-reports-again"><i class="fa fa-check"></i><b>9.2</b> Base graphics example: UFO reports again</a></li>
<li class="chapter" data-level="9.3" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#scatterplots"><i class="fa fa-check"></i><b>9.3</b> Scatterplots</a></li>
<li class="chapter" data-level="9.4" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#plot-symbols"><i class="fa fa-check"></i><b>9.4</b> Plot symbols</a></li>
<li class="chapter" data-level="9.5" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#colours"><i class="fa fa-check"></i><b>9.5</b> Colours</a></li>
<li class="chapter" data-level="9.6" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#plotting-multiple-symbols-or-colours"><i class="fa fa-check"></i><b>9.6</b> Plotting multiple symbols or colours</a></li>
<li class="chapter" data-level="9.7" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#colour-palettes-in-r"><i class="fa fa-check"></i><b>9.7</b> Colour palettes in R</a></li>
<li class="chapter" data-level="9.8" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#using-transparency-in-your-graphs"><i class="fa fa-check"></i><b>9.8</b> Using transparency in your graphs</a></li>
<li class="chapter" data-level="9.9" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#histograms-and-multiple-plots-in-the-same-window"><i class="fa fa-check"></i><b>9.9</b> Histograms and multiple plots in the same window</a></li>
<li class="chapter" data-level="9.10" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#boxplots"><i class="fa fa-check"></i><b>9.10</b> Boxplots</a></li>
<li class="chapter" data-level="9.11" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#bar-charts"><i class="fa fa-check"></i><b>9.11</b> Bar charts</a><ul>
<li class="chapter" data-level="9.11.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#more-complex-barplots"><i class="fa fa-check"></i><b>9.11.1</b> More complex barplots</a></li>
</ul></li>
<li class="chapter" data-level="9.12" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#other-types-of-plot"><i class="fa fa-check"></i><b>9.12</b> Other types of plot</a><ul>
<li class="chapter" data-level="9.12.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#histogram-with-overlaid-probability-density-estimate"><i class="fa fa-check"></i><b>9.12.1</b> Histogram with overlaid probability density estimate</a></li>
<li class="chapter" data-level="9.12.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#pie-graph"><i class="fa fa-check"></i><b>9.12.2</b> Pie graph</a></li>
<li class="chapter" data-level="9.12.3" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#d-scatterplot"><i class="fa fa-check"></i><b>9.12.3</b> 3D scatterplot</a></li>
<li class="chapter" data-level="9.12.4" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#contour-plot"><i class="fa fa-check"></i><b>9.12.4</b> Contour plot</a></li>
</ul></li>
<li class="chapter" data-level="9.13" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#exporting-graphics"><i class="fa fa-check"></i><b>9.13</b> Exporting Graphics</a><ul>
<li class="chapter" data-level="9.13.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#the-easy-way"><i class="fa fa-check"></i><b>9.13.1</b> The easy way</a></li>
<li class="chapter" data-level="9.13.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#the-hard-way"><i class="fa fa-check"></i><b>9.13.2</b> The hard way</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html"><i class="fa fa-check"></i><b>10</b> R graphics II — Adding elements to an existing graph</a><ul>
<li class="chapter" data-level="10.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#simple-regression-lines"><i class="fa fa-check"></i><b>10.1</b> Simple regression lines</a></li>
<li class="chapter" data-level="10.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#multiple-regression-lines"><i class="fa fa-check"></i><b>10.2</b> Multiple regression lines</a></li>
<li class="chapter" data-level="10.3" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#legends"><i class="fa fa-check"></i><b>10.3</b> Legends</a></li>
<li class="chapter" data-level="10.4" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#curves"><i class="fa fa-check"></i><b>10.4</b> Curves</a><ul>
<li class="chapter" data-level="10.4.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-a-curve-using-curve"><i class="fa fa-check"></i><b>10.4.1</b> Adding a curve using <code>curve()</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-a-curve-using-lines-or-points."><i class="fa fa-check"></i><b>10.4.2</b> Adding a curve using <code>lines()</code> or <code>points()</code>.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#text-and-arrows"><i class="fa fa-check"></i><b>10.5</b> Text and arrows</a></li>
<li class="chapter" data-level="10.6" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#confidence-bands-for-fitted-lines"><i class="fa fa-check"></i><b>10.6</b> Confidence bands for fitted lines</a><ul>
<li class="chapter" data-level="10.6.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-confidence-bands-using-lines"><i class="fa fa-check"></i><b>10.6.1</b> Adding confidence bands using <code>lines()</code></a></li>
<li class="chapter" data-level="10.6.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-confidence-intervals-to-fitted-lines-using-polygon"><i class="fa fa-check"></i><b>10.6.2</b> Adding confidence intervals to fitted lines using <code>polygon()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#error-bars"><i class="fa fa-check"></i><b>10.7</b> Error bars</a><ul>
<li class="chapter" data-level="10.7.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-error-bars-using-arrows"><i class="fa fa-check"></i><b>10.7.1</b> Adding error bars using <code>arrows()</code></a></li>
<li class="chapter" data-level="10.7.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#plotting-means-and-error-bars-using-plotmeans"><i class="fa fa-check"></i><b>10.7.2</b> Plotting means and error bars using <code>plotmeans()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>11</b> Graphics with ggplot2</a><ul>
<li class="chapter" data-level="11.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#ggplot2-introduced"><i class="fa fa-check"></i><b>11.1</b> ggplot2 introduced</a></li>
<li class="chapter" data-level="11.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#scaling-axes-and-varying-colour-or-shapes-by-factor-levels"><i class="fa fa-check"></i><b>11.2</b> Scaling axes and varying colour or shapes by factor levels</a></li>
<li class="chapter" data-level="11.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>11.3</b> Facets</a></li>
<li class="chapter" data-level="11.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>11.4</b> Histograms</a></li>
<li class="chapter" data-level="11.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#boxplots-1"><i class="fa fa-check"></i><b>11.5</b> Boxplots</a></li>
<li class="chapter" data-level="11.6" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#final-word"><i class="fa fa-check"></i><b>11.6</b> Final word</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html"><i class="fa fa-check"></i><b>12</b> Basic Statistical Concepts</a><ul>
<li class="chapter" data-level="12.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#populations-and-samples"><i class="fa fa-check"></i><b>12.1</b> Populations and Samples</a></li>
<li class="chapter" data-level="12.2" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#descriptive-and-exploratory-statistics"><i class="fa fa-check"></i><b>12.2</b> Descriptive and exploratory statistics</a><ul>
<li class="chapter" data-level="12.2.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#maximum-and-minimum"><i class="fa fa-check"></i><b>12.2.1</b> Maximum and minimum</a></li>
<li class="chapter" data-level="12.2.2" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#frequency-distribution"><i class="fa fa-check"></i><b>12.2.2</b> Frequency distribution</a></li>
<li class="chapter" data-level="12.2.3" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#kinds-of-frequency-distribution"><i class="fa fa-check"></i><b>12.2.3</b> Kinds of frequency distribution</a></li>
<li class="chapter" data-level="12.2.4" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>12.2.4</b> Measures of central tendency</a></li>
<li class="chapter" data-level="12.2.5" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#measures-of-dispersion"><i class="fa fa-check"></i><b>12.2.5</b> Measures of dispersion</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#standard-errors-and-confidence-intervals"><i class="fa fa-check"></i><b>12.3</b> Standard errors and confidence intervals</a><ul>
<li class="chapter" data-level="12.3.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#code-used-to-draw-figure-6"><i class="fa fa-check"></i><b>12.3.1</b> Code used to draw figure 6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html"><i class="fa fa-check"></i><b>13</b> What is statistical testing?</a><ul>
<li class="chapter" data-level="13.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#the-problem"><i class="fa fa-check"></i><b>13.1</b> The problem</a></li>
<li class="chapter" data-level="13.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#statistical-testing-in-a-nutshell"><i class="fa fa-check"></i><b>13.2</b> Statistical testing in a nutshell</a><ul>
<li class="chapter" data-level="13.2.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#decide-on-the-null-and-alternative-hypotheses."><i class="fa fa-check"></i><b>13.2.1</b> Decide on the null and alternative hypotheses.</a></li>
<li class="chapter" data-level="13.2.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#calculate-the-size-of-the-effect."><i class="fa fa-check"></i><b>13.2.2</b> Calculate the size of the effect.</a></li>
<li class="chapter" data-level="13.2.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#transform-the-effect-size-so-that-we-can-compare-it-to-an-expected-distribution."><i class="fa fa-check"></i><b>13.2.3</b> Transform the effect size so that we can compare it to an expected distribution.</a></li>
<li class="chapter" data-level="13.2.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#ask-what-the-probability-is-of-observing-an-effect-as-big-or-bigger-than-the-one-we-have-seen-assuming-the-null-hypothesis-to-be-true."><i class="fa fa-check"></i><b>13.2.4</b> Ask what the probability is of observing an effect as big, or bigger than the one we have seen, assuming the null hypothesis to be true.</a></li>
<li class="chapter" data-level="13.2.5" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#think-about-what-the-result-means."><i class="fa fa-check"></i><b>13.2.5</b> Think about what the result means.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#how-a-statistical-test-works"><i class="fa fa-check"></i><b>13.3</b> How a statistical test works</a><ul>
<li class="chapter" data-level="13.3.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-1-generating-our-null-and-alternative-hypotheses."><i class="fa fa-check"></i><b>13.3.1</b> Step 1 generating our null and alternative hypotheses.</a></li>
<li class="chapter" data-level="13.3.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-2-calculating-the-size-of-the-effect"><i class="fa fa-check"></i><b>13.3.2</b> Step 2 calculating the size of the effect</a></li>
<li class="chapter" data-level="13.3.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-3-transforming-the-effect-size-so-that-we-can-compare-it-to-an-expected-distribution."><i class="fa fa-check"></i><b>13.3.3</b> Step 3 Transforming the effect size so that we can compare it to an expected distribution.</a></li>
<li class="chapter" data-level="13.3.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-4-what-is-the-probability-is-of-observing-an-effect-as-big-or-bigger-than-the-one-we-have-seen-assuming-the-null-hypothesis-to-be-true"><i class="fa fa-check"></i><b>13.3.4</b> Step 4 What is the probability is of observing an effect as big, or bigger than the one we have seen, assuming the null hypothesis to be true?</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#what-statistical-testing-does-and-doesnt-tell-us"><i class="fa fa-check"></i><b>13.4</b> What statistical testing does and doesn’t tell us</a></li>
<li class="chapter" data-level="13.5" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#code-used-to-draw-figure-5"><i class="fa fa-check"></i><b>13.5</b> Code used to draw figure 5</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><i class="fa fa-check"></i><b>14</b> The Chi-squared Test and a Classic Dataset on Smoking and Cancer</a><ul>
<li class="chapter" data-level="14.1" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#are-lung-cancer-patients-who-smoke-more-likely-to-be-heavy-smokers"><i class="fa fa-check"></i><b>14.1</b> Are lung cancer patients who smoke more likely to be heavy smokers?</a></li>
<li class="chapter" data-level="14.2" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#the-chi-squared-test"><i class="fa fa-check"></i><b>14.2</b> The Chi-squared test</a></li>
<li class="chapter" data-level="14.3" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#chi-squared-test-with-contingency-tables"><i class="fa fa-check"></i><b>14.3</b> Chi-squared test with contingency tables</a></li>
<li class="chapter" data-level="14.4" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#assumptions-and-limitations-of-the-chi-squared-test"><i class="fa fa-check"></i><b>14.4</b> Assumptions and limitations of the chi-squared test</a></li>
<li class="chapter" data-level="14.5" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#are-lung-cancer-patients-more-likely-to-be-smokers-than-controls"><i class="fa fa-check"></i><b>14.5</b> Are lung cancer patients more likely to be smokers than controls?</a></li>
<li class="chapter" data-level="14.6" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#fishers-exact-test"><i class="fa fa-check"></i><b>14.6</b> Fisher’s exact test</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><i class="fa fa-check"></i><b>15</b> Comparing immune responses between two caterpillar species using a t-test</a><ul>
<li class="chapter" data-level="15.1" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#assumptions-and-limitations-of-standard-parametric-statistics"><i class="fa fa-check"></i><b>15.1</b> Assumptions and limitations of standard parametric statistics</a><ul>
<li class="chapter" data-level="15.1.1" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#normal-errors."><i class="fa fa-check"></i><b>15.1.1</b> Normal errors.</a></li>
<li class="chapter" data-level="15.1.2" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#independence-of-data-points."><i class="fa fa-check"></i><b>15.1.2</b> Independence of data points.</a></li>
<li class="chapter" data-level="15.1.3" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#equal-variances."><i class="fa fa-check"></i><b>15.1.3</b> Equal variances.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#importing-the-data"><i class="fa fa-check"></i><b>15.2</b> Importing the Data</a></li>
<li class="chapter" data-level="15.3" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#descriptives-and-initial-exploration"><i class="fa fa-check"></i><b>15.3</b> Descriptives and Initial Exploration</a></li>
<li class="chapter" data-level="15.4" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#comparing-two-means-with-a-t-test"><i class="fa fa-check"></i><b>15.4</b> Comparing Two Means With a t-test</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="correlation-analysis.html"><a href="correlation-analysis.html"><i class="fa fa-check"></i><b>16</b> Correlation analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#calculating-the-correlation-coefficient"><i class="fa fa-check"></i><b>16.1</b> Calculating the correlation coefficient</a><ul>
<li class="chapter" data-level="16.1.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#interpreting-our-correlation-coefficient."><i class="fa fa-check"></i><b>16.1.1</b> Interpreting our correlation coefficient.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="correlation-analysis.html"><a href="correlation-analysis.html#statistical-significance-of-r"><i class="fa fa-check"></i><b>16.2</b> Statistical significance of <em>r</em></a></li>
<li class="chapter" data-level="16.3" data-path="correlation-analysis.html"><a href="correlation-analysis.html#assumptions-of-correlation-analysis"><i class="fa fa-check"></i><b>16.3</b> Assumptions of correlation analysis</a><ul>
<li class="chapter" data-level="16.3.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#comparing-correlations-between-swim-run-and-bike-splits"><i class="fa fa-check"></i><b>16.3.1</b> Comparing correlations between swim, run and bike splits</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="correlation-analysis.html"><a href="correlation-analysis.html#correlation-causality-sample-size-and-significance."><i class="fa fa-check"></i><b>16.4</b> Correlation, causality, sample size and significance.</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><i class="fa fa-check"></i><b>17</b> Using Linear Regression to Analyse TB trends in the UK</a><ul>
<li class="chapter" data-level="17.0.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#least-squares-line-fitting"><i class="fa fa-check"></i><b>17.0.1</b> Least squares line fitting</a></li>
<li class="chapter" data-level="17.0.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#significance-tests-for-linear-regression"><i class="fa fa-check"></i><b>17.0.2</b> Significance tests for linear regression</a></li>
<li class="chapter" data-level="17.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#bovine-tb"><i class="fa fa-check"></i><b>17.1</b> Bovine TB</a></li>
<li class="chapter" data-level="17.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#assumptions-of-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Assumptions of linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#diagnostic-plots"><i class="fa fa-check"></i><b>17.2.1</b> Diagnostic plots</a></li>
<li class="chapter" data-level="17.2.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#diagnostic-plots-for-our-m.bovis-regression"><i class="fa fa-check"></i><b>17.2.2</b> Diagnostic plots for our <em>M.bovis</em> regression</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#interpreting-our-regression-and-predicting-future-cases"><i class="fa fa-check"></i><b>17.3</b> Interpreting our regression and predicting future cases</a></li>
<li class="chapter" data-level="17.4" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#multi-drug-resistant-tb"><i class="fa fa-check"></i><b>17.4</b> Multi-drug resistant TB</a></li>
<li class="chapter" data-level="17.5" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#fitting-a-quadratic-model"><i class="fa fa-check"></i><b>17.5</b> Fitting a quadratic model</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="anova-and-football.html"><a href="anova-and-football.html"><i class="fa fa-check"></i><b>18</b> ANOVA and Football</a><ul>
<li class="chapter" data-level="18.1" data-path="anova-and-football.html"><a href="anova-and-football.html#analysis-of-variance"><i class="fa fa-check"></i><b>18.1</b> Analysis of Variance</a></li>
<li class="chapter" data-level="18.2" data-path="anova-and-football.html"><a href="anova-and-football.html#interpreting-anova-results"><i class="fa fa-check"></i><b>18.2</b> Interpreting ANOVA results</a></li>
<li class="chapter" data-level="18.3" data-path="anova-and-football.html"><a href="anova-and-football.html#what-makes-a-professional-footballer"><i class="fa fa-check"></i><b>18.3</b> What makes a professional footballer?</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html"><i class="fa fa-check"></i><b>19</b> Yeast sex and two factor ANOVA.</a><ul>
<li class="chapter" data-level="19.1" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#yeast-sexual-selection"><i class="fa fa-check"></i><b>19.1</b> Yeast sexual selection</a></li>
<li class="chapter" data-level="19.2" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#understanding-the-coefficients-table"><i class="fa fa-check"></i><b>19.2</b> Understanding the coefficients table</a></li>
<li class="chapter" data-level="19.3" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#which-statistical-tests-to-use-with-lm"><i class="fa fa-check"></i><b>19.3</b> Which statistical tests to use with <code>lm()</code>?</a></li>
<li class="chapter" data-level="19.4" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#diagnostics"><i class="fa fa-check"></i><b>19.4</b> Diagnostics</a></li>
<li class="chapter" data-level="19.5" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#visualising-the-data"><i class="fa fa-check"></i><b>19.5</b> Visualising the data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics-with-ggplot2" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Graphics with ggplot2</h1>
<div id="ggplot2-introduced" class="section level2">
<h2><span class="header-section-number">11.1</span> ggplot2 introduced</h2>
<p>ggplot2 is a package for R which allows you to produce graphics in a completely different way to base graphics. It was originally published by <a href="https://en.wikipedia.org/wiki/Hadley_Wickham">Hadley Wickham</a> in 2005 and was inspired by a book called The Grammar of Graphics (hence <strong>GG</strong>plot2) written by <a href="https://en.wikipedia.org/wiki/Leland_Wilkinson">Leland Wilkinson</a>. Whereas the base-R graphics system is sometimes a bit, hmmmm, organically grown (i.e. having to use <code>arrows()</code> to draw confidence intervals), ggplot2 follows a logical framework where data visualisation is broken down into components such as the data which is used for the graph, the geometric shapes which are used to represent the data and the scales which are used to map the data to the geometric shapes. Returning to the UFO data which we used an example in chapter 8, here is the code to draw the plot in base R:</p>
<pre><code>&#39;data.frame&#39;:   907 obs. of  2 variables:
 $ Reports: Date, format: &quot;2019-03-01&quot; &quot;2019-02-01&quot; ...
 $ Count  : int  250 195 317 237 233 266 300 357 406 226 ...</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="graphics-with-ggplot2.html#cb345-1"></a><span class="kw">plot</span>(UFO<span class="op">$</span>Count <span class="op">~</span><span class="st"> </span>UFO<span class="op">$</span>Reports,</span>
<span id="cb345-2"><a href="graphics-with-ggplot2.html#cb345-2"></a>     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb345-3"><a href="graphics-with-ggplot2.html#cb345-3"></a>     <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb345-4"><a href="graphics-with-ggplot2.html#cb345-4"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb345-5"><a href="graphics-with-ggplot2.html#cb345-5"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>,</span>
<span id="cb345-6"><a href="graphics-with-ggplot2.html#cb345-6"></a>     <span class="dt">main  =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-343-1.png" width="672" /></p>
<p>Here is the code which will draw an equivalent graph in ggplot2. We’ll see the finished graph later but for the moment let’s look at the code.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="graphics-with-ggplot2.html#cb346-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, <span class="dt">y =</span> Count)) <span class="op">+</span></span>
<span id="cb346-2"><a href="graphics-with-ggplot2.html#cb346-2"></a><span class="st">               </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb346-3"><a href="graphics-with-ggplot2.html#cb346-3"></a><span class="st">               </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb346-4"><a href="graphics-with-ggplot2.html#cb346-4"></a><span class="st">               </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb346-5"><a href="graphics-with-ggplot2.html#cb346-5"></a>                    <span class="dt">y =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>, </span>
<span id="cb346-6"><a href="graphics-with-ggplot2.html#cb346-6"></a>                    <span class="dt">title =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</span>
<span id="cb346-7"><a href="graphics-with-ggplot2.html#cb346-7"></a></span>
<span id="cb346-8"><a href="graphics-with-ggplot2.html#cb346-8"></a>p1</span></code></pre></div>
<p>Some things are familiar, some are not so. The first unfamilar thing is that with ggplot2 you can save your plot as an R object and if you just enter the object name it will display it in the plot window. This means that you can modify the plot once you’ve saved it as an object, which gives a degree of flexibility that’s not available with a base graphics plot. Let’s have a look at some of the code we used for the rest of the plot.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="graphics-with-ggplot2.html#cb347-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, </span>
<span id="cb347-2"><a href="graphics-with-ggplot2.html#cb347-2"></a>                             <span class="dt">y =</span> Count))</span></code></pre></div>
<p>The first thing we do is use the <code>ggplot()</code> function to specify the <em>data</em> and the <em>aesthetic</em> for our plot. For the data you have to use a data frame (or the tidyverse equivalent, a tibble): you can’t, for example, plot two vectors in the workspace against each other as you can with base R graphics. The second argument that <code>ggplot()</code> takes, <code>aes()</code>, specifies the “aesthetic” — this is how the data are <em>mapped</em> to the geometric objects which constitute the plot. Here we’re doing this by telling ggplot2 which variables should constitute the x- and the y-variables in our plot. You can also have mappings of colours or plot symbol shapes to data here as well: we’ll see examples of these later on in the chapter. So far so good, but if we were to try to plot our object from just this one function call we would get an error message. That’s because we haven’t yet told ggplot2 how we want these data plotted — do we want a scatterplot, a line plot, or something more exotic?</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="graphics-with-ggplot2.html#cb348-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, </span>
<span id="cb348-2"><a href="graphics-with-ggplot2.html#cb348-2"></a>                             <span class="dt">y =</span> Count)) <span class="op">+</span></span>
<span id="cb348-3"><a href="graphics-with-ggplot2.html#cb348-3"></a><span class="st">               </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p>This demonstrates how we can ask ggplot2 to draw us a line graph. We just use the plus sign to add something to our object, and then use the <code>geom_line()</code> function to ask for a line graph. The line is a type of <em>geometric object</em> and these are specified as <em>geom</em>s in ggplot2. Common geoms include <code>geom_boxplot()</code>, <code>geom_histogram()</code> and <code>geom_points()</code> which will draw boxplots, histograms and scatterplots respectively. There are many other options for geoms and a full list is <a href="https://ggplot2.tidyverse.org/reference/index.html">here</a>.</p>
<p>You can see that we’ve asked for a particular colour within our <code>geom_line()</code> function call. The reason it’s here rather than in the <code>aes()</code> call is a bit technical but essentially we’re just asking for one colour and not mapping it to something in the data: if this is the case then it goes in the <code>geom...</code> call. Usually.</p>
<p>Let’s look at what we get if we plot this graph.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="graphics-with-ggplot2.html#cb349-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, </span>
<span id="cb349-2"><a href="graphics-with-ggplot2.html#cb349-2"></a>                             <span class="dt">y =</span> Count)) <span class="op">+</span></span>
<span id="cb349-3"><a href="graphics-with-ggplot2.html#cb349-3"></a><span class="st">               </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb349-4"><a href="graphics-with-ggplot2.html#cb349-4"></a>p1</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-347-1.png" width="672" />
The graph is plotted on a grey background with major and minor grid lines and without lines for the axes or a box around the plot. This is the default <em>theme</em> for ggplot2 where the <em>theme</em> defines those things that affect the overall appearance of the plot: background, grid lines, font for the text and so on. Some people like this theme (<code>theme-gray()</code>, but I do not and my personal preference is to use another theme called <code>theme_bw()</code> which gives a less intrusive background. There are a number of other themes included in ggplot2 including <code>theme_dark()</code> with a much darker background, <code>theme_classic()</code> with a set of xy axes and no gridlines and <code>theme_minimal()</code> with some faint gridlines but not much else.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="graphics-with-ggplot2.html#cb350-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, </span>
<span id="cb350-2"><a href="graphics-with-ggplot2.html#cb350-2"></a>                             <span class="dt">y =</span> Count)) <span class="op">+</span></span>
<span id="cb350-3"><a href="graphics-with-ggplot2.html#cb350-3"></a><span class="st">               </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb350-4"><a href="graphics-with-ggplot2.html#cb350-4"></a><span class="st">               </span><span class="kw">theme_bw</span>()</span>
<span id="cb350-5"><a href="graphics-with-ggplot2.html#cb350-5"></a></span>
<span id="cb350-6"><a href="graphics-with-ggplot2.html#cb350-6"></a>p1</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-348-1.png" width="672" />
Finally, we add the axis labels and the title using <code>labs()</code>. You can also add individual labels separately, so <code>xlab()</code>, <code>ylab()</code> and <code>ggtitle()</code> will add axis labels and a title for you if you’d prefer that. Putting these together gives our finished plot:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="graphics-with-ggplot2.html#cb351-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, </span>
<span id="cb351-2"><a href="graphics-with-ggplot2.html#cb351-2"></a>                             <span class="dt">y =</span> Count)) <span class="op">+</span></span>
<span id="cb351-3"><a href="graphics-with-ggplot2.html#cb351-3"></a><span class="st">               </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb351-4"><a href="graphics-with-ggplot2.html#cb351-4"></a><span class="st">               </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb351-5"><a href="graphics-with-ggplot2.html#cb351-5"></a><span class="st">               </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb351-6"><a href="graphics-with-ggplot2.html#cb351-6"></a>                    <span class="dt">y =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>, </span>
<span id="cb351-7"><a href="graphics-with-ggplot2.html#cb351-7"></a>                    <span class="dt">title =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</span>
<span id="cb351-8"><a href="graphics-with-ggplot2.html#cb351-8"></a></span>
<span id="cb351-9"><a href="graphics-with-ggplot2.html#cb351-9"></a>p1</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-349-1.png" width="672" /></p>
<p>That’s a goog looking graph, and hopefully you’ve seen the logical process by which a ggplot2 graph is built up. What we’ve seen so far is:</p>
<ul>
<li>Specify the <em>data</em> which the graph is to be drawn from</li>
<li>The <em>aesthetic</em> maps the data to the geometric objects which the graph is drawn with — in our case via telling ggplot2 which variables are plotted on which axes and what colour we want</li>
<li>The geometric objects are selected using <em>geom…</em></li>
<li>The overall look of the graph is determined by selecting a <em>theme</em>, and we make sure our graph labels make sense using <code>labs()</code>.</li>
</ul>
<p>Other things we haven’t seen yet are the use of further geoms to add extra <em>layers</em>, <em>scaling</em>, <em>statistical transformations</em> of the data, the use of <em>coordinate systems</em> to change the way the data are mapped onto the graph and the use of <em>facets</em> to produce multiple graphs split by (for example) factor levels.</p>
<p>Let’s start with adding extra layers. Our UFO graph is quite informative but the plotted line simply connects each data point and is very noisy because of the strong seasonal signal in these data. Rather then just doing a join-the-dots graph, maybe we should plot the data as points and then put something over the top which summarises these data. We can do the former by using <code>geom_point()</code> and the latter by using <code>geom_smooth()</code>. Let’s start with just the points</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="graphics-with-ggplot2.html#cb352-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, </span>
<span id="cb352-2"><a href="graphics-with-ggplot2.html#cb352-2"></a>                             <span class="dt">y =</span> Count)) <span class="op">+</span></span>
<span id="cb352-3"><a href="graphics-with-ggplot2.html#cb352-3"></a><span class="st">               </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb352-4"><a href="graphics-with-ggplot2.html#cb352-4"></a><span class="st">               </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb352-5"><a href="graphics-with-ggplot2.html#cb352-5"></a>                    <span class="dt">y =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>, </span>
<span id="cb352-6"><a href="graphics-with-ggplot2.html#cb352-6"></a>                    <span class="dt">title =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</span>
<span id="cb352-7"><a href="graphics-with-ggplot2.html#cb352-7"></a></span>
<span id="cb352-8"><a href="graphics-with-ggplot2.html#cb352-8"></a>p1</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-350-1.png" width="672" /></p>
<p>I didn’t specify a theme, a colour or a plot symbol so we get the default options for a scatterplot which you can see here. This is OK but the solid symbols mean that a lot of the data just appear as a blob where the symbols are overplotted and the black is a bit lifeless. How about this.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="graphics-with-ggplot2.html#cb353-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, </span>
<span id="cb353-2"><a href="graphics-with-ggplot2.html#cb353-2"></a>                             <span class="dt">y =</span> Count)) <span class="op">+</span></span>
<span id="cb353-3"><a href="graphics-with-ggplot2.html#cb353-3"></a><span class="st">               </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>, </span>
<span id="cb353-4"><a href="graphics-with-ggplot2.html#cb353-4"></a>                          <span class="dt">colour =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb353-5"><a href="graphics-with-ggplot2.html#cb353-5"></a>                          <span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span></span>
<span id="cb353-6"><a href="graphics-with-ggplot2.html#cb353-6"></a><span class="st">               </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb353-7"><a href="graphics-with-ggplot2.html#cb353-7"></a><span class="st">               </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb353-8"><a href="graphics-with-ggplot2.html#cb353-8"></a>                    <span class="dt">y =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>, </span>
<span id="cb353-9"><a href="graphics-with-ggplot2.html#cb353-9"></a>                    <span class="dt">title =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</span>
<span id="cb353-10"><a href="graphics-with-ggplot2.html#cb353-10"></a></span>
<span id="cb353-11"><a href="graphics-with-ggplot2.html#cb353-11"></a>p1</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-351-1.png" width="672" /></p>
<p>I’ve added three arguments to <code>geom_point()</code>: firstly <code>shape = 1</code> which tells ggplot2 which plot symbol to use. The plot symbol numbering is the same as for base R graphics and here I’ve asked for symbol 1 which is the open circle. The second argument is <code>colour = "steelblue"</code> which is self-explanatory (NB if you prefer USA spelling ggplot2 will also accept <code>color</code>). Thirdly I’ve put some transparency in there using <code>alpha = 0.7</code>. This is a really easy way to make your points semi-transparent which is great when you’re dealing with lots of data and want to show the patterns even when there’s overplotting. The closer to zero the more transparent so <code>alpha = 0.2</code> gives lots of transparency whereas <code>alpha = 0.9</code> gives hardly any. We now have a nice looking scatterplot but we want to add another <em>layer</em> showing something that summarises what’s going on in our data. We do this by just adding a second <code>geom...</code> to our code like this:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="graphics-with-ggplot2.html#cb354-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> UFO, <span class="kw">aes</span>(<span class="dt">x =</span> Reports, </span>
<span id="cb354-2"><a href="graphics-with-ggplot2.html#cb354-2"></a>                             <span class="dt">y =</span> Count)) <span class="op">+</span></span>
<span id="cb354-3"><a href="graphics-with-ggplot2.html#cb354-3"></a><span class="st">               </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>, </span>
<span id="cb354-4"><a href="graphics-with-ggplot2.html#cb354-4"></a>                          <span class="dt">colour =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb354-5"><a href="graphics-with-ggplot2.html#cb354-5"></a>                          <span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span></span>
<span id="cb354-6"><a href="graphics-with-ggplot2.html#cb354-6"></a><span class="st">               </span><span class="kw">geom_smooth</span>(<span class="dt">span =</span> <span class="fl">0.1</span>, </span>
<span id="cb354-7"><a href="graphics-with-ggplot2.html#cb354-7"></a>                           <span class="dt">colour =</span> <span class="st">&quot;slateblue4&quot;</span>, </span>
<span id="cb354-8"><a href="graphics-with-ggplot2.html#cb354-8"></a>                           <span class="dt">size =</span> <span class="fl">0.5</span>, </span>
<span id="cb354-9"><a href="graphics-with-ggplot2.html#cb354-9"></a>                           <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb354-10"><a href="graphics-with-ggplot2.html#cb354-10"></a><span class="st">               </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb354-11"><a href="graphics-with-ggplot2.html#cb354-11"></a><span class="st">               </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb354-12"><a href="graphics-with-ggplot2.html#cb354-12"></a>                    <span class="dt">y =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>, </span>
<span id="cb354-13"><a href="graphics-with-ggplot2.html#cb354-13"></a>                    <span class="dt">title =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</span>
<span id="cb354-14"><a href="graphics-with-ggplot2.html#cb354-14"></a></span>
<span id="cb354-15"><a href="graphics-with-ggplot2.html#cb354-15"></a>p1</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-352-1.png" width="672" /></p>
<p>There is now a wiggly line drawn over the top of our points showing where the main trend is. You can think of this as an extra <em>layer</em> on the graph with the data mapped to a new geom, giving a second visualisation of the data on top of the first one.</p>
<p>To draw our line we used <code>geom_smooth()</code>. This is one of the most important options in ggplot2 because it is a massively flexible way of adding lines to a plot. The default option is to add a <em>non-parametric smoother</em>, a statistical method of summarising the trend in a dataset which is highly flexible and can include peaks, troughs and changes in slope. Non-parametric smoothers are great for exploratory data analysis, and also for summarising complex patterns in bivariate datasets as we have done here. The specific kind of smoother that ggplot2 is using in this case is something called a <em>loess smooether</em> (loess standing for <em>l</em>ocally <em>e</em>stimated <em>s</em>catterplot <em>s</em>moothing) and you can think of it as a bunch of short regressions covering part of the dataset stitched together. Loess smoothers can be more or less smoothed depending on how much of the dataset is used for each piece, and since we have quite a complex pattern in these data I’ve gone for a less smoothed setting which means the line will follow the data quite closely: this is done by setting <code>span = 0.1</code> as an argument. Other arguments specify the colour (<code>colour = "darkblue"</code>)and ask for a fairly thin line (<code>size = 0.5</code>). Finally <code>se = FALSE</code> asks for the loess fit to be plotted without confidence intervals. <code>geom_smooth()</code> will plot in 95% confidence intervals for a line by default and this is often very useful and important but in this case they don’t really add a lot to the outcome.</p>
</div>
<div id="scaling-axes-and-varying-colour-or-shapes-by-factor-levels" class="section level2">
<h2><span class="header-section-number">11.2</span> Scaling axes and varying colour or shapes by factor levels</h2>
<p>To illustrate this we’ll use the data on pinniped mating systems and brain sizes that was introduced in chapter 8. As a quick reminder, these data were originally published by John Fitzpatrick and coauthors in a paper on the subject of how brain size in pinnipeds (seals, walruses and sea lions) relates to whether they have a mating system where males pair up with single females or a system where individual males compete to defend groups (“harems”) of females during the mating season.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="graphics-with-ggplot2.html#cb355-1"></a><span class="co"># Import data</span></span>
<span id="cb355-2"><a href="graphics-with-ggplot2.html#cb355-2"></a>pinniped &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://www.introductoryr.co.uk/Pinniped_brains.csv&quot;</span>)</span>
<span id="cb355-3"><a href="graphics-with-ggplot2.html#cb355-3"></a></span>
<span id="cb355-4"><a href="graphics-with-ggplot2.html#cb355-4"></a><span class="co"># Set up factor describing the mating system</span></span>
<span id="cb355-5"><a href="graphics-with-ggplot2.html#cb355-5"></a>Mating_system &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(pinniped<span class="op">$</span>Harem <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Non harem&quot;</span>, <span class="st">&quot;Harem&quot;</span>))</span>
<span id="cb355-6"><a href="graphics-with-ggplot2.html#cb355-6"></a></span>
<span id="cb355-7"><a href="graphics-with-ggplot2.html#cb355-7"></a>pinniped &lt;-<span class="st"> </span><span class="kw">data.frame</span>(pinniped, Mating_system)</span>
<span id="cb355-8"><a href="graphics-with-ggplot2.html#cb355-8"></a></span>
<span id="cb355-9"><a href="graphics-with-ggplot2.html#cb355-9"></a><span class="co"># Taking out a couple of lines with NA values to avoid warning messages</span></span>
<span id="cb355-10"><a href="graphics-with-ggplot2.html#cb355-10"></a>out &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">is.na</span>(pinniped<span class="op">$</span>Male_brain))</span>
<span id="cb355-11"><a href="graphics-with-ggplot2.html#cb355-11"></a></span>
<span id="cb355-12"><a href="graphics-with-ggplot2.html#cb355-12"></a>pinniped &lt;-<span class="st"> </span>pinniped[<span class="op">-</span>out,]</span></code></pre></div>
<p>Note that we’ve combined our data into a single data frame after setting up our factor — you’ll recall that ggplot2 needs to be given all the data as a data frame which is why we’ve done this. Let’s remind ourselves of what these data look like.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="graphics-with-ggplot2.html#cb356-1"></a></span>
<span id="cb356-2"><a href="graphics-with-ggplot2.html#cb356-2"></a>pinniped_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pinniped, </span>
<span id="cb356-3"><a href="graphics-with-ggplot2.html#cb356-3"></a>                        <span class="kw">aes</span>(<span class="dt">x =</span> Male_mass, <span class="dt">y =</span> Male_brain)) <span class="op">+</span></span>
<span id="cb356-4"><a href="graphics-with-ggplot2.html#cb356-4"></a><span class="st">        </span><span class="kw">geom_point</span>()</span>
<span id="cb356-5"><a href="graphics-with-ggplot2.html#cb356-5"></a></span>
<span id="cb356-6"><a href="graphics-with-ggplot2.html#cb356-6"></a>pinniped_plot</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-354-1.png" width="672" /></p>
<p>This is just a straightforward scatterplot of these data without anya attempt to alter the colours or the theme, but you can clearly see that most of the data are clustered in the bottom left-hand corner of the graph. Both variables are strongly positively skewed, and to visualise them better we need to plot their logs rather than the raw numbers. As in base R graphics, this can be done by log transforming our variables before plotting them, or by doing the log transformation in the code to generate the plot. Unlike base R, however, ggplot2 has two different options for a log transformation. One, which works on the <em>scale</em>, transforms the data and then plots the graph. This means that the gridlines and the axis tick locations are similar to those we’d get if we did the log transformation ourselves before plotting the graph. It also means that if we use something like <code>geom_smooth()</code> to add a smoother or a line, what is plotted will be based on log transformed data rather than the raw data. We’ll see what that means when we start adding lines to this graph.</p>
<p>The second way to plot log transformed data is by changing the <em>coordinates</em>: in other words the locations of the gridlines and tickmarks are decided based on the raw data, and the axes are then transformed. This is more analagous to what happens in base R when you use an argument like <code>log = "xy"</code> to plot log transformed data. If you use this method then if you add a smoother or a line with <code>geom_smooth()</code> it will have been fitted to the raw data and might look a bit unexpected.</p>
<p>We’ll use the scale transform by using the <code>scale_y_continuous()</code> and <code>scale_x_continuous()</code> functions.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="graphics-with-ggplot2.html#cb357-1"></a></span>
<span id="cb357-2"><a href="graphics-with-ggplot2.html#cb357-2"></a>pinniped_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pinniped, <span class="kw">aes</span>(<span class="dt">x =</span> Male_mass, <span class="dt">y =</span> Male_brain)) <span class="op">+</span></span>
<span id="cb357-3"><a href="graphics-with-ggplot2.html#cb357-3"></a><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb357-4"><a href="graphics-with-ggplot2.html#cb357-4"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb357-5"><a href="graphics-with-ggplot2.html#cb357-5"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>)</span>
<span id="cb357-6"><a href="graphics-with-ggplot2.html#cb357-6"></a></span>
<span id="cb357-7"><a href="graphics-with-ggplot2.html#cb357-7"></a>pinniped_plot</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-355-1.png" width="672" /></p>
<p>Now we’d like to colour code our data points to indicate the mating system for that species. It’s already been mentioned that we can include <em>aesthetic mappings</em> linking colours and plot symbols to variables in our data frame, so to draw a scatterplot with harem and non-harem breeders separated by colour we would use some code like this, which adds a mapping into the aesthetic call in the <code>ggplot()</code> function to map colour to the levels of <code>Mating_system</code>.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="graphics-with-ggplot2.html#cb358-1"></a></span>
<span id="cb358-2"><a href="graphics-with-ggplot2.html#cb358-2"></a>pinniped_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pinniped, <span class="kw">aes</span>(<span class="dt">x =</span> Male_mass, <span class="dt">y =</span> Male_brain, <span class="dt">colour =</span> Mating_system)) <span class="op">+</span></span>
<span id="cb358-3"><a href="graphics-with-ggplot2.html#cb358-3"></a><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb358-4"><a href="graphics-with-ggplot2.html#cb358-4"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb358-5"><a href="graphics-with-ggplot2.html#cb358-5"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>)</span>
<span id="cb358-6"><a href="graphics-with-ggplot2.html#cb358-6"></a></span>
<span id="cb358-7"><a href="graphics-with-ggplot2.html#cb358-7"></a>pinniped_plot</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-356-1.png" width="672" /></p>
<p>This is where ggplot2 really does better than the base R graphics. Simply by mapping the colour onto the <code>Mating_system</code> variable we’ve got a graph with the datapoints distinguished by colour and even better ggplot2 has drawn us a legend without even being asked to. Even better, if we add another layer the aesthetic mapping will be carried over. Let’s use <code>geom_smooth()</code> to add some fitted lines. To change from a loess smoother to a linear regression to fit our line we can just specify this in the function call.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="graphics-with-ggplot2.html#cb359-1"></a></span>
<span id="cb359-2"><a href="graphics-with-ggplot2.html#cb359-2"></a>pinniped_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pinniped, <span class="kw">aes</span>(<span class="dt">x =</span> Male_mass, <span class="dt">y =</span> Male_brain, <span class="dt">colour =</span> Mating_system)) <span class="op">+</span></span>
<span id="cb359-3"><a href="graphics-with-ggplot2.html#cb359-3"></a><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb359-4"><a href="graphics-with-ggplot2.html#cb359-4"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb359-5"><a href="graphics-with-ggplot2.html#cb359-5"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb359-6"><a href="graphics-with-ggplot2.html#cb359-6"></a><span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span>
<span id="cb359-7"><a href="graphics-with-ggplot2.html#cb359-7"></a></span>
<span id="cb359-8"><a href="graphics-with-ggplot2.html#cb359-8"></a>pinniped_plot</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-357-1.png" width="672" /></p>
<p>ggplot2 has calculated separate fits for the two groups of data and drawn in our fitted lines with the 95% confidence intervals indicated for each. Even better, the lines are only drawn within the range of each group of data so we don’t have any unnecessary extrapolation in our figure. This is something which is not at all straightforward in base R graohics.</p>
<p>Now all that remains is to make the plot nice and take it up to a publishable standard. As I’ve already indicated I don’t like the default theme for ggplot2, and I like the default colour palette even less. This is just my personal taste of course but I wouldn’t want to make anything public with that background and those colours. We can fix the theme using <code>theme_bw()</code> and we can fix the colours by using <code>scale_colour_manual()</code>. We also need some decent axis labels and a label for the legend and we can add those with <code>labs()</code>.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="graphics-with-ggplot2.html#cb360-1"></a></span>
<span id="cb360-2"><a href="graphics-with-ggplot2.html#cb360-2"></a>pinniped_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pinniped, <span class="kw">aes</span>(<span class="dt">x =</span> Male_mass, <span class="dt">y =</span> Male_brain, <span class="dt">colour =</span> Mating_system)) <span class="op">+</span></span>
<span id="cb360-3"><a href="graphics-with-ggplot2.html#cb360-3"></a><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb360-4"><a href="graphics-with-ggplot2.html#cb360-4"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb360-5"><a href="graphics-with-ggplot2.html#cb360-5"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb360-6"><a href="graphics-with-ggplot2.html#cb360-6"></a><span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb360-7"><a href="graphics-with-ggplot2.html#cb360-7"></a><span class="st">        </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb360-8"><a href="graphics-with-ggplot2.html#cb360-8"></a><span class="st">        </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;steelblue&quot;</span>)) <span class="op">+</span></span>
<span id="cb360-9"><a href="graphics-with-ggplot2.html#cb360-9"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Male body mass (Kg)&quot;</span>,</span>
<span id="cb360-10"><a href="graphics-with-ggplot2.html#cb360-10"></a>             <span class="dt">y =</span> <span class="st">&quot;Male brain mass (g)&quot;</span>,</span>
<span id="cb360-11"><a href="graphics-with-ggplot2.html#cb360-11"></a>             <span class="dt">colour =</span> <span class="st">&quot;Mating system&quot;</span>)</span>
<span id="cb360-12"><a href="graphics-with-ggplot2.html#cb360-12"></a></span>
<span id="cb360-13"><a href="graphics-with-ggplot2.html#cb360-13"></a>pinniped_plot</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-358-1.png" width="672" /></p>
</div>
<div id="facets" class="section level2">
<h2><span class="header-section-number">11.3</span> Facets</h2>
<p>This is in my opinion the best thing about ggplot2: the way it makes it so easy to draw multiple graphs <em>conditioned</em> on the values of a factor. If, rather than wanting to draw the data for both mating systems on the same graph we wanted to put them on two separate ones side by side it just takes a single line of extra code.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="graphics-with-ggplot2.html#cb361-1"></a></span>
<span id="cb361-2"><a href="graphics-with-ggplot2.html#cb361-2"></a>pinniped_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pinniped, <span class="kw">aes</span>(<span class="dt">x =</span> Male_mass, <span class="dt">y =</span> Male_brain)) <span class="op">+</span></span>
<span id="cb361-3"><a href="graphics-with-ggplot2.html#cb361-3"></a><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb361-4"><a href="graphics-with-ggplot2.html#cb361-4"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb361-5"><a href="graphics-with-ggplot2.html#cb361-5"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb361-6"><a href="graphics-with-ggplot2.html#cb361-6"></a><span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb361-7"><a href="graphics-with-ggplot2.html#cb361-7"></a><span class="st">        </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb361-8"><a href="graphics-with-ggplot2.html#cb361-8"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Male body mass (Kg)&quot;</span>,</span>
<span id="cb361-9"><a href="graphics-with-ggplot2.html#cb361-9"></a>             <span class="dt">y =</span> <span class="st">&quot;Male brain mass (g)&quot;</span>) <span class="op">+</span></span>
<span id="cb361-10"><a href="graphics-with-ggplot2.html#cb361-10"></a><span class="st">        </span><span class="kw">facet_grid</span>(.<span class="op">~</span><span class="st"> </span>Mating_system)</span>
<span id="cb361-11"><a href="graphics-with-ggplot2.html#cb361-11"></a></span>
<span id="cb361-12"><a href="graphics-with-ggplot2.html#cb361-12"></a>pinniped_plot</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-359-1.png" width="672" /></p>
<p><code>facet_grid()</code> works by setting up a grid of new plot panels (<em>facets</em>). As arguments it takes a <em>formula</em> with the variable before the tilde specifying the factor to be used for the rows and the one after the tilde the fator to be sued for the columns. In this case we only wanted two columns and a single row so the full stop before the tilde tells ggplot2 that we’re only concerned with columns here. Nice touches include the labels for each facet and the x- and y-axis scales being the same for both plots, making comparisons easy.</p>
</div>
<div id="histograms" class="section level2">
<h2><span class="header-section-number">11.4</span> Histograms</h2>
<p>Let’s look at another example. This time we’re going to use the World_bank_data_2014.csv dataset which we used in chapter 8, which has a large amount of data on environmental, ecomomic and health issues from 186 countried around the world from 2014.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="graphics-with-ggplot2.html#cb362-1"></a></span>
<span id="cb362-2"><a href="graphics-with-ggplot2.html#cb362-2"></a>WB &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://www.introductoryr.co.uk/World_bank_data_2014.csv&quot;</span>)</span>
<span id="cb362-3"><a href="graphics-with-ggplot2.html#cb362-3"></a>WB<span class="op">$</span>Region &lt;-<span class="st"> </span><span class="kw">as.factor</span>(WB<span class="op">$</span>Region)</span>
<span id="cb362-4"><a href="graphics-with-ggplot2.html#cb362-4"></a>WB<span class="op">$</span>Income_group &lt;-<span class="st"> </span><span class="kw">as.factor</span>(WB<span class="op">$</span>Income_group)</span>
<span id="cb362-5"><a href="graphics-with-ggplot2.html#cb362-5"></a></span>
<span id="cb362-6"><a href="graphics-with-ggplot2.html#cb362-6"></a><span class="kw">str</span>(WB)</span>
<span id="cb362-7"><a href="graphics-with-ggplot2.html#cb362-7"></a><span class="st">&#39;data.frame&#39;</span><span class="op">:</span><span class="st">   </span><span class="dv">186</span> obs. of  <span class="dv">22</span> variables<span class="op">:</span></span>
<span id="cb362-8"><a href="graphics-with-ggplot2.html#cb362-8"></a><span class="st"> </span><span class="er">$</span><span class="st"> </span>Country_Name              <span class="op">:</span><span class="st"> </span>chr  <span class="st">&quot;Afghanistan&quot;</span> <span class="st">&quot;Angola&quot;</span> <span class="st">&quot;Albania&quot;</span> <span class="st">&quot;Andorra&quot;</span> ...</span>
<span id="cb362-9"><a href="graphics-with-ggplot2.html#cb362-9"></a> <span class="op">$</span><span class="st"> </span>Country_Code              <span class="op">:</span><span class="st"> </span>chr  <span class="st">&quot;AFG&quot;</span> <span class="st">&quot;AGO&quot;</span> <span class="st">&quot;ALB&quot;</span> <span class="st">&quot;AND&quot;</span> ...</span>
<span id="cb362-10"><a href="graphics-with-ggplot2.html#cb362-10"></a> <span class="op">$</span><span class="st"> </span>Region                    <span class="op">:</span><span class="st"> </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">7</span> levels <span class="st">&quot;East Asia &amp; Pacific&quot;</span>,..<span class="op">:</span><span class="st"> </span><span class="dv">6</span> <span class="dv">7</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">2</span> ...</span>
<span id="cb362-11"><a href="graphics-with-ggplot2.html#cb362-11"></a> <span class="op">$</span><span class="st"> </span>Income_group              <span class="op">:</span><span class="st"> </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">4</span> levels <span class="st">&quot;High income&quot;</span>,..<span class="op">:</span><span class="st"> </span><span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb362-12"><a href="graphics-with-ggplot2.html#cb362-12"></a> <span class="op">$</span><span class="st"> </span>Population                <span class="op">:</span><span class="st"> </span>int  <span class="dv">33370794</span> <span class="dv">26941779</span> <span class="dv">2889104</span> <span class="dv">79213</span> <span class="dv">9214175</span> <span class="dv">42669500</span> <span class="dv">2912403</span> <span class="dv">92562</span> <span class="dv">23475686</span> <span class="dv">8546356</span> ...</span>
<span id="cb362-13"><a href="graphics-with-ggplot2.html#cb362-13"></a> <span class="op">$</span><span class="st"> </span>Land_area                 <span class="op">:</span><span class="st"> </span>num  <span class="dv">652860</span> <span class="dv">1246700</span> <span class="dv">27400</span> <span class="dv">470</span> <span class="dv">71020</span> ...</span>
<span id="cb362-14"><a href="graphics-with-ggplot2.html#cb362-14"></a> <span class="op">$</span><span class="st"> </span>Forest_area               <span class="op">:</span><span class="st"> </span>num  <span class="fl">2.07</span> <span class="fl">46.51</span> <span class="fl">28.19</span> <span class="fl">34.04</span> <span class="fl">4.53</span> ...</span>
<span id="cb362-15"><a href="graphics-with-ggplot2.html#cb362-15"></a> <span class="op">$</span><span class="st"> </span>Precipitation             <span class="op">:</span><span class="st"> </span>int  <span class="dv">327</span> <span class="dv">1010</span> <span class="dv">1485</span> <span class="ot">NA</span> <span class="dv">78</span> <span class="dv">591</span> <span class="dv">562</span> <span class="dv">1030</span> <span class="dv">534</span> <span class="dv">1110</span> ...</span>
<span id="cb362-16"><a href="graphics-with-ggplot2.html#cb362-16"></a> <span class="op">$</span><span class="st"> </span>Population_density        <span class="op">:</span><span class="st"> </span>num  <span class="fl">51.1</span> <span class="fl">21.6</span> <span class="fl">105.4</span> <span class="fl">168.5</span> <span class="fl">129.7</span> ...</span>
<span id="cb362-17"><a href="graphics-with-ggplot2.html#cb362-17"></a> <span class="op">$</span><span class="st"> </span>Capital_lat               <span class="op">:</span><span class="st"> </span>int  <span class="dv">33</span> <span class="dv">-13</span> <span class="dv">41</span> <span class="dv">43</span> <span class="dv">24</span> <span class="dv">-34</span> <span class="dv">40</span> <span class="dv">17</span> <span class="dv">-35</span> <span class="dv">47</span> ...</span>
<span id="cb362-18"><a href="graphics-with-ggplot2.html#cb362-18"></a> <span class="op">$</span><span class="st"> </span>GNP_per_Cap               <span class="op">:</span><span class="st"> </span>int  <span class="dv">630</span> <span class="dv">5010</span> <span class="dv">4540</span> <span class="ot">NA</span> <span class="dv">44330</span> <span class="dv">12350</span> <span class="dv">4140</span> <span class="dv">12730</span> <span class="dv">65150</span> <span class="dv">50370</span> ...</span>
<span id="cb362-19"><a href="graphics-with-ggplot2.html#cb362-19"></a> <span class="op">$</span><span class="st"> </span>Population_growth         <span class="op">:</span><span class="st"> </span>num  <span class="fl">3.356</span> <span class="fl">3.497</span> <span class="fl">-0.207</span> <span class="fl">-1.951</span> <span class="fl">0.177</span> ...</span>
<span id="cb362-20"><a href="graphics-with-ggplot2.html#cb362-20"></a> <span class="op">$</span><span class="st"> </span>Cereal_yield              <span class="op">:</span><span class="st"> </span>num  <span class="dv">2018</span> <span class="dv">888</span> <span class="dv">4893</span> <span class="ot">NA</span> <span class="dv">12543</span> ...</span>
<span id="cb362-21"><a href="graphics-with-ggplot2.html#cb362-21"></a> <span class="op">$</span><span class="st"> </span>Under_<span class="dv">5</span>_mortality         <span class="op">:</span><span class="st"> </span>num  <span class="fl">73.6</span> <span class="fl">92.9</span> <span class="dv">10</span> <span class="fl">3.4</span> <span class="fl">7.9</span> <span class="dv">12</span> <span class="fl">15.1</span> <span class="fl">7.6</span> <span class="dv">4</span> <span class="fl">3.8</span> ...</span>
<span id="cb362-22"><a href="graphics-with-ggplot2.html#cb362-22"></a> <span class="op">$</span><span class="st"> </span>Renewables                <span class="op">:</span><span class="st"> </span>num  <span class="fl">19.314</span> <span class="fl">50.797</span> <span class="fl">38.69</span> <span class="fl">19.886</span> <span class="fl">0.146</span> ...</span>
<span id="cb362-23"><a href="graphics-with-ggplot2.html#cb362-23"></a> <span class="op">$</span><span class="st"> </span>CO2                       <span class="op">:</span><span class="st"> </span>num  <span class="fl">0.294</span> <span class="fl">1.29</span> <span class="fl">1.979</span> <span class="fl">5.833</span> <span class="fl">22.94</span> ...</span>
<span id="cb362-24"><a href="graphics-with-ggplot2.html#cb362-24"></a> <span class="op">$</span><span class="st"> </span>PM25                      <span class="op">:</span><span class="st"> </span>num  <span class="dv">59</span> <span class="dv">33</span> <span class="fl">18.9</span> <span class="fl">10.8</span> <span class="dv">38</span> ...</span>
<span id="cb362-25"><a href="graphics-with-ggplot2.html#cb362-25"></a> <span class="op">$</span><span class="st"> </span>Women_in_parliament       <span class="op">:</span><span class="st"> </span>num  <span class="fl">27.7</span> <span class="fl">36.8</span> <span class="dv">20</span> <span class="dv">50</span> <span class="fl">17.5</span> <span class="fl">36.6</span> <span class="fl">10.7</span> <span class="fl">11.1</span> <span class="dv">26</span> <span class="fl">32.2</span> ...</span>
<span id="cb362-26"><a href="graphics-with-ggplot2.html#cb362-26"></a> <span class="op">$</span><span class="st"> </span>GINI_index                <span class="op">:</span><span class="st"> </span>num  <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="fl">41.7</span> <span class="fl">31.5</span> <span class="ot">NA</span> <span class="fl">35.8</span> <span class="fl">30.5</span> ...</span>
<span id="cb362-27"><a href="graphics-with-ggplot2.html#cb362-27"></a> <span class="op">$</span><span class="st"> </span>Govt_spend_education      <span class="op">:</span><span class="st"> </span>num  <span class="fl">3.7</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="dv">3</span> <span class="ot">NA</span> ...</span>
<span id="cb362-28"><a href="graphics-with-ggplot2.html#cb362-28"></a> <span class="op">$</span><span class="st"> </span>Secondary_school_enrolment<span class="op">:</span><span class="st"> </span>num  <span class="fl">52.6</span> <span class="ot">NA</span> <span class="fl">97.7</span> <span class="ot">NA</span> <span class="ot">NA</span> ...</span>
<span id="cb362-29"><a href="graphics-with-ggplot2.html#cb362-29"></a> <span class="op">$</span><span class="st"> </span>School_gender_parity      <span class="op">:</span><span class="st"> </span>num  <span class="fl">0.654</span> <span class="ot">NA</span> <span class="fl">0.977</span> <span class="ot">NA</span> <span class="ot">NA</span> ...</span></code></pre></div>
<p>The <code>PM25</code> variable contains estimates for exposure to small atmospheric particulates: the PM 2.5 particles which are implicated in lots of public health issues. Let’s have a look at the frequency histogram for these data. Since there’s only one variable to be plotted we just have an <code>x =</code> in the <code>aes()</code> and we will use <code>geom_histogram()</code>.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="graphics-with-ggplot2.html#cb363-1"></a>pm25_hist &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> WB, <span class="kw">aes</span>(<span class="dt">x =</span> PM25)) <span class="op">+</span></span>
<span id="cb363-2"><a href="graphics-with-ggplot2.html#cb363-2"></a><span class="st">        </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb363-3"><a href="graphics-with-ggplot2.html#cb363-3"></a><span class="st">        </span><span class="kw">theme_bw</span>()</span>
<span id="cb363-4"><a href="graphics-with-ggplot2.html#cb363-4"></a></span>
<span id="cb363-5"><a href="graphics-with-ggplot2.html#cb363-5"></a>pm25_hist</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-361-1.png" width="672" /></p>
<p>This does a nice job of plotting a frequency histogram. ggplot2 divides the data into 30 bins by default which is a bit much but it’s easy to use a different number. We know our data range from 0 to 100 so a binwidth of 5 gives us 20 bins which is a good number.</p>
<p>The default option here is to have no distinct lines around each bar of the histogram so that they blend into one. This arguably helps you see the shape of the frequency distribution but you might want to have somethign that resembles a base R histogram a little more, with the individual bars being more distinct. You can set the colour of the fill for each bar using <code>fill =</code> and the line around each with <code>colour =</code>. Because this is being applied to the gerom generally and isn’t mapped to a further variable it’s best to do this in the <code>geom_histogram()</code> function call. We also need some decent labels but that’s trivial for us now.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="graphics-with-ggplot2.html#cb364-1"></a>pm25_hist &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> WB, <span class="kw">aes</span>(<span class="dt">x =</span> PM25)) <span class="op">+</span></span>
<span id="cb364-2"><a href="graphics-with-ggplot2.html#cb364-2"></a><span class="st">        </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey70&quot;</span>) <span class="op">+</span></span>
<span id="cb364-3"><a href="graphics-with-ggplot2.html#cb364-3"></a><span class="st">        </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb364-4"><a href="graphics-with-ggplot2.html#cb364-4"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;PM 2.5 particulate exposure&quot;</span>,</span>
<span id="cb364-5"><a href="graphics-with-ggplot2.html#cb364-5"></a>             <span class="dt">y =</span> <span class="st">&quot;Number of countries&quot;</span>)</span>
<span id="cb364-6"><a href="graphics-with-ggplot2.html#cb364-6"></a></span>
<span id="cb364-7"><a href="graphics-with-ggplot2.html#cb364-7"></a>pm25_hist</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-362-1.png" width="672" /></p>
<p>We have another variable in our WB dataset called “Income group” which divides nations into low, lower middle, upper middle and high income categories. It would be interesting to see how the frequency distribution of PM 2.5 exposure varies between these income groups so we could use the ggplot2 facet goodness to let us plot a series of histograms to compare with each other. It’s usually easier to compare histograms when they’re one above the other so we’ll use <code>facet_grid()</code> to make this happen. As a final point we want the factor levels in an order that makes sense rather than in alphabetical order so we’ll use the <code>factor()</code> function to reorder them before plotting the graph.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="graphics-with-ggplot2.html#cb365-1"></a>WB<span class="op">$</span>Income_group &lt;-</span>
<span id="cb365-2"><a href="graphics-with-ggplot2.html#cb365-2"></a><span class="st">        </span><span class="kw">factor</span>(</span>
<span id="cb365-3"><a href="graphics-with-ggplot2.html#cb365-3"></a>                WB<span class="op">$</span>Income_group,</span>
<span id="cb365-4"><a href="graphics-with-ggplot2.html#cb365-4"></a>                <span class="dt">levels =</span> <span class="kw">c</span>(</span>
<span id="cb365-5"><a href="graphics-with-ggplot2.html#cb365-5"></a>                        <span class="st">&quot;Low income&quot;</span>,</span>
<span id="cb365-6"><a href="graphics-with-ggplot2.html#cb365-6"></a>                        <span class="st">&quot;Lower middle income&quot;</span>,</span>
<span id="cb365-7"><a href="graphics-with-ggplot2.html#cb365-7"></a>                        <span class="st">&quot;Upper middle income&quot;</span>,</span>
<span id="cb365-8"><a href="graphics-with-ggplot2.html#cb365-8"></a>                        <span class="st">&quot;High income&quot;</span>))</span>
<span id="cb365-9"><a href="graphics-with-ggplot2.html#cb365-9"></a></span>
<span id="cb365-10"><a href="graphics-with-ggplot2.html#cb365-10"></a>pm25_hist &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> WB, <span class="kw">aes</span>(<span class="dt">x =</span> PM25)) <span class="op">+</span></span>
<span id="cb365-11"><a href="graphics-with-ggplot2.html#cb365-11"></a><span class="st">        </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>,</span>
<span id="cb365-12"><a href="graphics-with-ggplot2.html#cb365-12"></a>                       <span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>,</span>
<span id="cb365-13"><a href="graphics-with-ggplot2.html#cb365-13"></a>                       <span class="dt">fill =</span> <span class="st">&quot;grey70&quot;</span>) <span class="op">+</span></span>
<span id="cb365-14"><a href="graphics-with-ggplot2.html#cb365-14"></a><span class="st">        </span><span class="kw">facet_grid</span>(Income_group <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></span>
<span id="cb365-15"><a href="graphics-with-ggplot2.html#cb365-15"></a><span class="st">        </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb365-16"><a href="graphics-with-ggplot2.html#cb365-16"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;PM 2.5 particulate exposure&quot;</span>,</span>
<span id="cb365-17"><a href="graphics-with-ggplot2.html#cb365-17"></a>             <span class="dt">y =</span> <span class="st">&quot;Number of countries&quot;</span>)</span>
<span id="cb365-18"><a href="graphics-with-ggplot2.html#cb365-18"></a></span>
<span id="cb365-19"><a href="graphics-with-ggplot2.html#cb365-19"></a>pm25_hist</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-363-1.png" width="672" />
This is a nice plot and we can see how the frequency distribution of PM 2.5 exposure changes as the amount of wealth increases.</p>
</div>
<div id="boxplots-1" class="section level2">
<h2><span class="header-section-number">11.5</span> Boxplots</h2>
<p>For a final example let’s use some other data from the worldbank dataset and draw a boxplot showing the log<sub>10</sub> of CO<sub>2</sub> production per capita divided by region and income. As we did before, we’ll amalgamate the two low income and the two high income classes to make a new factor with just two levels, “Low income” and “High income”.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="graphics-with-ggplot2.html#cb366-1"></a></span>
<span id="cb366-2"><a href="graphics-with-ggplot2.html#cb366-2"></a><span class="co"># Make new factor</span></span>
<span id="cb366-3"><a href="graphics-with-ggplot2.html#cb366-3"></a>Income &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">ifelse</span>(WB<span class="op">$</span>Income_group <span class="op">==</span><span class="st"> &quot;High income&quot;</span> <span class="op">|</span><span class="st"> </span>WB<span class="op">$</span>Income_group <span class="op">==</span><span class="st"> &quot;Upper middle income&quot;</span>, <span class="st">&quot;High income&quot;</span>, <span class="st">&quot;Low income&quot;</span>))</span>
<span id="cb366-4"><a href="graphics-with-ggplot2.html#cb366-4"></a></span>
<span id="cb366-5"><a href="graphics-with-ggplot2.html#cb366-5"></a><span class="co"># Add it to the WB data frame</span></span>
<span id="cb366-6"><a href="graphics-with-ggplot2.html#cb366-6"></a>WB &lt;-<span class="st"> </span><span class="kw">data.frame</span>(WB, Income)</span></code></pre></div>
<p>We’ll build our ggplot2 graph with the x-variable in the aesthetic as <code>Region</code>, the y-variable as <code>CO2</code> and we’ll use <code>fill = Income</code> to map the <em>fill</em> of the boxplots to the Income variable. We previously used <code>fill</code> to fill the bars in our histogram and we can use it here in just the same way we have used <code>colour</code> previously. Generally, if a <em>geom</em> has both an outline and a fill, you would use <code>colour =</code> to map something to the outline and <code>fill =</code> to map something to the fill.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="graphics-with-ggplot2.html#cb367-1"></a>CO2_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> WB, <span class="kw">aes</span>(<span class="dt">x =</span> Region,</span>
<span id="cb367-2"><a href="graphics-with-ggplot2.html#cb367-2"></a>                                  <span class="dt">y =</span> CO2,</span>
<span id="cb367-3"><a href="graphics-with-ggplot2.html#cb367-3"></a>                                  <span class="dt">fill =</span> Income)) <span class="op">+</span></span>
<span id="cb367-4"><a href="graphics-with-ggplot2.html#cb367-4"></a><span class="st">        </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb367-5"><a href="graphics-with-ggplot2.html#cb367-5"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb367-6"><a href="graphics-with-ggplot2.html#cb367-6"></a><span class="st">        </span><span class="kw">theme_bw</span>()</span>
<span id="cb367-7"><a href="graphics-with-ggplot2.html#cb367-7"></a></span>
<span id="cb367-8"><a href="graphics-with-ggplot2.html#cb367-8"></a>CO2_plot</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-365-1.png" width="672" /></p>
<p>This is getting there but we need to fix some things. Firstly those colours need to be swapped out for something else. Secondly the axes need proper labels. Thirdly the labels for the tick marks on the x-axis are a mess because the region names are way too long to fit in.</p>
<p>To change the fill colour we can use <code>scale_fill_manual()</code> instead of <code>scale_colour_manual()</code> which we used previously. This time instead of just adding the colour names in we’ll set up our own palette and use that. This works in just the same way as it does in base R graphics.</p>
<p>To change the angle of the text we’ll use this code: <code>theme(axis.text.x = element_text(angle = 45, hjust = 1))</code>. There are a series of arguments available for <code>theme()</code> which let us adjust things like text colour, font, angle and so on. Here we’re adjusting the angle of the x-axis text only to 45 degrees. The <code>hjust = 1</code> argument moves it down so that it’s in the right place. We’re using <code>expression()</code> to enable us to produce a y-axis label with subscripts in in exactly the same way that we did before with base R graphics.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="graphics-with-ggplot2.html#cb368-1"></a>palette1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cadetblue4&quot;</span>, <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb368-2"><a href="graphics-with-ggplot2.html#cb368-2"></a></span>
<span id="cb368-3"><a href="graphics-with-ggplot2.html#cb368-3"></a>CO2_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> WB, <span class="kw">aes</span>(<span class="dt">x =</span> Region,</span>
<span id="cb368-4"><a href="graphics-with-ggplot2.html#cb368-4"></a>                                  <span class="dt">y =</span> CO2,</span>
<span id="cb368-5"><a href="graphics-with-ggplot2.html#cb368-5"></a>                                  <span class="dt">fill =</span> Income)) <span class="op">+</span></span>
<span id="cb368-6"><a href="graphics-with-ggplot2.html#cb368-6"></a><span class="st">        </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb368-7"><a href="graphics-with-ggplot2.html#cb368-7"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb368-8"><a href="graphics-with-ggplot2.html#cb368-8"></a><span class="st">        </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> palette1) <span class="op">+</span></span>
<span id="cb368-9"><a href="graphics-with-ggplot2.html#cb368-9"></a><span class="st">        </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb368-10"><a href="graphics-with-ggplot2.html#cb368-10"></a><span class="st">        </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb368-11"><a href="graphics-with-ggplot2.html#cb368-11"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(Log[<span class="dv">10</span>] , CO[<span class="dv">2</span>], <span class="st">&quot; Production (tonnes)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)))</span>
<span id="cb368-12"><a href="graphics-with-ggplot2.html#cb368-12"></a></span>
<span id="cb368-13"><a href="graphics-with-ggplot2.html#cb368-13"></a>CO2_plot</span></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-366-1.png" width="672" /></p>
<p>That’s a nice graph and one that we could certainly publish as is. You might like to compare it with the very similar boxplot that we produced in the section on boxplots in the first chapter on base R graphics. The final result is very similar but the two boxplots are produced in very different ways and the ggplot2 version is overall rather simpler to produce: there’s no requirement for obscure things like setting <code>xpd = TRUE</code> to allow the legend to be plotted outside the graph window.</p>
</div>
<div id="final-word" class="section level2">
<h2><span class="header-section-number">11.6</span> Final word</h2>
<p>This chapter has hopefully given an explanation of the underlying philosophy behind ggplot2 and shown you some useful examples of how it’s used. There is a vast amount of further information available on the package and also on the <a href="https://exts.ggplot2.tidyverse.org/gallery/">ecosystem of add-on packages</a> that have appeared over tha past few years, and this book is not long enough to cover ggplot2 in any real detail. If you want to go further some useful resources are:</p>
<ol style="list-style-type: decimal">
<li>The <a href="https://ggplot2.tidyverse.org/index.html">official ggplot2 website</a> which has full documentation.</li>
<li>Winston Chang’s <a href="https://r-graphics.org/">R Graphics Cookbook</a>. This is an excellent and comprehensive guide to producing graphs with ggplot2 (and some base graphics too). You can read it online for free but if you like it please consider buying a hard copy to give something back. With this available there’s really little point in my trying to produce something to rival it.</li>
<li>The <a href="https://www.r-graph-gallery.com/index.html">R Graph Gallery</a> which is nowadays fairly strongly focussed on ggplot2 and its extensions. Look for a graph like the one you want to plot and then you can adapt the code for your own needs.</li>
<li>Something you might find helpful is the <a href="https://bbc.github.io/rcookbook/#how_to_create_bbc_style_graphics">BBC News ggplot2 cookbook</a> which they made public fairly recently and which has lots of examples of really good looking graphs and the code used to make them.</li>
</ol>
<p>As a final thought: which is better? Should you use ggplot2 or base graphics? Is it true (as I have seen people claim) that you can’t produce decent graphs with base R graphics and that if you submit base graphics to a journal they won’t accept them? The last is unquestionably untrue and really only shows that the person in question didn’t know what they were taling about. As you should have seen in the preceeding chapters it’s easy to make excellent quality graphs using base R graphics, and sometimes it’s simpler than using ggplot2, especially if you’re allergic to the ggplot2 default options like I am. Once you’ve understood ggplot2 it has an underlying logic and structure which makes a lot of sense, but it’s quite a steep learning curve and base graphics can be more accessible. So my advice is… if you aren’t likely to be making a lot of graphs, or if you just want to make quick plots for exploratory analysis then stick with base graphics. If you want to put in the work then go for ggplot2 which is, let’s face it, rapidly taking over the world, but bear in mind that there is a lot of activation energy required. Even after several years of using it I still have to spend a lot of time with my best helper for ggplot which is, of course, google.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-graphics-ii-adding-elements-to-an-existing-graph.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basic-statistical-concepts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["3rd_Edition.pdf", "3rd_Edition.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
