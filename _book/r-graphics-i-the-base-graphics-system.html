<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 R graphics I — the base graphics system | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</title>
  <meta name="description" content="Chapter 9 R graphics I — the base graphics system | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 R graphics I — the base graphics system | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 R graphics I — the base graphics system | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  
  
  

<meta name="author" content="Rob Knell" />


<meta name="date" content="2019-12-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="importing-data.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i><b>1.1</b> Why this book?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.2</b> How to use this book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-first-r-session.html"><a href="a-first-r-session.html"><i class="fa fa-check"></i><b>2</b> A first R session</a><ul>
<li class="chapter" data-level="2.1" data-path="a-first-r-session.html"><a href="a-first-r-session.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="a-first-r-session.html"><a href="a-first-r-session.html#a-first-r-session-1"><i class="fa fa-check"></i><b>2.2</b> A first R session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html"><i class="fa fa-check"></i><b>3</b> Basics: arithmetic, objects and functions</a><ul>
<li class="chapter" data-level="3.0.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#arithmetic"><i class="fa fa-check"></i><b>3.0.1</b> Arithmetic</a></li>
<li class="chapter" data-level="3.0.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#logical-operations"><i class="fa fa-check"></i><b>3.0.2</b> Logical operations</a></li>
<li class="chapter" data-level="3.0.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects"><i class="fa fa-check"></i><b>3.0.3</b> Objects</a></li>
<li class="chapter" data-level="3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#kinds-of-data"><i class="fa fa-check"></i><b>3.1</b> Kinds of data</a></li>
<li class="chapter" data-level="3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#whats-in-my-workspace"><i class="fa fa-check"></i><b>3.2</b> What’s in my workspace?</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations"><i class="fa fa-check"></i><b>3.3.1</b> Calculations</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-1"><i class="fa fa-check"></i><b>3.3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-1"><i class="fa fa-check"></i><b>3.3.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#answers-to-exercises"><i class="fa fa-check"></i><b>3.4</b> Answers to exercises</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations-1"><i class="fa fa-check"></i><b>3.4.1</b> Calculations</a></li>
<li class="chapter" data-level="3.4.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-2"><i class="fa fa-check"></i><b>3.4.2</b> Objects</a></li>
<li class="chapter" data-level="3.4.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-2"><i class="fa fa-check"></i><b>3.4.3</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html"><i class="fa fa-check"></i><b>4</b> Data: Vectors, Matrices and Data Frames</a><ul>
<li class="chapter" data-level="4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices"><i class="fa fa-check"></i><b>4.2</b> Matrices</a></li>
<li class="chapter" data-level="4.3" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#factors-and-data-frames"><i class="fa fa-check"></i><b>4.3</b> Factors and Data frames</a></li>
<li class="chapter" data-level="4.4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-1"><i class="fa fa-check"></i><b>4.4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-1"><i class="fa fa-check"></i><b>4.4.2</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#answers-to-exercises-1"><i class="fa fa-check"></i><b>4.5</b> Answers to exercises</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-2"><i class="fa fa-check"></i><b>4.5.1</b> Vectors</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-2"><i class="fa fa-check"></i><b>4.5.2</b> Matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html"><i class="fa fa-check"></i><b>5</b> Choosing data: subscripts and subsetting</a><ul>
<li class="chapter" data-level="5.0.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts"><i class="fa fa-check"></i><b>5.0.1</b> Subscripts</a></li>
<li class="chapter" data-level="5.0.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-in-matrices-and-data-frames"><i class="fa fa-check"></i><b>5.0.2</b> Subscripts in matrices and data frames</a></li>
<li class="chapter" data-level="5.0.3" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subset"><i class="fa fa-check"></i><b>5.0.3</b> Subset</a></li>
<li class="chapter" data-level="5.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#exercises-2"><i class="fa fa-check"></i><b>5.1</b> Exercises</a><ul>
<li class="chapter" data-level="5.1.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors"><i class="fa fa-check"></i><b>5.1.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.1.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices"><i class="fa fa-check"></i><b>5.1.2</b> Subscripts and matrices</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#answers-to-exercises-2"><i class="fa fa-check"></i><b>5.2</b> Answers to exercises</a><ul>
<li class="chapter" data-level="5.2.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors-1"><i class="fa fa-check"></i><b>5.2.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.2.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices-1"><i class="fa fa-check"></i><b>5.2.2</b> Subscripts and matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html"><i class="fa fa-check"></i><b>6</b> R scripts and your R workflow</a><ul>
<li class="chapter" data-level="6.1" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#writing-and-using-r-scripts"><i class="fa fa-check"></i><b>6.1</b> Writing and using R scripts</a></li>
<li class="chapter" data-level="6.2" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-an-r-script-window"><i class="fa fa-check"></i><b>6.2</b> Running code from an R script window</a></li>
<li class="chapter" data-level="6.3" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-files-using-source"><i class="fa fa-check"></i><b>6.3</b> Running code from files using <code>source()</code></a></li>
<li class="chapter" data-level="6.4" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#workflow-structure-or-what-should-i-put-in-my-script"><i class="fa fa-check"></i><b>6.4</b> Workflow structure, or what should I put in my script?</a></li>
<li class="chapter" data-level="6.5" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#keep-it-neat-making-your-script-easy-to-read"><i class="fa fa-check"></i><b>6.5</b> Keep it neat — making your script easy to read</a></li>
<li class="chapter" data-level="6.6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#i-wish-i-hadnt-commented-my-code-so-much-said-no-one-ever-4."><i class="fa fa-check"></i><b>6.6</b> “I wish I hadn’t commented my code so much”, said no-one, ever [^4].</a></li>
<li class="chapter" data-level="6.7" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#using-rstudio-to-write-scripts"><i class="fa fa-check"></i><b>6.7</b> Using RStudio to write scripts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html"><i class="fa fa-check"></i><b>7</b> Help files and packages</a><ul>
<li class="chapter" data-level="7.1" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html#using-the-help-files"><i class="fa fa-check"></i><b>7.1</b> Using the help files</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>8</b> Importing Data</a><ul>
<li class="chapter" data-level="8.1" data-path="importing-data.html"><a href="importing-data.html#the-rules"><i class="fa fa-check"></i><b>8.1</b> The Rules</a></li>
<li class="chapter" data-level="8.2" data-path="importing-data.html"><a href="importing-data.html#importing-your-text-file"><i class="fa fa-check"></i><b>8.2</b> Importing your Text File</a><ul>
<li class="chapter" data-level="8.2.1" data-path="importing-data.html"><a href="importing-data.html#the-simple-way"><i class="fa fa-check"></i><b>8.2.1</b> The simple way</a></li>
<li class="chapter" data-level="8.2.2" data-path="importing-data.html"><a href="importing-data.html#the-less-simple-way"><i class="fa fa-check"></i><b>8.2.2</b> The less simple way</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="importing-data.html"><a href="importing-data.html#importing-character-data"><i class="fa fa-check"></i><b>8.3</b> Importing character data</a></li>
<li class="chapter" data-level="8.4" data-path="importing-data.html"><a href="importing-data.html#data-on-the-web"><i class="fa fa-check"></i><b>8.4</b> Data on the web</a></li>
<li class="chapter" data-level="8.5" data-path="importing-data.html"><a href="importing-data.html#using-read.table"><i class="fa fa-check"></i><b>8.5</b> Using <code>read.table()</code></a></li>
<li class="chapter" data-level="8.6" data-path="importing-data.html"><a href="importing-data.html#what-to-do-once-youve-managed-to-import-your-data."><i class="fa fa-check"></i><b>8.6</b> What to do once you’ve managed to import your data.</a></li>
<li class="chapter" data-level="8.7" data-path="importing-data.html"><a href="importing-data.html#importing-data-directly-from-excel"><i class="fa fa-check"></i><b>8.7</b> Importing data directly from Excel</a></li>
<li class="chapter" data-level="8.8" data-path="importing-data.html"><a href="importing-data.html#other-data-formats"><i class="fa fa-check"></i><b>8.8</b> Other data formats</a></li>
<li class="chapter" data-level="8.9" data-path="importing-data.html"><a href="importing-data.html#importing-data-into-rstudio"><i class="fa fa-check"></i><b>8.9</b> Importing data into RStudio</a></li>
<li class="chapter" data-level="8.10" data-path="importing-data.html"><a href="importing-data.html#to-attach-or-not-to-attach"><i class="fa fa-check"></i><b>8.10</b> To attach or not to attach?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html"><i class="fa fa-check"></i><b>9</b> R graphics I — the base graphics system</a><ul>
<li class="chapter" data-level="9.1" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#base-graphics-versus-ggplot2-versus-lattice-versus-whaaat"><i class="fa fa-check"></i><b>9.1</b> Base graphics versus ggplot2 versus lattice versus whaaat???</a></li>
<li class="chapter" data-level="9.2" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#base-graphics-example-ufo-reports-again"><i class="fa fa-check"></i><b>9.2</b> Base graphics example: UFO reports again</a></li>
<li class="chapter" data-level="9.3" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#basic-scatterplots"><i class="fa fa-check"></i><b>9.3</b> Basic Scatterplots</a></li>
<li class="chapter" data-level="9.4" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#plot-symbols"><i class="fa fa-check"></i><b>9.4</b> Plot symbols</a></li>
<li class="chapter" data-level="9.5" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#colours"><i class="fa fa-check"></i><b>9.5</b> Colours</a></li>
<li class="chapter" data-level="9.6" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#plotting-multiple-symbols-or-colours"><i class="fa fa-check"></i><b>9.6</b> Plotting multiple symbols or colours</a></li>
<li class="chapter" data-level="9.7" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#colour-palettes-in-r"><i class="fa fa-check"></i><b>9.7</b> Colour palettes in R</a></li>
<li class="chapter" data-level="9.8" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#adding-elements-to-an-existing-graph"><i class="fa fa-check"></i><b>9.8</b> Adding elements to an existing graph</a></li>
<li class="chapter" data-level="9.9" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#adding-a-legend"><i class="fa fa-check"></i><b>9.9</b> Adding a legend</a></li>
<li class="chapter" data-level="9.10" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#drawing-graphs-piece-by-piece"><i class="fa fa-check"></i><b>9.10</b> Drawing graphs piece-by-piece</a></li>
<li class="chapter" data-level="9.11" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#drawing-curves"><i class="fa fa-check"></i><b>9.11</b> Drawing curves</a></li>
<li class="chapter" data-level="9.12" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#plots-of-variables-by-factors"><i class="fa fa-check"></i><b>9.12</b> Plots of Variables by Factors</a></li>
<li class="chapter" data-level="9.13" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#using-transparency-in-your-graphs"><i class="fa fa-check"></i><b>9.13</b> Using transparency in your graphs</a></li>
<li class="chapter" data-level="9.14" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#more-graphics-functions"><i class="fa fa-check"></i><b>9.14</b> More Graphics Functions</a><ul>
<li class="chapter" data-level="9.14.1" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#histogram-with-overlaid-probability-density-estimate"><i class="fa fa-check"></i><b>9.14.1</b> Histogram with overlaid probability density estimate</a></li>
<li class="chapter" data-level="9.14.2" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#pie-graph"><i class="fa fa-check"></i><b>9.14.2</b> Pie graph</a></li>
<li class="chapter" data-level="9.14.3" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#d-scatterplot"><i class="fa fa-check"></i><b>9.14.3</b> 3D scatterplot</a></li>
<li class="chapter" data-level="9.14.4" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#contour-plot"><i class="fa fa-check"></i><b>9.14.4</b> Contour plot</a></li>
</ul></li>
<li class="chapter" data-level="9.15" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#exporting-graphics"><i class="fa fa-check"></i><b>9.15</b> Exporting Graphics</a><ul>
<li class="chapter" data-level="9.15.1" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#the-easy-way"><i class="fa fa-check"></i><b>9.15.1</b> The easy way</a></li>
<li class="chapter" data-level="9.15.2" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#the-hard-way"><i class="fa fa-check"></i><b>9.15.2</b> The hard way</a></li>
</ul></li>
<li class="chapter" data-level="9.16" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#going-further-with-your-graphs"><i class="fa fa-check"></i><b>9.16</b> Going Further with your Graphs</a><ul>
<li class="chapter" data-level="9.16.1" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#ggplot2"><i class="fa fa-check"></i><b>9.16.1</b> ggplot2</a></li>
<li class="chapter" data-level="9.16.2" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#lattice"><i class="fa fa-check"></i><b>9.16.2</b> lattice</a></li>
</ul></li>
<li class="chapter" data-level="9.17" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#exercises-3"><i class="fa fa-check"></i><b>9.17</b> Exercises</a></li>
<li class="chapter" data-level="9.18" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#footnotes"><i class="fa fa-check"></i><b>9.18</b> Footnotes</a></li>
<li class="chapter" data-level="9.19" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#drawing-the-set-of-plot-points"><i class="fa fa-check"></i><b>9.19</b> Drawing the set of plot points</a></li>
<li class="chapter" data-level="9.20" data-path="r-graphics-i-the-base-graphics-system.html"><a href="r-graphics-i-the-base-graphics-system.html#taking-it-further-trimming-the-x-axis-and-adding-a-smoother"><i class="fa fa-check"></i><b>9.20</b> Taking it further: trimming the x-axis and adding a smoother</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-graphics-i-the-base-graphics-system" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> R graphics I — the base graphics system</h1>
<p>When it comes to drawing graphs, using R gives you the same benefits and costs that you get when analysing data. Everything is done through a command-line interface that can be difficult to use and sometimes counterintuitive. Whereas with other software you get a nice GUI and can just point and click until you achieve what it is you’re after, if you’re drawing graphs in R you might have to do some research first to find out how to draw the graph you’re after. That initial difficulty, however, is more than counterbalanced by the huge benefits of using R as your platform for data visualisation: R is almost infinitely flexible and can draw an extraordinary range of graphs, and you’ll find that in many cases the default options are very good starting points; unlike those in a certain popular spreadsheet application, for example, they have been designed by people possessed of both brains and colour vision. Finally, generating a script when you draw your graph means that you can easily return and edit your graph, and if you want to draw a similar graph with different data you can re-use your script with a few edits. Finally, you can use <em>other peoples’ scripts</em>. There are plenty of online resources with examples of graphs produced in R, and many of these have the code used to draw the graph associated with them. If you find an example of the sort of graph you want to make, you can use the code that’s already there as the basis of your own script. Have a look at the <a href="https://www.r-graph-gallery.com/">R Graph Gallery</a>, a web resource set up for exactly this purpose, for an idea of the range of options available.</p>
<div id="base-graphics-versus-ggplot2-versus-lattice-versus-whaaat" class="section level2">
<h2><span class="header-section-number">9.1</span> Base graphics versus ggplot2 versus lattice versus whaaat???</h2>
<p>As a budding R user, your life has been made more complicated by the presence of a number of different options for creating graphics in R. Firstly, there is the graphics system which is built into R which is called <em>base</em> graphics. Despite the implication from the name that it’s a bit basic, this is a sophisticated and powerful system which can easily generate publication-quality graphs… which is sometimes a surprise to the ggplot2 fanbois. There are then two main alternative systems, <em>lattice</em> and <em>ggplot2</em>, which work very differently to the base system. Of these, ggplot2 has become the most well-known, and many people are now using it exclusively. I don’t think it’s possible to be a fully functional R user nowadays without knowing at least the fundamentals of ggplot2, so in this chapter and the next we’ll take an in-depth look at base graphics, and then we’ll move on to some ggplot2 basics.</p>
</div>
<div id="base-graphics-example-ufo-reports-again" class="section level2">
<h2><span class="header-section-number">9.2</span> Base graphics example: UFO reports again</h2>
<p>We’ll start off with looking at an example of how to produce a graph in R. In the previous chapter we looked at a script which drew a graph for you: the plot of UFO reports by month since 1900. Let’s have another look at that script and go through the code. Here it is again.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Script to read data on UFO reports and plot the data since 1900</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># Audrey Bloggs 25th December 2022</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># Load data from website</span></a>
<a class="sourceLine" id="cb1-5" title="5">UFO &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://www.introductoryr.co.uk/UFO_data.csv&quot;</span>,</a>
<a class="sourceLine" id="cb1-6" title="6">     <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># Convert &#39;Reports&#39; variable to date</span></a>
<a class="sourceLine" id="cb1-9" title="9">UFO<span class="op">$</span>Reports &lt;-<span class="st"> </span><span class="kw">as.Date</span>(UFO<span class="op">$</span>Reports, <span class="dt">format =</span> <span class="st">&quot;%d/%m/%Y&quot;</span>)</a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co"># Trim off dates before 1900 which have a different format and convert to NA</span></a>
<a class="sourceLine" id="cb1-12" title="12">UFO &lt;-<span class="st"> </span>UFO[<span class="kw">which</span>((<span class="op">!</span><span class="kw">is.na</span>(UFO<span class="op">$</span>Reports))), ]</a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co"># Check the data structure</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">str</span>(UFO)</a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co"># Plot the data</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="kw">plot</span>(UFO<span class="op">$</span>Count <span class="op">~</span><span class="st"> </span>UFO<span class="op">$</span>Reports,</a>
<a class="sourceLine" id="cb1-19" title="19">     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb1-20" title="20">     <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb1-21" title="21">     <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb1-22" title="22">     <span class="dt">ylab =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>,</a>
<a class="sourceLine" id="cb1-23" title="23">     <span class="dt">main  =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</a></code></pre></div>
<p>The first two thirds of the script are devoted to importing the data, cleaning it up and checking that everything’s gone well, and then we have the <code>plot()</code> function call which actually draws the graph. <code>plot()</code> is a particularly flexible and powerful R function, and it can produce a wide range of different outputs depending on the nature of the data or R objects that we feed to it. Our complete function call looks like this.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">plot</span>(UFO<span class="op">$</span>Count <span class="op">~</span><span class="st"> </span>UFO<span class="op">$</span>Reports,</a>
<a class="sourceLine" id="cb2-2" title="2">     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">     <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">     <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">     <span class="dt">ylab =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>,</a>
<a class="sourceLine" id="cb2-6" title="6">     <span class="dt">main  =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</a></code></pre></div>
<p>Just like other functions in R we have a series of <em>arguments</em> within the brackets, with each argument separated from the previous one by a comma. I’ve got each argument after the first on a separate line, which makes it easier to see what’s happening in this piece of code. The first argument that we’re giving to our <code>plot()</code> function tells it where to find the data to plot. In this case we’re giving it two data variables, a numeric variable, <code>UFO$Count</code> and a date variable <code>UFO$Reports</code>, and they are separated by a tilde <code>~</code>. The tilde is an important symbol in R. This is the first time you’ve met it, but you’ll see it a lot in defining formulas for statistical tests. You can think of it as meaning “is explained by” or as something which separates a <em>dependent</em> variable from an <em>independent</em> variable, or a <em>response</em> variable from an <em>explanatory</em> variable: if we think that one variable <em>depends</em> on the value of the other then the former would be the dependent or response variable and the latter the independent or explanatory variable. In this case the number of UFO reports <em>depends</em> on the year: there is clearly a big effect of year in determining the number of reports logged, but the year deosn’t depend on the number of reports. No-one is going to say “there have been 215 UFO reports, so we will call this year 2003”. Conventionally we put a dependent variable on the y-axis and an independent one on the x-axis, and this is what R will do.</p>
<p>If we just use the first argument, <code>UFO$Count ~ UFO$Reports</code> and none of the rest then R will go for the default option for a graph with continuous variables for both the x- and the y-axis, and draw a scatterplot with each data point represented by an open circle.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">plot</span>(UFO<span class="op">$</span>Count <span class="op">~</span><span class="st"> </span>UFO<span class="op">$</span>Reports)</a></code></pre></div>
<div class="figure"><span id="fig:graph1"></span>
<img src="3rd_Edition_files/figure-html/graph1-1.png" alt="Scatterplot of UFO reports by year" width="672" />
<p class="caption">
Figure 9.1: Scatterplot of UFO reports by year
</p>
</div>
<p>That’s not really what we’re after and doesn’t really show the important patterns in the data. We can tell R to draw a line connecting each data point instead of the scatterplot by adding the <code>type = 'l'</code> argument:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">plot</span>(UFO<span class="op">$</span>Count <span class="op">~</span><span class="st"> </span>UFO<span class="op">$</span>Reports,</a>
<a class="sourceLine" id="cb4-2" title="2">     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph2"></span>
<img src="3rd_Edition_files/figure-html/graph2-1.png" alt="Line plot of UFO reports by year" width="672" />
<p class="caption">
Figure 9.2: Line plot of UFO reports by year
</p>
</div>
<p>which gives something much closer to what we’re after. We can change the colour of the line using the <code>col = "steelblue"</code> argument, <code>xlab = "Year"</code> sets the axis label for the x-axis, <code>ylab = "Number of UFO reports by month"</code> does the same for the y-axis and finally <code>main  = "UFO reports by month since 1900"</code> gives us a main title for the graph…</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">plot</span>(UFO<span class="op">$</span>Count <span class="op">~</span><span class="st"> </span>UFO<span class="op">$</span>Reports,</a>
<a class="sourceLine" id="cb5-2" title="2">     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb5-3" title="3">     <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb5-4" title="4">     <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb5-5" title="5">     <span class="dt">ylab =</span> <span class="st">&quot;Number of UFO reports by month&quot;</span>,</a>
<a class="sourceLine" id="cb5-6" title="6">     <span class="dt">main  =</span> <span class="st">&quot;UFO reports by month since 1900&quot;</span>)</a></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>… and with remarkably little fuss we have a nice, publication quality graph displaying our data. This example shows us the basics of producing graphs in R: the <code>plot()</code> function produces a particular kind of graph depending on the data that you feed it, but you can then modify the look of the graph and change things like the axis labels by using further arguments to your <code>plot()</code> function call. It’s worth pointing out here that these arguments are often called graphical <em>parameters</em> when we’re referring to arguments that change the appearance of a graph, but they work in the same way as arguments for other types of function. We’ll talk a little more about graphical parameters later on in the chapter.</p>
</div>
<div id="basic-scatterplots" class="section level2">
<h2><span class="header-section-number">9.3</span> Basic Scatterplots</h2>
<p>Let’s look at scatterplots in rather more detail. We’ll draw a scatterplot and then specify the shape and colour of the datapoints according to some classification, then finally we’ll add some fitted lines to our data. The dataset we’ll be using is from a paper published in the Journal of Evolutionary Biology by John Fitzpatrick and coauthors<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> on the subject of how brain size in pinnipeds (seals, walruses and sea lions) relates to their mating system. The fundamental question they were addressing is whether brain size varies between seals where the males defend groups of females (“harems”), and species where males pair up with single females.</p>
<p>The dataset is online and you can load it straight into R from the web by running this line of code.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">pinniped &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://www.introductoryr.co.uk/Pinniped_brains.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>As always, we want to know whether our dataset has imported properly so we check using the <code>str()</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">str</span>(pinniped)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    33 obs. of  11 variables:
##  $ Species        : chr  &quot;Monachus schauinslandi&quot; &quot;Monachus monachus&quot; &quot;Mirounga angustirostris&quot; &quot;Mirounga leonina&quot; ...
##  $ Male_brain     : num  370 480 700 1431 535 ...
##  $ Female_brain   : num  NA 480 640 899 638 ...
##  $ Male_mass      : num  173 260 2275 3510 450 ...
##  $ Female_mass    : num  272 275 488 566 447 ...
##  $ Harem          : num  1 1 13 48 3 1 1 1 1 1 ...
##  $ Small_intestine: int  1030 870 3820 12100 2700 790 2530 2190 2520 2164 ...
##  $ Gestation      : int  330 330 230 225 263 248 255 276 234 270 ...
##  $ Lifespan       : num  360 284 244 276 300 ...
##  $ Lactation      : int  38 42 26 23 50 30 17 29 4 24 ...
##  $ Dive_duration  : num  12 NA 62 120 82 9.8 10.8 NA 52 25 ...</code></pre>
<p>All good: we have quite a few variables including a character vector of species names, male and female brain mass (g), male and female body mass (Kg) and the average harem size, where 1 indicates each male is only mating with a single female at a time and values greater than 1 tell us that males, if they are able, will guard females in groups.</p>
<p>Let’s plot male brain mass against body mass to start with.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain<span class="op">~</span>pinniped<span class="op">$</span>Male_mass)</a></code></pre></div>
<div class="figure"><span id="fig:graph3"></span>
<img src="3rd_Edition_files/figure-html/graph3-1.png" alt="Brain mass versus body mass for 33 species of male pinniped" width="672" />
<p class="caption">
Figure 9.3: Brain mass versus body mass for 33 species of male pinniped
</p>
</div>
<p>This plot is showing us that there is some sort of relationship between brain mass and body mass, but it is difficult to tell much from it because both the brain mass and body mass data are squished down into the bottom left corner. This is because both of these variables are <em>positively skewed</em>: there are lots of seals and their relatives with body mass between about 50 and about 500Kg, but then there are a few which are much heavier up to <em>Mirounga leonina</em>, the Southern Elephant Seal, which is an absolute chonker with males weighing in at about 3.5 metric tonnes. We need to do something to spread the data out more evenly, and usually when dealing with this sort of <em>positively skewed</em> data we’d plot the log transformed data rather than the raw data. There are two easy ways to do this in R: you can generate new variables which are the logged values that you want to plot, or you can use an argument within the <code>plot()</code> function call to tell it to plot the data on a log scale.</p>
<p>Here is the first option.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co">#Generate new variables with the log transformed data</span></a>
<a class="sourceLine" id="cb10-2" title="2">log_Male_brain &lt;-<span class="st"> </span><span class="kw">log</span>(pinniped<span class="op">$</span>Male_brain)</a>
<a class="sourceLine" id="cb10-3" title="3">log_Male_mass &lt;-<span class="st"> </span><span class="kw">log</span>(pinniped<span class="op">$</span>Male_mass)</a>
<a class="sourceLine" id="cb10-4" title="4"></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#plot our new variables</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="kw">plot</span>(log_Male_brain<span class="op">~</span>log_Male_mass)</a></code></pre></div>
<div class="figure"><span id="fig:graph4"></span>
<img src="3rd_Edition_files/figure-html/graph4-1.png" alt="Log brain mass versus log body mass for 33 species of male pinniped" width="672" />
<p class="caption">
Figure 9.4: Log brain mass versus log body mass for 33 species of male pinniped
</p>
</div>
<p>You can see that log transforming these data gives us a nice looking plot with the data spread out so that we can see any patterns that might be there. How about the other alternative?</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain <span class="op">~</span><span class="st"> </span>pinniped<span class="op">$</span>Male_mass,</a>
<a class="sourceLine" id="cb11-2" title="2">     <span class="dt">log  =</span> <span class="st">&quot;xy&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph5"></span>
<img src="3rd_Edition_files/figure-html/graph5-1.png" alt="Brain mass versus body mass for 33 species of male pinniped, plotted on log scaled axes" width="672" />
<p class="caption">
Figure 9.5: Brain mass versus body mass for 33 species of male pinniped, plotted on log scaled axes
</p>
</div>
<p>The positioning of the points is exactly the same, but the numbers on the axes are different. What’s happened here is that instead of log-transforming the data we;’ve plotted the untransformed data on axes that are on log scales —– you can see this by looking at the numbers on the x-axis in particular, where the distance from 100 to 200 is about the same as the distance from 1000 to 2000. If you only wanted the y-axis plotted on a log scale you could use <code>log = "y"</code> and if you only wanted the x-axis on a log scale then <code>log = "x"</code> would do.</p>
<p>Which of these options for plotting logged data you use is up to you and the best option will depend on the context. I generally prefer the latter, since you retain the original units for your axes which makes it easier to understand what each data point represents.</p>
<p>Talking of units, the axis labels on our plot are not especially informative, so let’s fix that by telling the <code>plot()</code> function what we want our axis labels to be. We can do that using the <code>xlab =</code> and <code>ylab =</code> arguments.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain <span class="op">~</span><span class="st"> </span>pinniped<span class="op">$</span>Male_mass,</a>
<a class="sourceLine" id="cb12-2" title="2">     <span class="dt">log  =</span> <span class="st">&quot;xy&quot;</span>,</a>
<a class="sourceLine" id="cb12-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;Body mass (Kg)&quot;</span>,</a>
<a class="sourceLine" id="cb12-4" title="4">     <span class="dt">ylab =</span> <span class="st">&quot;Brain mass (g)&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph6"></span>
<img src="3rd_Edition_files/figure-html/graph6-1.png" alt="Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes" width="672" />
<p class="caption">
Figure 9.6: Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes
</p>
</div>
<p>Good. This is now looking like a graph that we might start to think about publishing. You can see how the default options for things like axis limits and plot symbols are clean and well chosen in base R graphics. We’ve not finished though: we want to change our graph so that the viewer can differentiate between species with “harem” mating systems and other species.</p>
<p>The Harem variable in our data set tells us the average size of the group of females that a male will defend for each species, so if Harem = 1 then we can classify a species as a non-harem one, and if Harem &gt; 1 then we can classify a species as one with a harem mating system. We can then use subscripting to allocate a specific colour or plot symbol to the data points for harem or non-harem species.</p>
</div>
<div id="plot-symbols" class="section level2">
<h2><span class="header-section-number">9.4</span> Plot symbols</h2>
<p>We can get R to draw different plot symbols by using the <code>pch =</code> graphical parameter. R has a set of built in symbols that are represented by the numbers 1 to 25. Here they are: the code used to draw this figure is at the end of this chapter.</p>
<div class="figure"><span id="fig:graph7"></span>
<img src="3rd_Edition_files/figure-html/graph7-1.png" alt="Plot symbols used in R" width="672" />
<p class="caption">
Figure 9.7: Plot symbols used in R
</p>
</div>
<p>So if we’d like to plot our data with filled circles instead of open ones, we can set <code>pch = 16</code> as one of our graphical arguments, like this.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain <span class="op">~</span><span class="st"> </span>pinniped<span class="op">$</span>Male_mass,</a>
<a class="sourceLine" id="cb13-2" title="2">     <span class="dt">log  =</span> <span class="st">&quot;xy&quot;</span>,</a>
<a class="sourceLine" id="cb13-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;Body mass (Kg)&quot;</span>,</a>
<a class="sourceLine" id="cb13-4" title="4">     <span class="dt">ylab =</span> <span class="st">&quot;Brain mass (g)&quot;</span>, </a>
<a class="sourceLine" id="cb13-5" title="5">     <span class="dt">pch =</span> <span class="dv">16</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph8"></span>
<img src="3rd_Edition_files/figure-html/graph8-1.png" alt="Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes using closed circles as plot symbols" width="672" />
<p class="caption">
Figure 9.8: Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes using closed circles as plot symbols
</p>
</div>
</div>
<div id="colours" class="section level2">
<h2><span class="header-section-number">9.5</span> Colours</h2>
<p>The colour or colours that your plot symbols are drawn with (or the colours of the boxes in a boxplot, or the bars in a histogram or bar plot) can be set in R by using the <em>col</em> parameter, and other parameters such as <em>bg</em>, <em>col.axis</em>, <em>col.lab</em> set the colours for other parts of the plot: these examples will allow you to change the background colour and the colours of the axes and the axis labels respectively. For a full list of these take a look at <code>?par</code> which will bring up a description of all of the graphical parameters. The actual colours to be used can be named in a confusing variety of different ways, but for the beginner the easiest thing to do is simply to use the name: “red”, “blue”, “green” or “lightblue” or “darkgreen”. In fact, R has a rather surprising number of named colours that you can use, and an even more surprising range of names, from “aliceblue” through “darkgoldenrod2”, “hotpink1”, “lemonchiffon3” to “tomato4”. The function <code>colours()</code>, or <code>colors()</code> if you prefer the American spelling will produce a list of all 657 named colours in R. Appendix 1 has a series of charts showing each colour with its name.</p>
<p>If you’re familiar with how colours are described in computers then you can use the RGB hexadecimal code for the colour: this begins with a hash symbol and then has two numbers for the red channel (computers think in hexadecimal to each one is 0-9 and the A-F), two for the green and two for the blue, so #0000FF is blue, #FF0000 is red, #000000 is black and #FFFFFF is white. We’ll talk about using these hex codes a little later when we discuss using <em>alpha channels</em> to make elements of your graph semi-transparent.</p>
<p>If we wanted to change the colours of our plot symbols from the default black option we just need to add another argument specifying the exact colour we want. If we wanted <em>aquamarine4</em> as our plot colour then our code would look like this.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain <span class="op">~</span><span class="st"> </span>pinniped<span class="op">$</span>Male_mass,</a>
<a class="sourceLine" id="cb14-2" title="2">     <span class="dt">log  =</span> <span class="st">&quot;xy&quot;</span>,</a>
<a class="sourceLine" id="cb14-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;Body mass (Kg)&quot;</span>,</a>
<a class="sourceLine" id="cb14-4" title="4">     <span class="dt">ylab =</span> <span class="st">&quot;Brain mass (g)&quot;</span>, </a>
<a class="sourceLine" id="cb14-5" title="5">     <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb14-6" title="6">     <span class="dt">col =</span> <span class="st">&quot;aquamarine4&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph9"></span>
<img src="3rd_Edition_files/figure-html/graph9-1.png" alt="Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes with both plot symbol and colour specified" width="672" />
<p class="caption">
Figure 9.9: Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes with both plot symbol and colour specified
</p>
</div>
</div>
<div id="plotting-multiple-symbols-or-colours" class="section level2">
<h2><span class="header-section-number">9.6</span> Plotting multiple symbols or colours</h2>
<p>One of the most important uses of colour or plot symbols is to distinguish between different classes of data, and this is something that we can do in R: if we have a variable which classifies our data into groups, then we can use that to tell R which colours or symbols to use. Using our data on pinnipeds, we can divide our species into harem breeders, where males defend groups of more than one female during the mating season, and non-harem breeders where each male is only associated with a single female. The variable <code>Harem</code> gives us the number of females that a male might be associated with and we can use this to set up a new factor called <code>Mating_system</code> which has two levels, <code>Harem</code> for males who will seek to defend more than one female and <code>Non harem</code> for males who only associate with a single female at a time.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">Mating_system &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(pinniped<span class="op">$</span>Harem <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Non harem&quot;</span>, <span class="st">&quot;Harem&quot;</span>))</a></code></pre></div>
<p>Here we’ve used the <code>ifelse()</code> function which takes a logical statement, in this case whether the value of <code>Harem</code> is equal to one, and returns one value, in this case <code>"Non harem"</code>, if the logical statement is true and a second value (<code>"Harem"</code>) if the statement is false. Now we can plot our data and indicate to the viewer which mating system is associated with each data point. Firstly we’ll do this with colours, and then with different plot symbols.</p>
<p>To indicate how our points are classified we need a vector of colours for R to use in our plot. This example has only two but if you have more groups you just need more colours in your vector.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">colours &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;aquamarine4&quot;</span>, <span class="st">&quot;chocolate2&quot;</span>)</a></code></pre></div>
<p>Now we have a vector of colours and a factor which classifies our data. How do we use these to generate a plot with each data point colour coded by the factor levels? The answer lies in some clever use of subscripts. <code>colours</code> is a character vector and we can retrieve the first or second value by using a subscript:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">colours[<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## [1] &quot;chocolate2&quot;</code></pre>
<p>returns the second value in the vector. If we have a second vector of numbers which correspond to the useable subscripts for our <code>colours</code> vector then we can use this to generate a new vector of colour names:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">example &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">colours[example]</a></code></pre></div>
<pre><code>## [1] &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;chocolate2&quot;  &quot;aquamarine4&quot; &quot;chocolate2&quot; 
## [6] &quot;chocolate2&quot;  &quot;aquamarine4&quot;</code></pre>
<p>which returns a vector with seven colour names, each corresponding to the relevant value in our <code>example</code> vector. Now let’s go back to our <code>Mating_system</code> factor. This has two levels, <code>Harem</code> and <code>Non harem</code> and these levels will be coded by R as <code>1</code> for <code>Harem</code>, which coes first alphabetically, and <code>2</code> for <code>Non harem</code> which comes second. If, therefore, we use <code>Mating_system</code> as a subscript for <code>colours</code> it should return <code>"aquamarine4"</code> for each value of <code>Non harem</code> in <code>Mating_system</code> and <code>"chocolate2"</code> for each value of <code>Harem</code>. Let’s try that out.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">colours[Mating_system]</a></code></pre></div>
<pre><code>##  [1] &quot;chocolate2&quot;  &quot;chocolate2&quot;  &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;aquamarine4&quot;
##  [6] &quot;chocolate2&quot;  &quot;chocolate2&quot;  &quot;chocolate2&quot;  &quot;chocolate2&quot;  &quot;chocolate2&quot; 
## [11] &quot;aquamarine4&quot; &quot;chocolate2&quot;  &quot;chocolate2&quot;  &quot;chocolate2&quot;  &quot;chocolate2&quot; 
## [16] &quot;chocolate2&quot;  &quot;chocolate2&quot;  &quot;chocolate2&quot;  &quot;aquamarine4&quot; &quot;aquamarine4&quot;
## [21] &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;aquamarine4&quot;
## [26] &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;aquamarine4&quot;
## [31] &quot;aquamarine4&quot; &quot;aquamarine4&quot; &quot;aquamarine4&quot;</code></pre>
<p><em>Et voilà!</em> we can generate a vector of colours which we can include in our <code>plot()</code> function call with only a very brief piece of code.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain <span class="op">~</span><span class="st"> </span>pinniped<span class="op">$</span>Male_mass,</a>
<a class="sourceLine" id="cb23-2" title="2">     <span class="dt">log  =</span> <span class="st">&quot;xy&quot;</span>,</a>
<a class="sourceLine" id="cb23-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;Body mass (Kg)&quot;</span>,</a>
<a class="sourceLine" id="cb23-4" title="4">     <span class="dt">ylab =</span> <span class="st">&quot;Brain mass (g)&quot;</span>, </a>
<a class="sourceLine" id="cb23-5" title="5">     <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb23-6" title="6">     <span class="dt">col =</span> colours[Mating_system])</a></code></pre></div>
<div class="figure"><span id="fig:graph10"></span>
<img src="3rd_Edition_files/figure-html/graph10-1.png" alt="Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes, orange symbols indicate non-harem breeders and green indicate harem breeders" width="672" />
<p class="caption">
Figure 9.10: Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes, orange symbols indicate non-harem breeders and green indicate harem breeders
</p>
</div>
<p>There we are. Now, if I were given chocolate that colour to eat I’d be rather dubious, but aside from that we’ve achieved our goal.</p>
<p>We can vary the plot symbol using the exact same logic. If we wanted to indicate mating system by using a filled circle (plot symbol 16) for <code>Harem</code> and a filled triangle (plot symbol 17) for <code>Non harem</code> we need to set up a vector containing these two numbers:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">symbols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)</a></code></pre></div>
<p>and then we can use this in our <code>plot()</code> function call with a subscript in the same way that we did for colours.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain <span class="op">~</span><span class="st"> </span>pinniped<span class="op">$</span>Male_mass,</a>
<a class="sourceLine" id="cb25-2" title="2">     <span class="dt">log  =</span> <span class="st">&quot;xy&quot;</span>,</a>
<a class="sourceLine" id="cb25-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;Body mass (Kg)&quot;</span>,</a>
<a class="sourceLine" id="cb25-4" title="4">     <span class="dt">ylab =</span> <span class="st">&quot;Brain mass (g)&quot;</span>, </a>
<a class="sourceLine" id="cb25-5" title="5">     <span class="dt">pch =</span> symbols[Mating_system])</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-13"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-13-1.png" alt="Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes, triangles indicate non-harem breeders and circles indicate harem breeders" width="672" />
<p class="caption">
Figure 9.11: Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes, triangles indicate non-harem breeders and circles indicate harem breeders
</p>
</div>
</div>
<div id="colour-palettes-in-r" class="section level2">
<h2><span class="header-section-number">9.7</span> Colour palettes in R</h2>
<p>You don’t have to choose your own colours for your plots. R has a number of built-in selections of colours which are known as “palettes”. There is a default palette which is a vector of 8 different colours which can be found using the <code>palette()</code> function.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">palette</span>()</a></code></pre></div>
<pre><code>## [1] &quot;black&quot;   &quot;red&quot;     &quot;green3&quot;  &quot;blue&quot;    &quot;cyan&quot;    &quot;magenta&quot; &quot;yellow&quot; 
## [8] &quot;gray&quot;</code></pre>
<p>If you’re just interested in a quick look at your data then you can just use code like this where I’ve specified our <code>Mating_system</code> factor for the <code>col =</code> argument, and R will use the first two colours in the default palette.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain <span class="op">~</span><span class="st"> </span>pinniped<span class="op">$</span>Male_mass,</a>
<a class="sourceLine" id="cb28-2" title="2">     <span class="dt">log  =</span> <span class="st">&quot;xy&quot;</span>,</a>
<a class="sourceLine" id="cb28-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;Body mass (Kg)&quot;</span>,</a>
<a class="sourceLine" id="cb28-4" title="4">     <span class="dt">ylab =</span> <span class="st">&quot;Brain mass (g)&quot;</span>, </a>
<a class="sourceLine" id="cb28-5" title="5">     <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb28-6" title="6">     <span class="dt">col =</span> Mating_system)</a></code></pre></div>
<div class="figure"><span id="fig:graph11"></span>
<img src="3rd_Edition_files/figure-html/graph11-1.png" alt="Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes, colour coded for mating system" width="672" />
<p class="caption">
Figure 9.12: Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes, colour coded for mating system
</p>
</div>
<p>That doesn’t look too bad but you might not want to use it for a presentation or a publication. The default R palette has something of a bad reputation and the potential combinations of bright red, green and blue is enough to give most people a headache, not to mention the possible problems for people with red-green colourblindness. There will be a new and less offensive default palette <a href="https://developer.r-project.org/Blog/public/2019/11/21/a-new-palette-for-r/index.html">coming to R soon</a> but at the time of writing this hasn’t been implemented yet. The good news though is that there are a lot of other palettes now available in a base R installation as part of the grDevices package, and there are also some really nice ones available as installable packages. The <code>ncl.pals()</code> function will give you a list of what’s available in your base installation so long as it’s a fairly recent one.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">hcl.pals</span>()</a></code></pre></div>
<pre><code>##   [1] &quot;Pastel 1&quot;      &quot;Dark 2&quot;        &quot;Dark 3&quot;        &quot;Set 2&quot;        
##   [5] &quot;Set 3&quot;         &quot;Warm&quot;          &quot;Cold&quot;          &quot;Harmonic&quot;     
##   [9] &quot;Dynamic&quot;       &quot;Grays&quot;         &quot;Light Grays&quot;   &quot;Blues 2&quot;      
##  [13] &quot;Blues 3&quot;       &quot;Purples 2&quot;     &quot;Purples 3&quot;     &quot;Reds 2&quot;       
##  [17] &quot;Reds 3&quot;        &quot;Greens 2&quot;      &quot;Greens 3&quot;      &quot;Oslo&quot;         
##  [21] &quot;Purple-Blue&quot;   &quot;Red-Purple&quot;    &quot;Red-Blue&quot;      &quot;Purple-Orange&quot;
##  [25] &quot;Purple-Yellow&quot; &quot;Blue-Yellow&quot;   &quot;Green-Yellow&quot;  &quot;Red-Yellow&quot;   
##  [29] &quot;Heat&quot;          &quot;Heat 2&quot;        &quot;Terrain&quot;       &quot;Terrain 2&quot;    
##  [33] &quot;Viridis&quot;       &quot;Plasma&quot;        &quot;Inferno&quot;       &quot;Dark Mint&quot;    
##  [37] &quot;Mint&quot;          &quot;BluGrn&quot;        &quot;Teal&quot;          &quot;TealGrn&quot;      
##  [41] &quot;Emrld&quot;         &quot;BluYl&quot;         &quot;ag_GrnYl&quot;      &quot;Peach&quot;        
##  [45] &quot;PinkYl&quot;        &quot;Burg&quot;          &quot;BurgYl&quot;        &quot;RedOr&quot;        
##  [49] &quot;OrYel&quot;         &quot;Purp&quot;          &quot;PurpOr&quot;        &quot;Sunset&quot;       
##  [53] &quot;Magenta&quot;       &quot;SunsetDark&quot;    &quot;ag_Sunset&quot;     &quot;BrwnYl&quot;       
##  [57] &quot;YlOrRd&quot;        &quot;YlOrBr&quot;        &quot;OrRd&quot;          &quot;Oranges&quot;      
##  [61] &quot;YlGn&quot;          &quot;YlGnBu&quot;        &quot;Reds&quot;          &quot;RdPu&quot;         
##  [65] &quot;PuRd&quot;          &quot;Purples&quot;       &quot;PuBuGn&quot;        &quot;PuBu&quot;         
##  [69] &quot;Greens&quot;        &quot;BuGn&quot;          &quot;GnBu&quot;          &quot;BuPu&quot;         
##  [73] &quot;Blues&quot;         &quot;Lajolla&quot;       &quot;Turku&quot;         &quot;Blue-Red&quot;     
##  [77] &quot;Blue-Red 2&quot;    &quot;Blue-Red 3&quot;    &quot;Red-Green&quot;     &quot;Purple-Green&quot; 
##  [81] &quot;Purple-Brown&quot;  &quot;Green-Brown&quot;   &quot;Blue-Yellow 2&quot; &quot;Blue-Yellow 3&quot;
##  [85] &quot;Green-Orange&quot;  &quot;Cyan-Magenta&quot;  &quot;Tropic&quot;        &quot;Broc&quot;         
##  [89] &quot;Cork&quot;          &quot;Vik&quot;           &quot;Berlin&quot;        &quot;Lisbon&quot;       
##  [93] &quot;Tofino&quot;        &quot;ArmyRose&quot;      &quot;Earth&quot;         &quot;Fall&quot;         
##  [97] &quot;Geyser&quot;        &quot;TealRose&quot;      &quot;Temps&quot;         &quot;PuOr&quot;         
## [101] &quot;RdBu&quot;          &quot;RdGy&quot;          &quot;PiYG&quot;          &quot;PRGn&quot;         
## [105] &quot;BrBG&quot;          &quot;RdYlBu&quot;        &quot;RdYlGn&quot;        &quot;Spectral&quot;     
## [109] &quot;Zissou 1&quot;      &quot;Cividis&quot;</code></pre>
<p>This long list is in fact an implementation of the colour palettes available in the <a href="https://cran.r-project.org/web/packages/colorspace/vignettes/colorspace.html">colorspace</a> package for R, and these are themselves a mix of palettes from a variety of sources: for example the <code>Viridis</code> palette is from the eponymous <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">Viridis</a> package.</p>
<p>I personally find a lot of these built-in colour palettes to be rather uninspiring and I prefer to use palettes from the <code>RColorBrewer</code> package. <code>RColorBrewer</code> gives you an R implementation of the palettes available on the <a href="http://colorbrewer2.org/">Color Brewer</a> website. The website is oriented towards cartographers but the palettes are useful for all sorts of data visualisations. The package will need to be installed if you don’t already have it so you’d need to run <code>install.packages("RColorBrewer")</code>.</p>
<p>The palettes in <code>RColorBrewer</code> and elsewhere are usually grouped into “sequential”, “diverging” and “qualitative” palettes. Sequential ones are suited for data on an ordered scale and tend to have a single underlying colour which is presented at varying degrees of lightness. Here are the available palettes from <code>RColorBrewer</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">display.brewer.all</span>(<span class="dt">type =</span> <span class="st">&quot;seq&quot;</span>)</a></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Diverging palettes, like the sequential ones are suited for data where there is some sort of order but these palettes have contrasting colours for high and low values and (usually) pale shades for mid-range values.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">display.brewer.all</span>(<span class="dt">type =</span> <span class="st">&quot;div&quot;</span>)</a></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Finally, qualitative palettes do not have any implied ordering and are best for representing data where the differences between data points are themselves not ordered.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">display.brewer.all</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>)</a></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>These palettes have a variety of numbers of colours, and chances are that you’ll want to use a different number from the default. You can’t use more than the maximum, but you can easily generate and visualise sub-palettes with fewer colours present. As an example, if you wanted a palette based on the Dark2 palette but with seven colours only you can use the <code>display.brewer.pal()</code> function to visualise it and the <code>brewer.pal()</code> function to generate a new object with the appropriate hex codes.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">display.brewer.pal</span>(<span class="dt">n =</span> <span class="dv">7</span>, <span class="dt">name =</span> <span class="st">&#39;Dark2&#39;</span>)</a></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">palette1 &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dt">n=</span><span class="dv">7</span>, <span class="dt">name =</span> <span class="st">&quot;Dark2&quot;</span>)</a></code></pre></div>
<p>giving us a character vector called <code>palette1</code> with seven elements which are the hex codes for our colours.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">palette1</a></code></pre></div>
<pre><code>## [1] &quot;#1B9E77&quot; &quot;#D95F02&quot; &quot;#7570B3&quot; &quot;#E7298A&quot; &quot;#66A61E&quot; &quot;#E6AB02&quot; &quot;#A6761D&quot;</code></pre>
<p>Let’s use this palette to plot a graph. The World_bank_data_2014.csv dataset contains a wide variety of data on economics and development measured in 2014 for 186 countries around the World, as published by the <a href="https://data.worldbank.org/">World Bank</a>. Two variables are the percentage of the surface area which are classified as forested (<code>Forest_area</code>) and the annual rainfall in mm (<code>Precipitation</code>). Let’s plot these out, and colour code our data points by region (which happens to have seven values…)</p>
<p>First of all we need to load the data.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">WB &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://www.introductoryr.co.uk/World_bank_data_2014.csv&quot;</span>)</a>
<a class="sourceLine" id="cb38-2" title="2"></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="kw">str</span>(WB)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    186 obs. of  22 variables:
##  $ Country_Name              : Factor w/ 186 levels &quot;Afghanistan&quot;,..: 1 5 2 4 176 7 8 6 9 10 ...
##  $ Country_Code              : Factor w/ 186 levels &quot;AFG&quot;,&quot;AGO&quot;,&quot;ALB&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Region                    : Factor w/ 7 levels &quot;East Asia &amp; Pacific&quot;,..: 6 7 2 2 4 3 2 3 1 2 ...
##  $ Income_group              : Factor w/ 4 levels &quot;High income&quot;,..: 2 3 4 1 1 4 4 1 1 1 ...
##  $ Population                : int  33370794 26941779 2889104 79213 9214175 42669500 2912403 92562 23475686 8546356 ...
##  $ Land_area                 : num  652860 1246700 27400 470 71020 ...
##  $ Forest_area               : num  2.07 46.51 28.19 34.04 4.53 ...
##  $ Precipitation             : int  327 1010 1485 NA 78 591 562 1030 534 1110 ...
##  $ Population_density        : num  51.1 21.6 105.4 168.5 129.7 ...
##  $ Capital_lat               : int  33 -13 41 43 24 -34 40 17 -35 47 ...
##  $ GNP_per_Cap               : int  630 5010 4540 NA 44330 12350 4140 12730 65150 50370 ...
##  $ Population_growth         : num  3.356 3.497 -0.207 -1.951 0.177 ...
##  $ Cereal_yield              : num  2018 888 4893 NA 12543 ...
##  $ Under_5_mortality         : num  73.6 92.9 10 3.4 7.9 12 15.1 7.6 4 3.8 ...
##  $ Renewables                : num  19.314 50.797 38.69 19.886 0.146 ...
##  $ CO2                       : num  0.294 1.29 1.979 5.833 22.94 ...
##  $ PM25                      : num  59 33 18.9 10.8 38 ...
##  $ Women_in_parliament       : num  27.7 36.8 20 50 17.5 36.6 10.7 11.1 26 32.2 ...
##  $ GINI_index                : num  NA NA NA NA NA 41.7 31.5 NA 35.8 30.5 ...
##  $ Govt_spend_education      : num  3.7 NA NA 3 NA ...
##  $ Secondary_school_enrolment: num  52.6 NA 97.7 NA NA ...
##  $ School_gender_parity      : num  0.654 NA 0.977 NA NA ...</code></pre>
<p>Now that we have our data a little housekeeping is in order. We’re going to want to add a legend ot our plot in the right hand margin so we need to adjust the sizes of the figure margins using <code>par(mar = c(5,4,4,12))</code>. The vector of numbers is the size of the margins in the order of bottom, left, top, right and it would normally be set at <code>c(5,4,4,2) + 0.1</code> so we’re making the right hand margin much bigger than it would normally be.</p>
<p><code>par(xpd = TRUE)</code> sets R so that we can plot our legend in the margin: normally in base graphics it would be restricted to inside the plotting area.</p>
<p>Now that we’ve done that we can plot our graph, add the legend and then finally set our two parameters back to their default values. It’s always a good idea to do this because if you don’t then you’ll inevitably forget and then you’ll end up wondering why your graph looks odd.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">par</span>(<span class="dt">xpd =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb40-3" title="3"></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="kw">plot</span>(WB<span class="op">$</span>Forest_area <span class="op">~</span><span class="st"> </span>WB<span class="op">$</span>Precipitation, </a>
<a class="sourceLine" id="cb40-5" title="5">     <span class="dt">col =</span> palette1[WB<span class="op">$</span>Region], </a>
<a class="sourceLine" id="cb40-6" title="6">     <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb40-7" title="7">     <span class="dt">xlab =</span> <span class="st">&quot;Precipitation (mm per year)&quot;</span>,</a>
<a class="sourceLine" id="cb40-8" title="8">     <span class="dt">ylab =</span> <span class="st">&quot;Forest area (%)&quot;</span>)</a>
<a class="sourceLine" id="cb40-9" title="9"></a>
<a class="sourceLine" id="cb40-10" title="10"><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">3500</span>, <span class="dt">y=</span><span class="dv">80</span>, </a>
<a class="sourceLine" id="cb40-11" title="11">       <span class="dt">col =</span> palette1, </a>
<a class="sourceLine" id="cb40-12" title="12">       <span class="dt">pch =</span> <span class="dv">16</span>, </a>
<a class="sourceLine" id="cb40-13" title="13">       <span class="dt">legend =</span> <span class="kw">levels</span>(WB<span class="op">$</span>Region), </a>
<a class="sourceLine" id="cb40-14" title="14">       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb40-15" title="15">       <span class="dt">title =</span> <span class="st">&quot;Region&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw">par</span>(<span class="dt">xpd =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Before we look at our final plot, let’s just run through those <code>plot()</code> and <code>legend()</code> function calls and see what all the arguments do.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">plot</span>(WB<span class="op">$</span>Forest_area <span class="op">~</span><span class="st"> </span>WB<span class="op">$</span>Precipitation, </a>
<a class="sourceLine" id="cb42-2" title="2">     <span class="dt">col =</span> palette1[WB<span class="op">$</span>Region], </a>
<a class="sourceLine" id="cb42-3" title="3">     <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb42-4" title="4">     <span class="dt">xlab =</span> <span class="st">&quot;Precipitation (mm per year)&quot;</span>,</a>
<a class="sourceLine" id="cb42-5" title="5">     <span class="dt">ylab =</span> <span class="st">&quot;Forest area (%)&quot;</span>)</a></code></pre></div>
<p>This is the function call that plots the graph. We start off by giving <code>plot()</code> the names of two continuous variables (<code>Forest_area</code> and <code>Precipitation</code>), both from the <code>WB</code> data frame. These are separated by a tilde <code>~</code> which means “the one on the left of the tilde as explained by the one on the right”… so <code>plot()</code> will draw us a scatterplot with <code>Forest_area</code> on the y-axis and <code>Precipitation</code> on the x-axis.</p>
<p>Next comes <code>col = palette1[WB$Region],</code> which determines the colours used in the plot. We’ve already set up <code>palette1</code> which is a vector of seven colours derived from the RColorBrewer Dark2 palette. Using the factor <code>Region</code> from the <code>WB</code> data frame as a subscript generates a vector of colours corresponding to the factor levels, as we saw above. Finally we have three fairly simple arguments. <code>pch = 16</code> sets the plot symbol to be a filled circle, and <code>xlab =</code> and <code>ylab =</code> set the two axis labels.</p>
<p>This plots our graph. Moving on to the <code>legend()</code> function call, this is one of a number of R functions which you can use to draw things like lines, text or more data on to an existing graph and we’ll discuss these in detail in the next chapter. For the moment, I’ll just quickly run you thorugh what the various arguments are doing.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">3500</span>, <span class="dt">y=</span><span class="dv">80</span>, </a>
<a class="sourceLine" id="cb43-2" title="2">       <span class="dt">col =</span> palette1, </a>
<a class="sourceLine" id="cb43-3" title="3">       <span class="dt">pch =</span> <span class="dv">16</span>, </a>
<a class="sourceLine" id="cb43-4" title="4">       <span class="dt">legend =</span> <span class="kw">levels</span>(WB<span class="op">$</span>Region), </a>
<a class="sourceLine" id="cb43-5" title="5">       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb43-6" title="6">       <span class="dt">title =</span> <span class="st">&quot;Region&quot;</span>)</a></code></pre></div>
<p>The <code>x=3500, y=80</code> arguments are telling R where to put the top left corner of the legend. The units are the same as those that the graph is plotted in, which makes life a bit easier. Note that 3500 is outside the range of the x-axis, so we’re asking R to plot the legend next to the graph rather than inside the graph box, which is why we have to set <code>par(xpd = TRUE)</code>.</p>
<p><code>col = palette1</code> tells <code>legend()</code> which colours to include, and <code>pch = 16</code> tells it which plot symbol to use. <code>legend = levels(WB$Region)</code> is the code which tells <code>legend()</code> what text to use. In this case the <code>levels()</code> function will give us the names of the levels of the <code>WB$Region</code> factor, and this is the information we’d like on the legend. Two final arguments are <code>bty = "n"</code> — <code>bty</code> stands for “box type” and setting this to “n” means that there isn’t a box drawn around the legend, and finally <code>title = "Region"</code> specifies a title for the legend.</p>
<p>Here’s the final graph:</p>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-26-1.png" width="768" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(colorspace)</a>
<a class="sourceLine" id="cb44-2" title="2"><span class="kw">hcl_palettes</span>(<span class="dt">plot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="3rd_Edition_files/figure-html/unnamed-chunk-27-1.png" width="960" /></p>
</div>
<div id="adding-elements-to-an-existing-graph" class="section level2">
<h2><span class="header-section-number">9.8</span> Adding elements to an existing graph</h2>
<p>All the examples we’ve looked at in detail so far use arguments within the <code>plot()</code> function call to change the appearance of our graph. R also has functions which can draw new elements onto existing graphs. These include:</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>points()</code></td>
<td align="left">Draws points onto a plot</td>
</tr>
<tr class="even">
<td align="left"><code>lines()</code></td>
<td align="left">Draws lines</td>
</tr>
<tr class="odd">
<td align="left"><code>abline()</code></td>
<td align="left">Draws a line specified by intercept and slope</td>
</tr>
<tr class="even">
<td align="left"><code>polygon()</code></td>
<td align="left">Draws a shape</td>
</tr>
<tr class="odd">
<td align="left"><code>arrows()</code></td>
<td align="left">Draws arrows on a plot</td>
</tr>
<tr class="even">
<td align="left"><code>text()</code></td>
<td align="left">Adds text</td>
</tr>
<tr class="odd">
<td align="left"><code>mtext()</code></td>
<td align="left">Adds text in the plot margins</td>
</tr>
<tr class="even">
<td align="left"><code>legend()</code></td>
<td align="left">Adds a legend</td>
</tr>
<tr class="odd">
<td align="left"><code>axis()</code></td>
<td align="left">Adds an axis</td>
</tr>
<tr class="even">
<td align="left"><code>title()</code></td>
<td align="left">Adds a title or subtitle</td>
</tr>
</tbody>
</table>
<p>These functions will all add elements to the plot which is currently displayed in the graphics window, so you have to be a little careful about where you put the code. The best option is to use a script and have these functions directly after the <code>plot()</code> function call. Let’s look at some examples.</p>
</div>
<div id="adding-a-legend" class="section level2">
<h2><span class="header-section-number">9.9</span> Adding a legend</h2>
<p>Our plot needs a legend to let the reader know what the colour coding means. As we can see above, there is a function called <code>legend()</code> which will do this for us.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">plot</span>(pinniped<span class="op">$</span>Male_brain <span class="op">~</span><span class="st"> </span>pinniped<span class="op">$</span>Male_mass,</a>
<a class="sourceLine" id="cb45-2" title="2">     <span class="dt">log  =</span> <span class="st">&quot;xy&quot;</span>,</a>
<a class="sourceLine" id="cb45-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;Body mass (Kg)&quot;</span>,</a>
<a class="sourceLine" id="cb45-4" title="4">     <span class="dt">ylab =</span> <span class="st">&quot;Brain mass (g)&quot;</span>, </a>
<a class="sourceLine" id="cb45-5" title="5">     <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb45-6" title="6">     <span class="dt">col =</span> colours[Mating_system])</a>
<a class="sourceLine" id="cb45-7" title="7"></a>
<a class="sourceLine" id="cb45-8" title="8"></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,</a>
<a class="sourceLine" id="cb45-10" title="10">  <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Harem&quot;</span>, <span class="st">&quot;Non harem&quot;</span>),</a>
<a class="sourceLine" id="cb45-11" title="11">  <span class="dt">col =</span> colours,</a>
<a class="sourceLine" id="cb45-12" title="12">  <span class="dt">pch  =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb45-13" title="13">  <span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">bold</span>(<span class="st">&quot;Mating system&quot;</span>)),</a>
<a class="sourceLine" id="cb45-14" title="14">  <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph11a"></span>
<img src="3rd_Edition_files/figure-html/graph11a-1.png" alt="Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes, colour coded for mating system with legend" width="672" />
<p class="caption">
Figure 9.13: Brain mass versus body mass for 33 species of male pinniped plotted on log scaled axes, colour coded for mating system with legend
</p>
</div>
<p>The first piece of code plots the data, then the second adds the legend. It’s got quite a few arguments so let’s run through them individually. <code>"topleft"</code> tells <code>legend()</code> where to put the legend. There are a number of options for this so <code>"bottomright"</code> would put it in the bottom right hand corner and <code>"top"</code> would place it in the middle of the top. You can find all the options if you look in the “Details” section of the <code>legend()</code> help file.</p>
<p>If you want to be specific about where your legend goes you can use x and y coordinates instead of text descriptions. Lots of these functions add elements to graphs using coordinates, and it’s straightforward to use them because they are on the same scale that the points are plotted on. <code>legend()</code> puts the top left corner of the legend at the specified point so if you replaced <code>legend("topright",...</code> with <code>legend(x = 55, y = 1550,...</code> you’d get a very similar result.</p>
</div>
<div id="drawing-graphs-piece-by-piece" class="section level2">
<h2><span class="header-section-number">9.10</span> Drawing graphs piece-by-piece</h2>
<p>One of the nice things about graphs in R is that we can build complicated ones up by adding elements one after another. Here’s how we can draw our scatterplot with the species distinguished by plotting symbol and colour.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb46-2" title="2">  Haemocyte<span class="op">$</span>Weight,</a>
<a class="sourceLine" id="cb46-3" title="3">  <span class="kw">log</span>(Haemocyte<span class="op">$</span>Count),</a>
<a class="sourceLine" id="cb46-4" title="4">  <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb46-5" title="5">  <span class="dt">xlab =</span> <span class="st">&quot;Weight (g)&quot;</span>,</a>
<a class="sourceLine" id="cb46-6" title="6">  <span class="dt">ylab =</span> <span class="st">&quot;Log Haemocyte count&quot;</span></a>
<a class="sourceLine" id="cb46-7" title="7">)</a></code></pre></div>
<p>We have now defined a series of parameters in our <code>plot()</code> call. I have now told R what I want the axis labels to be using the <em>xlab</em> and <em>ylab</em> parameters. The other thing I have added is that the parameter <em>type</em> is now set to <em>type=”n”</em>. This tells R to plot the axes and the labels, but not to draw in any data points. What we get is this.</p>
<div class="figure"><span id="fig:graphX"></span>
<img src="3rd_Edition_files/figure-html/graphX-1.png" alt="Log haemocyte count plotted against weight with no data points." width="672" />
<p class="caption">
Figure 9.14: Log haemocyte count plotted against weight with no data points.
</p>
</div>
<p>An empty box, with axes scaled properly for our dataset and the correct labels for the axes. Note the lack of all those great “features” you get if you try drawing a scatterplot in a certain popular spreadsheet: gridlines, an ugly grey background, stupid axis scaling, revolting colours and a pointless legend. Of course, our beautiful empty white box is also unsullied by any data points, but we can easily fix that. There are a number of functions that will draw things onto graphs that R has already plotted: <code>points()</code>, <code>lines()</code>, <code>abline()</code>, <code>text()</code> and <code>legend()</code> are some of the most common, and we will use these to build our graph.</p>
<div class="figure"><span id="fig:graphX10"></span>
<img src="3rd_Edition_files/figure-html/graphX10-1.png" alt="Log haemocyte count plotted against weight with no data points." width="672" />
<p class="caption">
Figure 9.15: Log haemocyte count plotted against weight with no data points.
</p>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">points</span>(Haemocyte<span class="op">$</span>Weight[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;P.napi&quot;</span>],</a>
<a class="sourceLine" id="cb47-2" title="2">       <span class="kw">log</span>(Haemocyte<span class="op">$</span>Count [Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;P.napi&quot;</span>]),</a>
<a class="sourceLine" id="cb47-3" title="3">       <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb47-4" title="4">       <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>)</a></code></pre></div>
<p>The <code>points()</code> function draws points onto an existing graph. I’ve told it to draw the points corresponding to <em>P. napi</em>, coloured dark red (<em>col=”darkred”</em>) and using plot character 16, a filled circle (<em>pch=16</em>). Our graph now looks like this.</p>
<div class="figure"><span id="fig:graphX1"></span>
<img src="3rd_Edition_files/figure-html/graphX1-1.png" alt="Log haemocyte count plotted against weight with the P. napi data plotted as red circles." width="672" />
<p class="caption">
Figure 9.16: Log haemocyte count plotted against weight with the P. napi data plotted as red circles.
</p>
</div>
<p>Now we can add in the points for <em>P. brassicae</em>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">points</span>(Haemocyte<span class="op">$</span>Weight[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;P.brassicae&quot;</span>],</a>
<a class="sourceLine" id="cb48-2" title="2">       <span class="kw">log</span>(Haemocyte<span class="op">$</span>Count[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;P.brassicae&quot;</span>]),</a>
<a class="sourceLine" id="cb48-3" title="3">       <span class="dt">pch =</span> <span class="dv">17</span>,</a>
<a class="sourceLine" id="cb48-4" title="4">       <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graphX2"></span>
<img src="3rd_Edition_files/figure-html/graphX2-1.png" alt="Log haemocyte count plotted against weight with the P. brassicae data added as blue triangles." width="672" />
<p class="caption">
Figure 9.17: Log haemocyte count plotted against weight with the P. brassicae data added as blue triangles.
</p>
</div>
<p>Last of all, let’s put in a legend.</p>
<div class="figure"><span id="fig:graphX4"></span>
<img src="3rd_Edition_files/figure-html/graphX4-1.png" alt="Log haemocyte count plotted against weight with the P. brassicae data added as blue triangles." width="672" />
<p class="caption">
Figure 9.18: Log haemocyte count plotted against weight with the P. brassicae data added as blue triangles.
</p>
</div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">legend</span>(</a>
<a class="sourceLine" id="cb49-2" title="2">  <span class="fl">0.38</span>,</a>
<a class="sourceLine" id="cb49-3" title="3">  <span class="fl">5.7</span>,</a>
<a class="sourceLine" id="cb49-4" title="4">  <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;P. napi&#39;</span>, <span class="st">&#39;P. brassicae&#39;</span>),</a>
<a class="sourceLine" id="cb49-5" title="5">  <span class="dt">pch =</span> <span class="dv">16</span><span class="op">:</span><span class="dv">17</span>,</a>
<a class="sourceLine" id="cb49-6" title="6">  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;steelblue&quot;</span>),</a>
<a class="sourceLine" id="cb49-7" title="7">  <span class="dt">cex =</span> <span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb49-8" title="8">  <span class="dt">text.font =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb49-9" title="9">  <span class="dt">bty =</span> <span class="st">&#39;n&#39;</span></a>
<a class="sourceLine" id="cb49-10" title="10">)</a></code></pre></div>
<p>The first two parameters give the location of the legend in the coordinates specified by the axes, then we define the text and the symbols and their colours. The <em>cex=</em> parameter sets the size of the text and symbols and we have set it to be 0.7 times the default value. <em>text.font=3</em> sets the legend font to italic because these are species names. Last of all <em>bty=“n”</em> stops a box being drawn around it.
At the end of this process we get a graph that looks like this.</p>
<div class="figure"><span id="fig:graphX3"></span>
<img src="3rd_Edition_files/figure-html/graphX3-1.png" alt="Final plot for log haemocyte count data versus weight." width="672" />
<p class="caption">
Figure 9.19: Final plot for log haemocyte count data versus weight.
</p>
</div>
<p>This is a nice looking graph. If you’ve written the code to produce it in the script editor (see the “Record Keeping” chapter for more details), or in a different text editor of your choice, you can save the script and then if you want to reproduce the graph later on with any changes it’s easy to do by just running the script again. Let’s say you are submitting your work for publication and need a graph without any use of colour, and you want the axis labels in bold: you can just load your script again. To remove the colours just delete <code>col=“darkred”</code> and <code>col=“steelblue”</code> from the two <code>points()</code> functions and the <code>col=</code> parameter from the <code>legend()</code> function. To make the axis labels bold add <code>font.lab=2</code> to the <code>plot()</code> function, and you can redraw the graph.</p>
<p>Going back to the graph, we can immediately see that the species differ considerably in their weights. It’s not quite so clear what the relationships between weight and haemocyte count are for both species. It would perhaps be more informative to plot two graphs side by side, one for each species, and it would be nice to put a fitted line in as well. This requires an intimidating amount of code, but again we build the figure up step-by-step, and each individual step is simple.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a></code></pre></div>
<p>Not immediately obvious what’s going on here. This function is setting a “low-level plotting parameter”, a graphical parameter that affects the whole of the plot window, to tell R to draw two graphs next to each other. This is fine if you want, say, two plots next to each other, four in a regular grid (‘par(mfrow=c(2,2))’ or two plots, one above the other (<code>par(mafrow=c(2,1))</code>. More complex designs can be produced using <code>layout()</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb51-2" title="2">  Haemocyte<span class="op">$</span>Weight[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &#39;P.brassicae&#39;</span>],</a>
<a class="sourceLine" id="cb51-3" title="3">  <span class="kw">log</span>(Haemocyte<span class="op">$</span>Count[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &#39;P.brassicae&#39;</span>]),</a>
<a class="sourceLine" id="cb51-4" title="4">  <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb51-5" title="5">  <span class="dt">xlab =</span> <span class="st">&#39;Weight (g)&#39;</span>,</a>
<a class="sourceLine" id="cb51-6" title="6">  <span class="dt">ylab =</span> <span class="st">&#39;Log Haemocyte count&#39;</span>,</a>
<a class="sourceLine" id="cb51-7" title="7">  <span class="dt">main =</span> <span class="st">&#39;P.brassicae&#39;</span>,</a>
<a class="sourceLine" id="cb51-8" title="8">  <span class="dt">font.main =</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb51-9" title="9">)</a></code></pre></div>
<p>This sets up the first plot, for <code>P. brassicae</code>. The parameter “main” specifies the graph title, the <code>font.main</code> italicises it. We’ve also asked for the plotting symbol to be number 16, filled circles. Now for a line fitted to the <em>P. brassicae</em> data.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">lm</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;P.brassicae&quot;</span>]) <span class="op">~</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="st">     </span>Haemocyte<span class="op">$</span>Weight[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st">&quot;P.brassicae&quot;</span>])</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Haemocyte$Count[Haemocyte$Species == &quot;P.brassicae&quot;]) ~ 
##     Haemocyte$Weight[Haemocyte$Species == &quot;P.brassicae&quot;])
## 
## Coefficients:
##                                          (Intercept)  
##                                                4.575  
## Haemocyte$Weight[Haemocyte$Species == &quot;P.brassicae&quot;]  
##                                               -0.765</code></pre>
<p>￼
This calculates a linear regression (see chapter 11) of log haemocyte count on weight for P. brassicae only. We haven’t set up an object with the results in: just told R to calculate it, which gives us the the slope and the intercept.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">abline</span>(<span class="fl">4.575</span>, <span class="fl">-0.765</span>)</a></code></pre></div>
<p>This uses the function <code>abline()</code> which draws a straight line on an existing plot. <em>a</em> is the intercept, <em>b</em> is the slope, and these come from the <code>lm()</code> call we used above.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb55-2" title="2">  Haemocyte<span class="op">$</span>Weight[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;P.napi&quot;</span>],</a>
<a class="sourceLine" id="cb55-3" title="3">  <span class="kw">log</span>(Haemocyte<span class="op">$</span>Count[Haemocyte<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;P.napi&quot;</span>]),</a>
<a class="sourceLine" id="cb55-4" title="4">  <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb55-5" title="5">  <span class="dt">xlab =</span> <span class="st">&quot;Weight (g)&quot;</span>,</a>
<a class="sourceLine" id="cb55-6" title="6">  <span class="dt">ylab =</span> <span class="st">&quot;Log Haemocyte count&quot;</span>,</a>
<a class="sourceLine" id="cb55-7" title="7">  <span class="dt">main =</span> <span class="st">&quot;P. Napi&quot;</span>,</a>
<a class="sourceLine" id="cb55-8" title="8">  <span class="dt">font.main =</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb55-9" title="9">)</a></code></pre></div>
<p>This plots the graph for P. napi.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">abline</span>(<span class="kw">lm</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count[Haemocyte<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;P.napi&quot;</span>]) <span class="op">~</span><span class="st"> </span>Haemocyte<span class="op">$</span>Weight[Haemocyte<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;P.napi&quot;</span>]))</a></code></pre></div>
<p>This is another use of <code>abline</code>: it is happy if you specify the intercept and slope directly, but it’s also happy to take the output of an <code>lm()</code> function call directly. Put them all together and you get this pair of graphs.</p>
<div class="figure"><span id="fig:graph12"></span>
<img src="3rd_Edition_files/figure-html/graph12-1.png" alt="Log haemocyte count plotted against weight for the two butterfly species on separate plots with fitted lines." width="768" />
<p class="caption">
Figure 9.20: Log haemocyte count plotted against weight for the two butterfly species on separate plots with fitted lines.
</p>
</div>
<p>Looks like the relationship between weight and log haemocyte count is dependent on species. Getting ahead of ourselves in the stats a bit, to analyse this you’d want to fit a model with both species and weight and look for an interaction between the two.</p>
</div>
<div id="drawing-curves" class="section level2">
<h2><span class="header-section-number">9.11</span> Drawing curves</h2>
<p>There are lots of ways to add a curve to a plot in R; we’ll look at two of them. The first is to use the <code>curve()</code> function, which does what it says on the tin. As an example, here is a plot of log horn size versus log body size (the latter estimated by measuring the width of the pronotum, the front part of the thorax) for males of a species of beetle called <em>Euoniticellus intermedius</em>^1. You can see that the slope of the relationship decreases as the beetles get larger, and we might want to describe this relationship with a quadratic model (see the chapter on linear regression for a worked example of how to fit one of these).</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb57-2" title="2">  <span class="kw">log</span>(beetle<span class="op">$</span>int_pron),</a>
<a class="sourceLine" id="cb57-3" title="3">  <span class="kw">log</span>(beetle<span class="op">$</span>int_horn),</a>
<a class="sourceLine" id="cb57-4" title="4">  <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb57-5" title="5">  <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb57-6" title="6">  <span class="dt">xlab =</span> <span class="st">&quot;Log pronotum width (mm)&quot;</span>,</a>
<a class="sourceLine" id="cb57-7" title="7">  <span class="dt">ylab =</span> <span class="st">&quot;Log horn length (mm)&quot;</span></a>
<a class="sourceLine" id="cb57-8" title="8">)</a></code></pre></div>
<div class="figure"><span id="fig:graph13"></span>
<img src="3rd_Edition_files/figure-html/graph13-1.png" alt="Horn length versus pronotum width for E. intermedius." width="672" />
<p class="caption">
Figure 9.21: Horn length versus pronotum width for E. intermedius.
</p>
</div>
<p>We know that the equation of the curve we want to fit is <em>y=-8.054 + 3.718x -0.396x^2</em>, so we can put this into <code>curve()</code> as its first argument. We then have to tell it the x-values to draw the curve from and to, and we’ll use the minumum and maximum values for the <em>E. intermedius</em> pronotum width for this. Finally we need the argument <em>add=TRUE</em> to make it add it to the plot we’ve already drawn, otherwise it will draw the curve on a new plot.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb58-2" title="2">  <span class="kw">log</span>(beetle<span class="op">$</span>int_pron),</a>
<a class="sourceLine" id="cb58-3" title="3">  <span class="kw">log</span>(beetle<span class="op">$</span>int_horn),</a>
<a class="sourceLine" id="cb58-4" title="4">  <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb58-5" title="5">  <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb58-6" title="6">  <span class="dt">xlab =</span> <span class="st">&quot;Log pronotum width (mm)&quot;</span>,</a>
<a class="sourceLine" id="cb58-7" title="7">  <span class="dt">ylab =</span> <span class="st">&quot;log horn length (mm)&quot;</span></a>
<a class="sourceLine" id="cb58-8" title="8">)</a>
<a class="sourceLine" id="cb58-9" title="9"></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="kw">curve</span>(</a>
<a class="sourceLine" id="cb58-11" title="11">  <span class="fl">-26.66</span> <span class="op">+</span><span class="st"> </span><span class="fl">34.46</span> <span class="op">*</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="fl">11.04</span> <span class="op">*</span><span class="st"> </span>(x <span class="op">^</span><span class="st"> </span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb58-12" title="12">  <span class="dt">from =</span> <span class="kw">min</span>(<span class="kw">log</span>(beetle<span class="op">$</span>int_pron), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb58-13" title="13">  <span class="dt">to =</span> <span class="kw">max</span>(<span class="kw">log</span>(beetle<span class="op">$</span>int_pron), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb58-14" title="14">  <span class="dt">add =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb58-15" title="15">)</a></code></pre></div>
<div class="figure"><span id="fig:graph14"></span>
<img src="3rd_Edition_files/figure-html/graph14-1.png" alt="Previous plot with line showing fitted quadratic model." width="672" />
<p class="caption">
Figure 9.22: Previous plot with line showing fitted quadratic model.
</p>
</div>
<p>The second option is to set up a dummy x-variable with a sequence of points running from the minimum and maximum points where you want the curve to run from and to, and then to calculate the corresponding y-variables and draw them in with <code>points()</code>, with the <em>type</em> argument set to <em>type=“l”</em>. Here’s another beetle example - this one is the plot of log horn length versus log pronotum width for male beetles from a species called <em>Onthophagus taurus</em>. You can see that the shape of the relationship is quite complex: these beetles have males which follow one of two strategies to get mates, the big ones fight other beetles for access to females whereas the small ones don’t fight but try to acquire ‘sneaky’ matings when the big beetles are distracted or elsewhere, so the small beetles don’t bother growing horns^2.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb59-2" title="2">  beetle<span class="op">$</span>taurus_pron,</a>
<a class="sourceLine" id="cb59-3" title="3">  beetle<span class="op">$</span>taurus_horn,</a>
<a class="sourceLine" id="cb59-4" title="4">  <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb59-5" title="5">  <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb59-6" title="6">  <span class="dt">xlab =</span> <span class="st">&quot;Pronotum width (mm)&quot;</span>,</a>
<a class="sourceLine" id="cb59-7" title="7">  <span class="dt">ylab =</span> <span class="st">&quot;Horn length (mm)&quot;</span></a>
<a class="sourceLine" id="cb59-8" title="8">)</a></code></pre></div>
<div class="figure"><span id="fig:graph15"></span>
<img src="3rd_Edition_files/figure-html/graph15-1.png" alt="Horn length versus pronotum width for O. taurus." width="672" />
<p class="caption">
Figure 9.23: Horn length versus pronotum width for O. taurus.
</p>
</div>
<p>There are lots of possible ways to describe patterns like this in these data, and one option is to use an equation of the form^3</p>
<p><img src="Ch5eqn1.png" width="33%" height="33%"/></p>
<p>This has to be fitted to the data using a <em>non-linear</em> model fitting process, and assuming we’ve done that we know that our estimates for the coefficients are:</p>
<p><em>y<sub>0</sub></em> = 0.41
<em>a</em> = 3.99
<em>b</em> = 45.76
<em>c</em> = 5.01</p>
<p>Here is our dummy x-variable.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">X1 &lt;-</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="st">  </span><span class="kw">seq</span>(</a>
<a class="sourceLine" id="cb60-3" title="3">    <span class="dt">from =</span> <span class="kw">min</span>(beetle<span class="op">$</span>taurus_pron, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb60-4" title="4">    <span class="dt">to =</span> <span class="kw">max</span>(beetle<span class="op">$</span>taurus_pron, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb60-5" title="5">    <span class="dt">length =</span> <span class="dv">200</span></a>
<a class="sourceLine" id="cb60-6" title="6">  )</a></code></pre></div>
<p>This will give us 200 evenly spaced numbers across the range of pronotum widths. Now we need to work out the corresponding y values.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">Y1 &lt;-<span class="st"> </span><span class="fl">0.41</span> <span class="op">+</span><span class="st"> </span>(<span class="fl">3.99</span> <span class="op">*</span><span class="st"> </span>(X1 <span class="op">^</span><span class="st"> </span><span class="fl">45.76</span>)) <span class="op">/</span><span class="st"> </span>(<span class="fl">5.01</span> <span class="op">^</span><span class="st"> </span><span class="fl">45.76</span> <span class="op">+</span><span class="st"> </span>(X1 <span class="op">^</span><span class="st"> </span><span class="fl">45.76</span>))</a></code></pre></div>
<p>Now we can replot our graph and draw in the curve using <code>points()</code>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb62-2" title="2">  beetle<span class="op">$</span>taurus_pron,</a>
<a class="sourceLine" id="cb62-3" title="3">  beetle<span class="op">$</span>taurus_horn,</a>
<a class="sourceLine" id="cb62-4" title="4">  <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb62-5" title="5">  <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb62-6" title="6">  <span class="dt">xlab =</span> <span class="st">&quot;Pronotum width (mm)&quot;</span>,</a>
<a class="sourceLine" id="cb62-7" title="7">  <span class="dt">ylab =</span> <span class="st">&quot;Horn length (mm)&quot;</span></a>
<a class="sourceLine" id="cb62-8" title="8">)</a>
<a class="sourceLine" id="cb62-9" title="9"></a>
<a class="sourceLine" id="cb62-10" title="10"><span class="kw">points</span>(X1, Y1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph16"></span>
<img src="3rd_Edition_files/figure-html/graph16-1.png" alt="Horn length versus pronotum width for O. taurus with fitted curve" width="672" />
<p class="caption">
Figure 9.24: Horn length versus pronotum width for O. taurus with fitted curve
</p>
</div>
<p>The first method, using <code>curve()</code> is simplest when you have a straightforward equation to descibe your curve. The second comes in handy in lots of other sutuations though, such as when you have a complex model and you want to draw a line showing the fitted model. In this case you can use the <code>predict()</code> function to calculate your y values without having to worry about copying out all of the fitted model coefficients. You’ll see examples of this being done in the chapter on linear regression and TB.</p>
</div>
<div id="plots-of-variables-by-factors" class="section level2">
<h2><span class="header-section-number">9.12</span> Plots of Variables by Factors</h2>
<p>As we have seen, scatterplots are easy and well implemented in R. Probably the next most frequent sort of data that most biologists want to graph is a continuous variable categorised by a factor. R has a variety of ways of doing this, which again use <code>plot()</code>. As we’ve seen several times the style of graph that <code>plot()</code> draws depends on the arguments it’s given, and if it gets asked to plot a factor against a continuous variable the graph produced varies depending on the order the arguments are in and whether they’re presented as a formula or not.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a></code></pre></div>
<p>Please plot two rows and two columns of graphs.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">plot</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count), Haemocyte<span class="op">$</span>Species, <span class="dt">xlab=</span><span class="st">&quot;Log haemocyte count&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Plot 1: Continuous,Factor&quot;</span>)</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw">plot</span>(Haemocyte<span class="op">$</span>Species, <span class="kw">log</span>(Haemocyte<span class="op">$</span>Count), <span class="dt">ylab=</span><span class="st">&#39;Log haemocyte count&#39;</span>, <span class="dt">main=</span><span class="st">&quot;Plot 2: Factor,Continuous&quot;</span>)</a>
<a class="sourceLine" id="cb64-3" title="3"><span class="kw">plot</span>(Haemocyte<span class="op">$</span>Species<span class="op">~</span><span class="kw">log</span>(Haemocyte<span class="op">$</span>Count), <span class="dt">xlab=</span><span class="st">&#39;Log haemocyte count&#39;</span>, <span class="dt">main=</span><span class="st">&quot;Plot 3: Factor~Continuous&quot;</span>)</a>
<a class="sourceLine" id="cb64-4" title="4"><span class="kw">plot</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count)<span class="op">~</span>Haemocyte<span class="op">$</span>Species, <span class="dt">ylab=</span><span class="st">&quot;Log haemocyte count&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Plot 4: Continuous~Factor&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph17"></span>
<img src="3rd_Edition_files/figure-html/graph17-1.png" alt="What happens when you use the `plot()` function on the same data but with the variables presented in different orders and as separate arguments or formulae." width="768" />
<p class="caption">
Figure 9.25: What happens when you use the <code>plot()</code> function on the same data but with the variables presented in different orders and as separate arguments or formulae.
</p>
</div>
<p>Here we see the way that <code>plot()</code> does different things depending on what it’s told to act on. We’ve asked it to plot the same two variables each time, with the only difference between each function call being the order that the two objects are in and whether they’re included as two arguments separated by a comma or as a formula with a tilde. Plot 1, with our continuous variable specified as the one to be plotted on the x-axis, is a strip chart. These can be useful for visualising data, especially when sample sizes aren’t big. R has a function that specifically draws strip charts as well, <code>stripchart()</code>, which produces somewhat better results.</p>
<p>Plot 2 is the output when the <code>plot()</code> function is given a factor as the x-axis variable and a continuous variable as the y-axis: a boxplot showing the continuous variable categorised by the factor. You can also draw boxplots using the <code>boxplot()</code> function, which gives you lots of options for things like the width of the boxes, the length of the whiskers and what to do about outliers.</p>
<p>Plot 3 shows us what happens when we give the <code>plot()</code> function a formula of the form factor~continuous variable. This rather odd-looking graph is a spine plot, which is something that sits between a stacked bar plot and a histogram. It’s not much help for visualising these data but similar plots can be useful if in circumstances where you have several categories and then subcategories within them and want to visualise both the numbers in the categories and, within those categories, the proportions in each subcategory. As with our other plots there is a more flexible function that will draw spine plots only, <code>spineplot()</code>.</p>
<p>Finally, plot 4 shows us what R produces when we give it a formula that is of the form continuous variable~factor: a boxplot identical to plot 2, so there are two ways to produce this graph using <code>plot()</code>. One potential source of confusion here is the order that the variables go in a formula rather than if we just put them in as separate arguments with a comma between them. If we use separate arguments then the first argument is plotted on the x-axis and the second on the y-axis, so to produce our boxplot we use <code>plot(Haemocyte$Species, log(Haemocyte$Count))</code>. If we’re using a formula, however, it’s the other way around, and the y-axis variable goes first: <code>plot(log(Haemocyte$Count)~Haemocyte$Species)</code>.</p>
<p>This is great for producing nice boxplots, but what if, say, you want to plot means and confidence limits instead? I think a lot of statisticians would argue that boxplots are the best way to visualise data like this, but in biology a lot of people expect graphs of means and confidence intervals even when these are arguably inferior to boxplots. I’ve personally been made by referees to replace boxplots in publications with plots of means and confidence intervals, and mine is not an isolated experience. Unfortunately there isn’t a straightforward method for producing such plots implemented in the core R release, but that doesn’t mean you can’t draw them: one option is to install the package called <code>gplots</code> (see the chapter on R packages for more on this), which has a handy function called <code>plotmeans()</code>: an alternative is to write your own function, which we do as an exercise in the chapters on programming.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;gplots&quot;</span>)</a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">library</span>(gplots)</a></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">plotmeans</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count)<span class="op">~</span>Haemocyte<span class="op">$</span>Species)</a></code></pre></div>
<div class="figure"><span id="fig:graph18"></span>
<img src="3rd_Edition_files/figure-html/graph18-1.png" alt="Default output from `plotmeans()`." width="672" />
<p class="caption">
Figure 9.26: Default output from <code>plotmeans()</code>.
</p>
</div>
<p>OK, it’s plotted the two means and the 95% confidence limits, and this is a useful plot to just have a look at our data with. Nevertheless, we could improve quite a few things before we start thinking about adding this particular graphic to our latest submission to Nature. The helpful indicators of sample size and the line connecting the two means could do with being lost. The points for the means might be better if they were bigger, and the error bars could go in black instead of blue. To find out how to sort all of these issues out, take a look at the help file.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">plotmeans</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count)<span class="op">~</span>Haemocyte<span class="op">$</span>Species, <span class="dt">connect=</span>F, <span class="dt">barcol=</span><span class="st">&#39;black&#39;</span>, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">n.label=</span>F, <span class="dt">ylab=</span><span class="st">&quot;Log Haemocyte Count&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph19"></span>
<img src="3rd_Edition_files/figure-html/graph19-1.png" alt="Nicer looking graph with 95% CIs" width="672" />
<p class="caption">
Figure 9.27: Nicer looking graph with 95% CIs
</p>
</div>
<p>Nicer looking graph with 95% CIs from <code>plotmeans()</code></p>
<p>Nice. Still can’t submit it for publication, though, because those species names aren’t in italics. There is a parameter called “<code>font.axis</code>” which ought to set the axis text to italic if set to 3…</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">plotmeans</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count)<span class="op">~</span>Haemocyte<span class="op">$</span>Species, <span class="dt">connect=</span>F, <span class="dt">barcol=</span><span class="st">&#39;black&#39;</span>, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">n.label=</span>F, <span class="dt">ylab=</span><span class="st">&quot;Log Haemocyte Count&quot;</span>, <span class="dt">font.axis=</span><span class="dv">3</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph20"></span>
<img src="3rd_Edition_files/figure-html/graph20-1.png" alt="Disappointingly similar to the last." width="672" />
<p class="caption">
Figure 9.28: Disappointingly similar to the last.
</p>
</div>
<p>￼
Not exactly the outcome we were hoping for: the y-axis labels are italic, but the x-axis labels are not. I’m sure there’s a good reason why this has happened, but I have no clue what that reason might be. Welcome to the wonderful world of R. Fortunately there is an alternative: we can draw the graph without an x-axis (set the parameter <em>xaxt</em> to <em>“n”</em>), and then use the <code>axis()</code> function to put in a new axis with italicised species names.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">plotmeans</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count)<span class="op">~</span>Haemocyte<span class="op">$</span>Species, <span class="dt">connect=</span>F, <span class="dt">barcol=</span><span class="st">&#39;black&#39;</span>, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">n.label=</span>F, <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;Log haemocyte count&quot;</span>)</a>
<a class="sourceLine" id="cb69-2" title="2"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;P. brassicae&quot;</span>,<span class="st">&quot;P. napi&quot;</span>),<span class="dt">font=</span><span class="dv">3</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph21"></span>
<img src="3rd_Edition_files/figure-html/graph21-1.png" alt="Sweet graph o’mine" width="672" />
<p class="caption">
Figure 9.29: Sweet graph o’mine
</p>
</div>
<p>The other way to draw error bars onto a graph is to use the <code>arrows()</code> function, which draws arrows. Because it allows you to specify the angle between the lines of the arrowhead, you can use it to draw error bars. It’s easier to do it with plotmeans, but if you want to produce (say) a bar graph with error bars, or a plot with non-standard error bars, you’ll need to use <code>arrows()</code>.</p>
<p>Here’s a script that will draw a bar graph of mean log haemocyte count versus species with error bars representing one standard error.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co">###Draw barplot of mean log haemocyte counts with standard error bars</span></a>
<a class="sourceLine" id="cb70-2" title="2"></a>
<a class="sourceLine" id="cb70-3" title="3">means&lt;-<span class="kw">tapply</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count),Haemocyte<span class="op">$</span>Species,mean)  <span class="co">#Set up matrix of means</span></a>
<a class="sourceLine" id="cb70-4" title="4"></a>
<a class="sourceLine" id="cb70-5" title="5">log.haem.sd&lt;-<span class="kw">tapply</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count),Haemocyte<span class="op">$</span>Species,sd)    <span class="co">#Matrix of standard deviations</span></a>
<a class="sourceLine" id="cb70-6" title="6"></a>
<a class="sourceLine" id="cb70-7" title="7">log.haem.se&lt;-<span class="kw">c</span>(log.haem.sd[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(Haemocyte<span class="op">$</span>Count[Haemocyte<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;P.brassicae&quot;</span>])<span class="op">-</span><span class="dv">1</span>), log.haem.sd[<span class="dv">2</span>]<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(Haemocyte<span class="op">$</span>Count[Haemocyte<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;P.napi&quot;</span>])<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb70-8" title="8"><span class="co">#matrix of standard errors calculated by dividing standard deviations by square root of n-1.</span></a>
<a class="sourceLine" id="cb70-9" title="9"></a>
<a class="sourceLine" id="cb70-10" title="10">plot.loc&lt;-<span class="kw">barplot</span>(means,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>),<span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Log haemocyte count&quot;</span>)</a>
<a class="sourceLine" id="cb70-11" title="11"><span class="co">#draw barplot and set up an object containing the locations of the centre points of the bars on the x axis.</span></a>
<a class="sourceLine" id="cb70-12" title="12"></a>
<a class="sourceLine" id="cb70-13" title="13"><span class="kw">arrows</span>(plot.loc,means,plot.loc,means<span class="op">+</span>log.haem.se,<span class="dt">angle=</span><span class="dv">90</span>) <span class="co">#add upper error bars</span></a>
<a class="sourceLine" id="cb70-14" title="14"></a>
<a class="sourceLine" id="cb70-15" title="15"><span class="kw">arrows</span>(plot.loc,means,plot.loc,means<span class="op">-</span>log.haem.se,<span class="dt">angle=</span><span class="dv">90</span>) <span class="co">#add lower error bars</span></a>
<a class="sourceLine" id="cb70-16" title="16"></a>
<a class="sourceLine" id="cb70-17" title="17"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span>plot.loc,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;P.brassicae&quot;</span>,<span class="st">&quot;P.napi&quot;</span>),<span class="dt">font=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">0</span>) <span class="co">#add axis labels for the species names</span></a></code></pre></div>
<p>This gives us the graph shown below.</p>
<div class="figure"><span id="fig:graph22"></span>
<img src="3rd_Edition_files/figure-html/graph22-1.png" alt="Bar graph of log haemocyte count by species with 95% CI error bars" width="672" />
<p class="caption">
Figure 9.30: Bar graph of log haemocyte count by species with 95% CI error bars
</p>
</div>
<p>This is an unusual plot. Often when people use bar graphs like this they will truncate the y-axis without making it clear that they’ve done so. When the y-axis does not go all the way to the origin, however, the default option in R is to draw the bars so that it’s clear that there is more bar below. This makes it less likely that a casual look will give the impression that the effect size is larger than it really is, surely a good thing.</p>
<hr />
</div>
<div id="using-transparency-in-your-graphs" class="section level2">
<h2><span class="header-section-number">9.13</span> Using transparency in your graphs</h2>
<p>Something that you can do if you wish to dip your toe into the waters of hexadecimal colour coding is use colours which are transparent, so parts of the graph that are plotted underneath them can show through. This can be useful if, for example, you wish to produce a figure with two histograms plotted on top of each other so that the shapes of two frequency distributions can be compared. We can illustrate this with some results data from the 2012 Ironman Triathlon World Championship in Hawaii. This is a race in which the participants swim for 3.8km, cycle for 180km and then run a marathon. We’ll look at these data again in the chapter on correlation, but for the moment we’ll look at the distributions of bike times for male competitors in two age classes: 25-29 years old and 50-54 years old.</p>
<p>First we need to find out the hexadecimal values for the colours we’d like to use. For the first histogram we will use the colour <em>skyblue1</em>. The hexadecimal value for this can be generated using a function called <code>col2rgb()</code>, which gives the RGB values for a named colour. We have to tell R that we want the values given as hexadecimal rather than base 10, which we do with the <code>as.hexmode()</code> function.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">as.hexmode</span>(<span class="kw">col2rgb</span>(<span class="st">&quot;skyblue1&quot;</span>))</a></code></pre></div>
<pre><code>##       [,1]
## red   &quot;87&quot;
## green &quot;ce&quot;
## blue  &quot;ff&quot;</code></pre>
<p>Our hexadecimal value for <em>skyblue1</em> is “#87CEFF”. For the colour of the histogram plotted over the top we can use plain red, which we know is #FF0000. To make this transparent we add an extra two digits to the right hand side of this number, which determine how see-through it will be. Low values mean that most of what is drawn below will show through, so if we gave this “alpha channel” number as 32 then 32/255 or 12.5% of the top value will be seen. Alternatively, if we gave it as CC (the alpha channel is also specified in hexadecimal) then 204/255 or 80% of the colour drawn on the top will be seen. We’ll use AA which means that 66% of the top colour will be used.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">hist</span>(IMH<span class="op">$</span>Bike[IMH<span class="op">$</span>Gender<span class="op">==</span><span class="st">&quot;M&quot;</span><span class="op">&amp;</span>IMH<span class="op">$</span>Category<span class="op">==</span><span class="st">&quot;25-29&quot;</span>],<span class="dt">col=</span><span class="st">&quot;#87CEFF&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">4.6</span>,<span class="dv">8</span>),<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Bike split (hours)&quot;</span>)</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="kw">hist</span>(IMH<span class="op">$</span>Bike[IMH<span class="op">$</span>Gender<span class="op">==</span><span class="st">&quot;M&quot;</span><span class="op">&amp;</span>IMH<span class="op">$</span>Category<span class="op">==</span><span class="st">&quot;50-54&quot;</span>],<span class="dt">col=</span><span class="st">&quot;#FF0000AA&quot;</span>,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">18</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph23"></span>
<img src="3rd_Edition_files/figure-html/graph23-1.png" alt="Histograms showing the frequency distribution of bike splits for males aged 25-29 (pale blue) and aged 55-59 (red) at the Hawaii Ironman Triathlon 2012" width="672" />
<p class="caption">
Figure 9.31: Histograms showing the frequency distribution of bike splits for males aged 25-29 (pale blue) and aged 55-59 (red) at the Hawaii Ironman Triathlon 2012
</p>
</div>
<p>A second use for transparency is when you are plotting lots of overlapping data points. If you use a semi-transparent plot symbol in these cases then the amount of overplotting becomes clear and a scatterplot or similar can give more information than it would otherwise. Here are the bike times at the Hawaii Ironman Triathlon plotted against the run times for each competitor, using two different degrees of transparency. You can see that as we increase the amount of transparency the focus of the graph chamges from the overall shape of the spread of data to the region of the graph where the heaviest concentration of data points is found.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="kw">plot</span>(IMH<span class="op">$</span>Bike,IMH<span class="op">$</span>Run,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">&quot;#1010CC66&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Bike split (hours)&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Run split (hours)&quot;</span>)</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="kw">plot</span>(IMH<span class="op">$</span>Bike,IMH<span class="op">$</span>Run,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">&quot;#1010CC33&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Bike split (hours)&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Run split (hours)&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph24"></span>
<img src="3rd_Edition_files/figure-html/graph24-1.png" alt="Run split plotted against bike split for each individual competitor at the Hawaii Ironman Triathlon. The datapoints in the left hand graph are less transparent than those in the right hand graph." width="768" />
<p class="caption">
Figure 9.32: Run split plotted against bike split for each individual competitor at the Hawaii Ironman Triathlon. The datapoints in the left hand graph are less transparent than those in the right hand graph.
</p>
</div>
</div>
<div id="more-graphics-functions" class="section level2">
<h2><span class="header-section-number">9.14</span> More Graphics Functions</h2>
<p>In addition to <code>plot()</code>, there are lots of other functions for drawing graphs, and you can produce just about any sort of plot you can imagine using R. We’ve already seen <code>barplot()</code> in action, here are some further examples.</p>
<div id="histogram-with-overlaid-probability-density-estimate" class="section level3">
<h3><span class="header-section-number">9.14.1</span> Histogram with overlaid probability density estimate</h3>
<p>There is an argument for the <code>hist()</code> function called “<code>freq</code>” which is normally set to <code>NULL</code>, but if you set it to <code>F</code> will draw a frequency histogram with the y axis scaled not to count but to the relative frequency density, such that the total area under the graph=1. A probability density estimate can then be obtained using <code>density()</code>, which computes a kernel density estimate for the variable in question.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">hist</span>(Haemocyte<span class="op">$</span>Weight,<span class="dt">breaks=</span><span class="dv">15</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Relative frequency&quot;</span>,  <span class="dt">freq=</span>F)</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw">lines</span>(<span class="kw">density</span>(Haemocyte<span class="op">$</span>Weight))</a></code></pre></div>
<div class="figure"><span id="fig:graph25"></span>
<img src="3rd_Edition_files/figure-html/graph25-1.png" alt="Frequency histogram of weight with probability density estimate drawn as a line." width="672" />
<p class="caption">
Figure 9.33: Frequency histogram of weight with probability density estimate drawn as a line.
</p>
</div>
<p>We can increase or decrease the amount of smoothing in the density estimate by using the “adjust” argument.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">hist</span>(Haemocyte<span class="op">$</span>Weight,<span class="dt">breaks=</span><span class="dv">15</span>,<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Relative frequency&quot;</span>, <span class="dt">freq=</span>F)</a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">lines</span>(<span class="kw">density</span>(Haemocyte<span class="op">$</span>Weight,<span class="dt">adjust=</span><span class="fl">0.5</span>), <span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">lines</span>(<span class="kw">density</span>(Haemocyte<span class="op">$</span>Weight,<span class="dt">adjust=</span><span class="dv">2</span>), <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph26"></span>
<img src="3rd_Edition_files/figure-html/graph26-1.png" alt="As the previous figure but with two probability density estimates showing different amounts of smoothing" width="672" />
<p class="caption">
Figure 9.34: As the previous figure but with two probability density estimates showing different amounts of smoothing
</p>
</div>
<p>Here I’ve plotted two kernel density estimates. The first one has the amount of smoothing reduced from the default by half (<code>adjust=0.5</code>), giving a line that closely follows the distribution of the data, and the second has the amount of smoothing set to twice the default (<code>adjust=2</code>), giving a much smoother line. Two further points to note are firstly that I set the type of line using the <code>lty=</code> parameter, and secondly the location of the various arguments. Because the <code>adjust=</code> argument is used in the <code>density()</code> function it’s kept within the brackets associated with the function, whereas the <code>lty=</code> argument goes with the <code>lines()</code> function so it’s inside the outer set of brackets. Easy to get confused if you don’t think about which arguments are associated with which functions.</p>
</div>
<div id="pie-graph" class="section level3">
<h3><span class="header-section-number">9.14.2</span> Pie graph</h3>
<p>Before you draw a pie graph, please read the help file for the <code>pie()</code> function, in particular the part beginning “Pie charts are a very bad way of displaying information…”. If you still want to draw a pie graph, please go directly to your nearest decent library and read the whole of Edward Tufte’s brilliant and beautiful book, The Visual Display of Quantitative Information (published by Graphics Press USA, 2nd edition 2001, ISBN 978-0961392147). That should teach you the error of your ways. If, however, you still want to draw a pie graph for some reason (perhaps you’re a journalist or a politician and want to disguise the patterns in some data) the you can use the <code>pie()</code> function. Here’s an example with made up data:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">chart.numbers&lt;-<span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">108</span>,<span class="dv">220</span>,<span class="dv">22</span>,<span class="dv">170</span>)</a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">names</span>(chart.numbers)&lt;-<span class="kw">c</span>(<span class="st">&quot;Bar&quot;</span>, <span class="st">&quot;2D Pie&quot;</span>, <span class="st">&quot;3D Pie&quot;</span>, <span class="st">&quot;Scatter&quot;</span>, <span class="st">&quot;Doughnut&quot;</span>)</a>
<a class="sourceLine" id="cb77-3" title="3">chart.numbers2&lt;-<span class="kw">c</span>(<span class="dv">119</span>,<span class="dv">12</span>,<span class="dv">280</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb77-4" title="4"><span class="kw">names</span>(chart.numbers2)&lt;-<span class="kw">c</span>(<span class="st">&quot;Bar&quot;</span>, <span class="st">&quot;2D Pie&quot;</span>, <span class="st">&quot;Scatter&quot;</span>, <span class="st">&quot;Doughnut&quot;</span>)</a>
<a class="sourceLine" id="cb77-5" title="5"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb77-6" title="6"><span class="kw">pie</span>(chart.numbers)</a>
<a class="sourceLine" id="cb77-7" title="7"><span class="kw">text</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="st">&quot;Frequencies of graphs in marketing material&quot;</span>, <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">font=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb77-8" title="8"><span class="kw">pie</span>(chart.numbers2)</a>
<a class="sourceLine" id="cb77-9" title="9"><span class="kw">text</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="st">&quot;Frequencies of graphs in research papers&quot;</span>, <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">font=</span><span class="dv">2</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph27"></span>
<img src="3rd_Edition_files/figure-html/graph27-1.png" alt="Pie graphs. Nothing more to say." width="960" />
<p class="caption">
Figure 9.35: Pie graphs. Nothing more to say.
</p>
</div>
<p>There you are. The default colours are a bit meh but I can’t be bothered to fix them.</p>
</div>
<div id="d-scatterplot" class="section level3">
<h3><span class="header-section-number">9.14.3</span> 3D scatterplot</h3>
<p>In general it’s best to try to avoid presenting your data in “3D” graphs if at all possible because there are inevitable distortions that appear when you try to show a 3D cloud of points or surface in 2D, and the patterns in the data can appear very different depending on the angle of view. Nonetheless, there are times when it’s hard to find an alternative, and if you can’t avoid it there are a number of functions in R to draw 3D graphs. Here we’ll use the <code>scatterplot3d()</code> function from the <code>scatterplot3d</code> package. Some other useful 3D plotting functions are in the lattice package, including <code>cloud()</code> which also plots 3D scatterplots and <code>wireframe()</code> which draws a surface.</p>
<p>Some simulated data:</p>
<p>X variable is random and uniformly distributed between 0 and 12</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">x1&lt;-<span class="kw">runif</span>(<span class="dv">25</span>, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">12</span>)</a></code></pre></div>
<p>y variable is random and normally distributed with a mean of 15 and a standard deviation of 3</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">y1&lt;-<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">15</span>, <span class="dt">sd=</span><span class="dv">3</span>)</a></code></pre></div>
<p>Some randomly distributed error for our z variable</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">err1&lt;-<span class="kw">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="dv">2</span>)</a></code></pre></div>
<p>Calculate the z variable</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">z1&lt;-<span class="fl">0.8</span><span class="op">*</span>x1<span class="fl">+1.5</span><span class="op">*</span>y1<span class="op">+</span>err1</a></code></pre></div>
<p>Plot the graph. Setting type to “h” gives us drop lines from each data point.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">scatterplot3d</span>(x1, y1, z1, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph28"></span>
<img src="3rd_Edition_files/figure-html/graph28-1.png" alt="3D scatterplot example" width="672" />
<p class="caption">
Figure 9.36: 3D scatterplot example
</p>
</div>
</div>
<div id="contour-plot" class="section level3">
<h3><span class="header-section-number">9.14.4</span> Contour plot</h3>
<p>The earwig <em>Forficula auricularia</em> is known to occur in two male morphs, a “brachylabic” morph with small forceps and a “macrolabic” morph with large forceps which is thought to pursue a more aggressive strategy for competing with rival males and acquiring mates (see Tomkins and Brown 2004, Nature 431 1099-1103 for more details). The graph below is a scatterplot of forceps length (on the y-axis) against pronotum width (a measure of overall body size) on the x-axis for an earwig population on Brownsman Island in the Farne Islands archipelago, the data being kindly supplied to me by Joe Tomkins. We can see some form of structure in this scatterplot, but it might help our visualisation of what’s going on if we drew a contour plot showing where the densest groups of points are.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">plot</span>(earwig<span class="op">$</span>pron, earwig<span class="op">$</span>fcp)</a></code></pre></div>
<div class="figure"><span id="fig:graph29"></span>
<img src="3rd_Edition_files/figure-html/graph29-1.png" alt="Scatterplot of forceps length versus pronotum width for the earwig Forficula airicularia" width="672" />
<p class="caption">
Figure 9.37: Scatterplot of forceps length versus pronotum width for the earwig Forficula airicularia
</p>
</div>
<p>To estimate the density of this 2D dataset we can use the <code>kde2d()</code> function from the MASS package, which fits a 2D kernel density estimator to the data.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb84-2" title="2">earwig.density&lt;-<span class="kw">kde2d</span>(earwig<span class="op">$</span>pron, earwig<span class="op">$</span>fcp, <span class="dt">n=</span><span class="dv">200</span>)</a></code></pre></div>
<p>Note that I haven’t attached the “earwig” data frame in this case, so I have to indicate the variables for analysis using <code>dataframe$variable</code>. Having calculated the density estimator we can then draw a contour plot using the <code>contour()</code> function.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">contour</span>(earwig.density, <span class="dt">xlab=</span><span class="st">&quot;Pronotum width (mm)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Forceps length (mm)&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:graph30"></span>
<img src="3rd_Edition_files/figure-html/graph30-1.png" alt="Contour plot of earwig forceps length versus pronotum width" width="672" />
<p class="caption">
Figure 9.38: Contour plot of earwig forceps length versus pronotum width
</p>
</div>
<p>We can overlay the data points onto the plot using <code>points()</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">points</span>(earwig<span class="op">$</span>pron, earwig<span class="op">$</span>fcp, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.6</span>)</a></code></pre></div>
<div class="figure">
<img src="3rd_Edition_files/figure-html/graph%2031-1.png" alt="Contour plot of earwig forceps length versus pronotum width with individual data points added." width="672" />
<p class="caption">
(#fig:graph 31)Contour plot of earwig forceps length versus pronotum width with individual data points added.
</p>
</div>
<p>I’m not sure if this graph really helps us understand the allometry of forceps length in male earwigs on Brownsman Island, but at least it looks nice.</p>
<hr />
</div>
</div>
<div id="exporting-graphics" class="section level2">
<h2><span class="header-section-number">9.15</span> Exporting Graphics</h2>
<p>There are lots of different image formats, and R runs on a number of different platforms that use different graphics formats in different ways. It shouldn’t surprise you then to find out that there are lots of different options for exporting your graphics from R. If you’re using Windows or a Mac then there is an easy way that doesn’t give you much control, or there is a hard way that gives you more control. In Linux there’s only the hard way.</p>
<div id="the-easy-way" class="section level3">
<h3><span class="header-section-number">9.15.1</span> The easy way</h3>
<p>If you’re using either Windows or a Mac, then draw your graph and select the window that it’s drawn in. You can then use the “Save as” option from the “File” pull-down menu to save your graph. If you’re exporting a graph in Windows, you get a variety of choices of format, the best one of which may be a .wmf (Windows meta-file). This is a vector graphics format so you can import it to another package and do things like resizing it without any trouble. On a Mac running OS X, R automatically exports graphs as pdfs. This is what it should do: pdf is the default graphics filetype in OS X, and gives nice crisp vector graphics again. The only problem is that if you’re using MS Word it may well not import your pdfs nicely - the results vary by version but in general it makes them into pixellated bitmaps. If you’re using a Mac and want to import your graphs to Word, you might have to do something like open them in Photoshop and save them as a high-res GIF or similar. Recent releases of Word are better at coping with pdfs but still not perfect.</p>
</div>
<div id="the-hard-way" class="section level3">
<h3><span class="header-section-number">9.15.2</span> The hard way</h3>
<p>Using the pull-down menus as described above is easy but you don’t have much control over things like the size of the saved image. The other option for saving graphs, using the command line (surprise!) gives you a lot more control over these details. If you want to export to one of the common graphic formats you can use one of these functions:
-<code>png()</code>
-<code>jpeg()</code>
-<code>tiff()</code>
-<code>bmp()</code>
-<code>pdf()</code></p>
<p>The first four of these all work in very similar ways. <code>pdf()</code> is a bit more complex but works in basically the same way. To save a graphic with all of these functions it’s a good idea to start by having your graph drawn nicely to your satisfaction and the code saved and accessible: either in the script editor or in a text editor somewhere. What you do might seem a bit strange if you’re not used to it but there is some internal logic to the process, somewhere.</p>
<p>First, you use the command you’ve chosen to specify the filename to save the graph to. If you’ve decided to save to a .png, for example, you might type</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">png</span>(<span class="dt">filename=</span>“Figure1.png”)</a></code></pre></div>
<p>If you’ve got it right then all you’ll get when you hit return is the command prompt again. What you do now is paste in your code for drawing your figure. You can use as many lines of code as you need. Press enter again. If all is still well, you’ll just get a command prompt again.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">plot</span>(xvariable, yvariable, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">xlab=</span>“X axis”, <span class="dt">ylab=</span>“Y axis”)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">abline</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p>Now you type the function <code>dev.off()</code>, which might cause some cryptic messages to appear</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">dev.off</span>()</a>
<a class="sourceLine" id="cb89-2" title="2">quartz</a>
<a class="sourceLine" id="cb89-3" title="3">    <span class="dv">2</span></a></code></pre></div>
<p>That’s it. If all is well you can now look in your working directory (or another directory if you specified a file path rather than just a name) and you should find your graphics file there. What’s going on? Why don’t you see your graph, and what do these strange functions do? To understand this process you need to know that R draws graphs in things it calls “devices”. There is an active, current device and any graphics functions called will draw what they’re told to draw in that device. Normally this will be a window, and the graphics code you use will draw things in the window where you can see it, but when you use a function like <code>png()</code> you tell R to open a new device, which is effectively the graphics file that you’re writing to. When you put in your graphics code after opening a new device that isn’t a graph window, you don’t see the new graph because it’s not being written to the window. Then, when you type <code>dev.off()</code> that closes whichever device is the active device and in the case of your graphics file write the file to the appropriate directory. See? I said there was some logic. If that doesn’t make any sense to you then don’t worry.
Why should you go through the trouble and confusion of saving your graphics in this apparently baroque and perverse fashion? Because it gives you a huge amount of control over the final graphics file. You can add arguments to functions like <code>png()</code> that will determine precisely the size of the image, the size of the text, the colour of the background and even whether there’s a background at all. Let’s say that you want a graph with dimensions 560 by 340 pixels with 24 point text as the default (which can be altered by the <code>cex…</code> arguments in <code>plot()</code> etc). Let’s also go for a transparent background so that you can use your graph in your latest powerpoint presentation with some bad-taste background image showing through in the hope of distracting your audience from noticing how dodgy your correlation is.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">png</span>(<span class="dt">filename=</span>“Figure1.png”, <span class="dt">width=</span><span class="dv">560</span>, <span class="dt">height=</span><span class="dv">340</span>, <span class="dt">bg=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">pointsize=</span><span class="dv">24</span>)</a></code></pre></div>
<p>Will ensure that figure 1 comes out exactly how you want it.</p>
<hr />
</div>
</div>
<div id="going-further-with-your-graphs" class="section level2">
<h2><span class="header-section-number">9.16</span> Going Further with your Graphs</h2>
<p>So far all of the graphs we’ve drawn have used the base graphics system, or a package that just tweaks the base graphics a little bit. This is only a smidgen of the available graphics functionality in R - in addition to packages that add functions to the base graphics system there are several that offer complete alternative graphics systems which make it easy to produce different kinds of graphs or graphs with very different aesthetic qualities. Two of these that are worth mentioning here are the ggplot2 package and the lattice package.</p>
<div id="ggplot2" class="section level3">
<h3><span class="header-section-number">9.16.1</span> ggplot2</h3>
<p><code>ggplot2</code> is authored by Hadley Wickham and is based on the philosophy and scheme for visualising data explained by Leland Wilkinson in the book The Grammar of Graphics^4. It allows some very attractive graphs to be drawn easily, with much less code than for the base R graphics installation in some cases, and it allows some very complex multi-layer and multi-panel graphs to be drawn with relative ease. Here are a couple of examples of graphs drawn with ggplot2.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>Installs and loads ggplot2 into the R workspace.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">qplot</span>(Year, MDR, <span class="dt">geom=</span><span class="kw">c</span>(<span class="st">&quot;smooth&quot;</span>, <span class="st">&quot;point&quot;</span>), <span class="dt">na.rm=</span>T)<span class="op">+</span><span class="kw">theme_bw</span>()</a></code></pre></div>
<div class="figure"><span id="fig:graph32"></span>
<img src="3rd_Edition_files/figure-html/graph32-1.png" alt="Scatterplot of percentage TB cases in the UK reported to be multi-drug resistant with loess smoother and confidence intervals." width="672" />
<p class="caption">
Figure 9.39: Scatterplot of percentage TB cases in the UK reported to be multi-drug resistant with loess smoother and confidence intervals.
</p>
</div>
<p>Here we’ve used the <code>qplot()</code>, which stands for “quick plot” function to produce a scatter plot of some data on multi-drug resistant TB in the UK by year: we’ll use these data later on in the chapter on linear regression and TB trends. I’ve asked <code>qplot()</code> to draw the graph with the “<code>bw</code>” theme (black and white) which I think looks a lot nicer than the default ggplot2 grey theme which you can see in the next plot, and I’ve also asked it to draw the graph with a non-parametric smoother added. For those who haven’t met these, non-parametric smoothers use a statistical technique whereby a smooth line is drawn through local regions where the density of points is greatest - in other words they are a method of putting a smoothed line through the data which shows you what the form of the relationship between Y and X is without making any assumptions about it. ggplot2 automatically selected a technique for calculating our smoothed line (in this case the method called “loess”) and also drew in the 95% confidence intervals for the smoothed line. You can also see that there are several default aspects of the graph that differ from one produced using <code>plot()</code>: there is a background with faint gridlines and there are fewer tick-marks and numbers along the axis than we’d expect with <code>plot()</code>. All in all this is a nice looking graph and you’d probably be happy to include it in a presentation without making any changes.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">qplot</span>(Body, Brain, <span class="dt">log=</span><span class="st">&quot;xy&quot;</span>, <span class="dt">size=</span><span class="fl">1.5</span>, <span class="dt">pch=</span>Family, <span class="dt">col=</span>Family)</a></code></pre></div>
<div class="figure"><span id="fig:graph33"></span>
<img src="3rd_Edition_files/figure-html/graph33-1.png" alt="Scatterplot of brain weight versus body weight for 22 species of whales from 6 families plotted on a log-log scale." width="768" />
<p class="caption">
Figure 9.40: Scatterplot of brain weight versus body weight for 22 species of whales from 6 families plotted on a log-log scale.
</p>
</div>
<p>This graph shows some of the data that are analysed in the “Whale brains and dive duration” example in the chapter on model fitting. I haven’t specified the theme this time so we’ve got the default grey background - this looks nice when there’s a lot of colour elsewhere on the graph but can be a bit miserable when all the plotting is in black and white, as is the case here. I’ve managed to produce a scatterplot with both axes log-transformed and with different plot symbols for each family using only one line (and a short line at that) of code. ggplot2 has even put in a rather elegant legend without being asked which is pretty nice. One thing to notice is that ggplot2 has used a log10 scale rather than a loge scale, and one consequence of that is that there is something of a lack of tick-marks and numbers on the y-axis, so you might want to try to fix that before using the graph in public, and you might want to add some units to the axis labels, but those things aside this is once again a nice-looking and informative graph.</p>
<p>As a final example, here’s a plot of a fitted density estimate for each of three random normally distributed datasets. I’ve included this because it shows off ggplot2’s rather nice colour schemes and capability for transparent overlays. The function used here to plot the graph is <code>ggplot()</code> rather than <code>qplot()</code> which is a bit harder to use but which gives full control over all aspects of your graph.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">Z1&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">length =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dv">7</span>, <span class="fl">2.5</span>))    <span class="co">##Generate 3 random variables with normal distributions as data frames</span></a>
<a class="sourceLine" id="cb94-2" title="2">Z2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">length =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dv">8</span>, <span class="fl">2.5</span>))</a>
<a class="sourceLine" id="cb94-3" title="3">Z3&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">length =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="fl">8.5</span>, <span class="fl">2.5</span>))</a>
<a class="sourceLine" id="cb94-4" title="4"></a>
<a class="sourceLine" id="cb94-5" title="5">Z1<span class="op">$</span>Fact&lt;-<span class="st">&quot;A&quot;</span>        <span class="co">##Add a second factor name to each data frame</span></a>
<a class="sourceLine" id="cb94-6" title="6">Z2<span class="op">$</span>Fact&lt;-<span class="st">&quot;B&quot;</span></a>
<a class="sourceLine" id="cb94-7" title="7">Z3<span class="op">$</span>Fact&lt;-<span class="st">&quot;C&quot;</span></a>
<a class="sourceLine" id="cb94-8" title="8"></a>
<a class="sourceLine" id="cb94-9" title="9">Trans.example&lt;-<span class="kw">rbind</span>(Z1,Z2,Z3)      <span class="co">###Stack the data frames into 1</span></a>
<a class="sourceLine" id="cb94-10" title="10"></a>
<a class="sourceLine" id="cb94-11" title="11"><span class="kw">ggplot</span>(Trans.example, <span class="kw">aes</span>(length, <span class="dt">fill =</span> Fact)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Density&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Measure&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()          <span class="co">##Draw plot of density for each variable</span></a></code></pre></div>
<div class="figure"><span id="fig:graph34"></span>
<img src="3rd_Edition_files/figure-html/graph34-1.png" alt="ggplot2 example showing off the pretty colours and easy transparency settings" width="672" />
<p class="caption">
Figure 9.41: ggplot2 example showing off the pretty colours and easy transparency settings
</p>
</div>
<p>￼
That’s all I’m going to say about <code>ggplot2</code>, but if you want to know more then <a href="http://ggplot2.org" class="uri">http://ggplot2.org</a> has links to useful documentation, and there are two books available that deal with the package in detail. These are firstly Hadley Wickham’s own book^5, and secondly Winston Chang’s R Graphics Cookbook^6.</p>
</div>
<div id="lattice" class="section level3">
<h3><span class="header-section-number">9.16.2</span> lattice</h3>
<p>The <code>lattice</code> package is based on a system of visualising data called ‘Trellis graphics” that was developed by Becker and Cleveland in the 1990s. You can find out more about Trellis graphics at <a href="http://cm.bell-labs.com/cm/ms/departments/sia/project/trellis/" class="uri">http://cm.bell-labs.com/cm/ms/departments/sia/project/trellis/</a>, or from Bill Cleveland’s book Visualizing Data (1993, Hobart Press, ISBN 978-0963488404). The R package itself was written by Deepayan Sarkar (<a href="http://dsarkar.fhcrc.org" class="uri">http://dsarkar.fhcrc.org</a>), and is especially useful for visualising large and complex sets of data. You can use lattice to draw scatterplots and histograms in a similar way to the base graphics installation, but it comes into its own for dealing with variables that are themselves dependent on levels of other variables - what are known as conditioning variables in this context. To give a simple example let’s go back to the example from the haemocyte dataset that we looked at earlier in the chapter. To show the relationship between weight and haemocyte count for the two species we had to draw the data for the different species separately onto a plot using the <code>points()</code> function. In lattice we can draw two separate plots with a very simple command:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">xyplot</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count)<span class="op">~</span>Weight<span class="op">|</span>Haemocyte<span class="op">$</span>Species)</a></code></pre></div>
<div class="figure"><span id="fig:graph35"></span>
<img src="3rd_Edition_files/figure-html/graph35-1.png" alt="Haemocyte count versus body weight for two species of Lepidoptera." width="672" />
<p class="caption">
Figure 9.42: Haemocyte count versus body weight for two species of Lepidoptera.
</p>
</div>
<p>Notice the use of the “pipe” symbol (the vertical line) in the formula. This is used to indicate the conditioning variable, which is “Species” in this case. We can also plot these data easily in a single set of axes by using the <code>groups=</code> argument.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">xyplot</span>(<span class="kw">log</span>(Haemocyte<span class="op">$</span>Count)<span class="op">~</span>Weight, <span class="dt">group=</span>Haemocyte<span class="op">$</span>Species, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">16</span>), <span class="dt">xlab=</span><span class="st">&quot;Weight (g)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Log Haemocyte count&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="3rd_Edition_files/figure-html/graph36%E2%81%84-1.png" alt="Haemocyte count versus body weight for two species of Lepidoptera. Red filled circles are Pieris napi, blue filled triangles are P. brassicae." width="672" />
<p class="caption">
(#fig:graph36⁄)Haemocyte count versus body weight for two species of Lepidoptera. Red filled circles are Pieris napi, blue filled triangles are P. brassicae.
</p>
</div>
<p>￼</p>
<p>Thus with a single line of code we’ve produced a graph that is essentially identical to the one we drew in the “Scatterplots” section earlier in the chapter by using rather more instructions. I’ve specified the plot colours and symbols to make the figure as similar as possible, but even if we left these out <code>xyplot()</code> would have plotted the two species using different colours for us.</p>
</div>
</div>
<div id="exercises-3" class="section level2">
<h2><span class="header-section-number">9.17</span> Exercises</h2>
<p>Using the dataset for the Hawaii Ironman triathlon results (IMH2012.txt):</p>
<ul>
<li><p>Load the dataset into R</p></li>
<li><p>Draw a scatterplot showing overall time on the y-axis and bike split on the x-axis</p></li>
<li><p>Draw the same scatterplot as before but make the plot symbols half the default size</p></li>
<li><p>Draw the same scatterplot as before but put in proper x- and y- axis labels and a nice graph title.</p></li>
<li><p>Draw the same scatterplot as before but choose a different plot symbol and a nice colour. Try several out and see what works and what doesn’t: you can see the plot symbols in figure 2 above and the full range of available colours is given in Appendix 1.</p></li>
<li><p>Draw the same scatterplot but only with the data for the 25-29 and the 55-59 age categories. Plot the two categories with different plot symbols and different colours.</p></li>
<li><p>Draw the same scatterplot as above but put in a legend to tell the viewer what the symbols mean. NB I always have to read the help file for legend(), don’t worry if this takes you a few goes to get right.</p></li>
<li><p>Draw the same scatterplot but only with the data for the 30-34 age category. This time show male and female competitors using different colours and plot symbols.</p></li>
<li><p>On the last scatterplot, use abline() to plot fitted lines showing the relationship between the X and Y variables for the two genders. Use different line styles and plot the lines in the same colour as the plot symbols for each gender. Since we haven’t got onto line fitting yet (Chapter 11) you need to know the intercepts and slopes for both lines. They are female: intercept -0.587 slope 2.000 and male: intercept -0.902 and slope 2.077.</p></li>
<li><p>Draw a boxplot showing overall times for male competitors divided by age category</p></li>
<li><p>Use par(mfrow=…) to draw two boxplots of overall time divided by age category next to each other with females on the left and males on the right.</p></li>
<li><p>Draw two boxplots as above but use two different colours to fill the boxes on the boxplots. Give them proper axis labels and titles. Use ?par to look up the help page for graphical parameters and use the parameter las to rotate the text on the x-axis to vertical. Use cex.axis to shrink the text on the axes a little so that it doesn’t interfere with the axis label on the x-axis.</p></li>
</ul>
</div>
<div id="footnotes" class="section level2">
<h2><span class="header-section-number">9.18</span> Footnotes</h2>
<ol style="list-style-type: decimal">
<li><p>Pomfret JC, Knell RJ. 2006. Sexual selection and horn allometry in the dung beetle <em>Euoniticellus intermedius</em>. Animal Behaviour 71:567–576.</p></li>
<li><p>Moczek A, Emlen DJ. 2000. Male horn dimorphism in the scarab beetle, Onthophagus taurus: do alternative reproductive tactics favour alternative phenotypes? (vol 59, pg 459, 2000). Animal Behaviour 59:459–466.</p></li>
<li><p>Moczek A, Nijhout H. 2004. Trade-offs during the development of primary and secondary sexual traits in a horned beetle. The American Naturalist 163:184–191.</p></li>
<li><p>Wilkinson, W. (2005) The Grammar of Graphics, 2nd ed., Springer. ISBN 978-0387245447</p></li>
<li><p>Wickham, H. (2009) ggplot2: Elegant Graphics for Data Analysis, Springer, ISBN 978-0387981406</p></li>
<li><p>Chang, W. (2013) R Graphics Cookbook, O’Reilly, ISBN 978-1449316952</p></li>
</ol>
</div>
<div id="drawing-the-set-of-plot-points" class="section level2">
<h2><span class="header-section-number">9.19</span> Drawing the set of plot points</h2>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">\<span class="co"># Set up variables</span></a>
<a class="sourceLine" id="cb97-2" title="2">X1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb97-3" title="3">Y1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb97-4" title="4">sym &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">25</span></a>
<a class="sourceLine" id="cb97-5" title="5"></a>
<a class="sourceLine" id="cb97-6" title="6">\<span class="co"># Plot the graph</span></a>
<a class="sourceLine" id="cb97-7" title="7"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb97-8" title="8">  X1,</a>
<a class="sourceLine" id="cb97-9" title="9">  Y1,</a>
<a class="sourceLine" id="cb97-10" title="10">  <span class="dt">pch =</span> sym,</a>
<a class="sourceLine" id="cb97-11" title="11">  <span class="dt">cex =</span> <span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb97-12" title="12">  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb97-13" title="13">  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb97-14" title="14">  <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb97-15" title="15">  <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb97-16" title="16">  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">5.7</span>),</a>
<a class="sourceLine" id="cb97-17" title="17">  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">5.7</span>)</a>
<a class="sourceLine" id="cb97-18" title="18">)</a>
<a class="sourceLine" id="cb97-19" title="19"></a>
<a class="sourceLine" id="cb97-20" title="20">\<span class="co"># Add text</span></a>
<a class="sourceLine" id="cb97-21" title="21"><span class="kw">text</span>(<span class="dt">x =</span> X1 <span class="op">-</span><span class="st"> </span><span class="fl">0.3</span>, <span class="dt">y =</span> Y1, <span class="dt">labels =</span> sym)</a></code></pre></div>
<p>This snippet of code is worth taking a look at because it illustrates some important points (geddit?) about drawing graphs in R.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">X1&lt;-<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb98-2" title="2">Y1&lt;-<span class="kw">rep</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb98-3" title="3">sym&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">25</span></a></code></pre></div>
<p>This sets up two vectors, one for the x-coordinates and one for the y-coordinates which will specify the location of 25 points in a grid, and then a third vector, <em>sym</em>, which is the numbers 1 to 25. We’ll use this both to specify the points to be drawn at each location and for the text labels for the points.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb99-2" title="2">  X1,</a>
<a class="sourceLine" id="cb99-3" title="3">  Y1,</a>
<a class="sourceLine" id="cb99-4" title="4">  <span class="dt">pch =</span> sym,</a>
<a class="sourceLine" id="cb99-5" title="5">  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb99-6" title="6">  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb99-7" title="7">  <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb99-8" title="8">  <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb99-9" title="9">  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>),</a>
<a class="sourceLine" id="cb99-10" title="10">  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb99-11" title="11">)</a></code></pre></div>
<p>This draws the graph. The <em>xlab</em>, <em>xaxt</em> and the corresponding <em>y</em> graphical parameters turn off the axis labels and the ticks and axis numbering. The really important point here is that we can specify a vector of numbers (<em>sym</em>) for the <em>pch</em> graphical parameter and R will read these in order and draw the corresponding plot symbol. In this case our vector is length 25 and we’re drawing 25 points, so there’s a 1:1 correspondence. If the vector were shorter R would recycle it as many times as necessary to give a plot symbol for each point on the graph, and if it were longer R would draw the first 25 symbols and then go back and overplot until it ran out of numbers in the <em>sym</em> vector. Try using this code to draw your own graph but set <em>sym</em> as 1:5, 1:10 and 1:30 to see how the plot changes. Finally, the <em>cex</em> parameter makes R draw the symbols 1.2 times the default size, just to make it a little clearer.</p>
<p>R can also plot any text symbol you might want to use, you just have to give it the symbol in quote marks, so <em>pch=“A”</em> will plot your data points as capital “A” and <em>pch=“€”</em> will plot them as Euro symbols.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">text</span>(<span class="dt">x=</span>X1<span class="fl">-0.2</span>,<span class="dt">y=</span>Y1,<span class="dt">labels=</span>sym)</a></code></pre></div>
<p>The last thing we want to do is to write in the numbers corresponding to our plot symbols, and we do that with the <code>text()</code> function. This takes as arguments the x-coordinate or coordinate either as a as a single number or a vector, the y-coordinate or coordinates and then argument called <em>labels</em> which tells it what text to write. Once again we can just feed it a vector of numbers as the <em>labels</em> argument and it cycles through them. One thing to remember about <code>text()</code> is that the default option is to write the text centred around the coordinates given in the first two arguments, but you can change this with the <em>pos=</em> argument, which takes a value of 1,2,3 or 4 which will cause the text to be written below, to the left of, above or to the right of the coordinates given respectively.</p>
</div>
<div id="taking-it-further-trimming-the-x-axis-and-adding-a-smoother" class="section level2">
<h2><span class="header-section-number">9.20</span> Taking it further: trimming the x-axis and adding a smoother</h2>
<p>Finally, let’s go a little further with our graph. Let’s say we’re really interested in the period 1980 to present, and that we want to display these data with a fitted trendline. We’re going to use a <em>non-parametric smoother</em> called a <em>loess</em> smoother to draw a line through our data, so the first thing to do is to calculate the fitted values from our Loess smoother. Note that I’ve set the argument <code>se = TRUE</code> which means we’re also going to generate standard errors for our predicted values. We could use these values to draw in 95% confidence intervals for our line, but for the sake of simplicity we won’t do that for the present.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="co"># X1 &lt;- length(UFO$Count):1</span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="co"># Y1 &lt;- predict(loess(UFO$Count~X1, span = 0.2), se = TRUE)</span></a></code></pre></div>
<p>We’re generating a dummy variable for our x-variable here because loess doesn’t play nicely with the date formatted data which we have. <code>UFO$Reports</code>. <code>X1 &lt;- length(UFO$Count) : 1</code> simply generates a vector counting down from 907 (the total number of counts in our data set) to 1.</p>
<p>Now we want to plot a subset of our data and draw the fitted loess smoother through it. To generate a plot using only the data after 1980 we’re going to use another parameter called <code>xlim</code> which tells R the limits of the plot on the x-axis. For <code>xlim</code> we just give it a vector with two values, the lowest and the highest which we want on our x axis. In this case it’s slightly moere complicated by the fact that our x-axis data are in Date format, so we have to tell R to expect date values. If you want to adjust the y-axis there is a corresponding parameter called <code>ylim</code>.</p>
<p>Finally for the basic plot, I’ve changed the plot method to the default by taking out the <code>type = "l"</code> parameter so we will have each data point plotted without a line, I’ve specified the plot symbol to be a closed circle (<code>pch = 16</code>) and I’ve asked R to plot these half the size it normally would (<code>cex = 0.5</code>).</p>
<p>OK, now let’s add the line. The important point here is that there are a set of functions in R that we can use to draw extra things onto an existing plot. These include <code>points()</code> which draws new data points, <code>lines()</code> which we’re using here to draw a line, <code>legend()</code> which you can use to add a legend and <code>text()</code> which will add text. We’ll talk about these in more detail later, but here is an example of using <code>lines()</code>. Our Y-variable here is <code>Y1$fit</code> which has the predicted values we calculated for our loess smoother, and we’re specifying the colour of the line as <code>cadetblue4</code> and setting the line width to be twice its default width with <code>lwd = 2</code>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="co"># plot(UFO$Count ~ UFO$Reports,</span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="co">#      pch = 16,</span></a>
<a class="sourceLine" id="cb102-3" title="3"><span class="co">#      cex = 0.5,</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="co">#      xlim = as.Date(c(&quot;1980-01-01&quot;, &quot;2019-03-01&quot;)),</span></a>
<a class="sourceLine" id="cb102-5" title="5"><span class="co">#      col = &quot;steelblue&quot;,</span></a>
<a class="sourceLine" id="cb102-6" title="6"><span class="co">#      xlab = &quot;Year&quot;,</span></a>
<a class="sourceLine" id="cb102-7" title="7"><span class="co">#      ylab = &quot;Number of UFO reports by month&quot;,</span></a>
<a class="sourceLine" id="cb102-8" title="8"><span class="co">#      main  = &quot;UFO reports by month since 1980&quot;)</span></a>
<a class="sourceLine" id="cb102-9" title="9"><span class="co"># </span></a>
<a class="sourceLine" id="cb102-10" title="10"><span class="co"># lines(Y1$fit~UFO$Reports,</span></a>
<a class="sourceLine" id="cb102-11" title="11"><span class="co">#       col = &quot;cadetblue4&quot;,</span></a>
<a class="sourceLine" id="cb102-12" title="12"><span class="co">#       lwd = 2)</span></a></code></pre></div>

</div>
</div>






<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Fitzpatrick, J.L., Almbro, M., Gonzalez-Voyer, A., Hamada, S., Pennington, C., Scanlan, J. &amp; Kolm, N. (2012) Sexual selection uncouples the evolution of brain and body size in pinnipeds. Journal of evolutionary biology, 25, 1321–1330.<a href="r-graphics-i-the-base-graphics-system.html#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="importing-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["3rd_Edition.pdf", "3rd_Edition.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
