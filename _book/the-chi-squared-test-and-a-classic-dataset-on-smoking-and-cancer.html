<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 The Chi-squared Test and a Classic Dataset on Smoking and Cancer | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</title>
  <meta name="description" content="null" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 The Chi-squared Test and a Classic Dataset on Smoking and Cancer | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="null" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 The Chi-squared Test and a Classic Dataset on Smoking and Cancer | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  
  <meta name="twitter:description" content="null" />
  

<meta name="author" content="Rob Knell" />


<meta name="date" content="2020-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="what-is-statistical-testing.html"/>
<link rel="next" href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introductory R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i><b>1.1</b> Why this book?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.2</b> How to use this book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-first-r-session.html"><a href="a-first-r-session.html"><i class="fa fa-check"></i><b>2</b> A first R session</a><ul>
<li class="chapter" data-level="2.1" data-path="a-first-r-session.html"><a href="a-first-r-session.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="a-first-r-session.html"><a href="a-first-r-session.html#a-first-r-session-1"><i class="fa fa-check"></i><b>2.2</b> A first R session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html"><i class="fa fa-check"></i><b>3</b> Basics: arithmetic, objects and functions</a><ul>
<li class="chapter" data-level="3.0.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#arithmetic"><i class="fa fa-check"></i><b>3.0.1</b> Arithmetic</a></li>
<li class="chapter" data-level="3.0.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#logical-operations"><i class="fa fa-check"></i><b>3.0.2</b> Logical operations</a></li>
<li class="chapter" data-level="3.0.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects"><i class="fa fa-check"></i><b>3.0.3</b> Objects</a></li>
<li class="chapter" data-level="3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#kinds-of-data"><i class="fa fa-check"></i><b>3.1</b> Kinds of data</a></li>
<li class="chapter" data-level="3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#whats-in-my-workspace"><i class="fa fa-check"></i><b>3.2</b> What’s in my workspace?</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations"><i class="fa fa-check"></i><b>3.3.1</b> Calculations</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-1"><i class="fa fa-check"></i><b>3.3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-1"><i class="fa fa-check"></i><b>3.3.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#answers-to-exercises"><i class="fa fa-check"></i><b>3.4</b> Answers to exercises</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations-1"><i class="fa fa-check"></i><b>3.4.1</b> Calculations</a></li>
<li class="chapter" data-level="3.4.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-2"><i class="fa fa-check"></i><b>3.4.2</b> Objects</a></li>
<li class="chapter" data-level="3.4.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-2"><i class="fa fa-check"></i><b>3.4.3</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html"><i class="fa fa-check"></i><b>4</b> Data: Vectors, Matrices and Data Frames</a><ul>
<li class="chapter" data-level="4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices"><i class="fa fa-check"></i><b>4.2</b> Matrices</a></li>
<li class="chapter" data-level="4.3" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#factors-and-data-frames"><i class="fa fa-check"></i><b>4.3</b> Factors and Data frames</a></li>
<li class="chapter" data-level="4.4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-1"><i class="fa fa-check"></i><b>4.4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-1"><i class="fa fa-check"></i><b>4.4.2</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#answers-to-exercises-1"><i class="fa fa-check"></i><b>4.5</b> Answers to exercises</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-2"><i class="fa fa-check"></i><b>4.5.1</b> Vectors</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-2"><i class="fa fa-check"></i><b>4.5.2</b> Matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html"><i class="fa fa-check"></i><b>5</b> Choosing data: subscripts and subsetting</a><ul>
<li class="chapter" data-level="5.0.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts"><i class="fa fa-check"></i><b>5.0.1</b> Subscripts</a></li>
<li class="chapter" data-level="5.0.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#boolean-logic-and-more-complex-subscripting"><i class="fa fa-check"></i><b>5.0.2</b> Boolean logic and more complex subscripting</a></li>
<li class="chapter" data-level="5.0.3" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-in-matrices-and-data-frames"><i class="fa fa-check"></i><b>5.0.3</b> Subscripts in matrices and data frames</a></li>
<li class="chapter" data-level="5.0.4" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subset"><i class="fa fa-check"></i><b>5.0.4</b> Subset</a></li>
<li class="chapter" data-level="5.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#exercises-2"><i class="fa fa-check"></i><b>5.1</b> Exercises</a><ul>
<li class="chapter" data-level="5.1.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors"><i class="fa fa-check"></i><b>5.1.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.1.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices"><i class="fa fa-check"></i><b>5.1.2</b> Subscripts and matrices</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#answers-to-exercises-2"><i class="fa fa-check"></i><b>5.2</b> Answers to exercises</a><ul>
<li class="chapter" data-level="5.2.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors-1"><i class="fa fa-check"></i><b>5.2.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.2.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices-1"><i class="fa fa-check"></i><b>5.2.2</b> Subscripts and matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html"><i class="fa fa-check"></i><b>6</b> R scripts and your R workflow</a><ul>
<li class="chapter" data-level="6.1" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#writing-and-using-r-scripts"><i class="fa fa-check"></i><b>6.1</b> Writing and using R scripts</a></li>
<li class="chapter" data-level="6.2" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-an-r-script-window"><i class="fa fa-check"></i><b>6.2</b> Running code from an R script window</a></li>
<li class="chapter" data-level="6.3" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-files-using-source"><i class="fa fa-check"></i><b>6.3</b> Running code from files using <code>source()</code></a></li>
<li class="chapter" data-level="6.4" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#workflow-structure-or-what-should-i-put-in-my-script"><i class="fa fa-check"></i><b>6.4</b> Workflow structure, or what should I put in my script?</a></li>
<li class="chapter" data-level="6.5" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#keep-it-neat-making-your-script-easy-to-read"><i class="fa fa-check"></i><b>6.5</b> Keep it neat — making your script easy to read</a></li>
<li class="chapter" data-level="6.6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#i-wish-i-hadnt-commented-my-code-so-much-said-no-one-ever-4."><i class="fa fa-check"></i><b>6.6</b> “I wish I hadn’t commented my code so much”, said no-one, ever.</a></li>
<li class="chapter" data-level="6.7" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#using-rstudio-to-write-scripts"><i class="fa fa-check"></i><b>6.7</b> Using RStudio to write scripts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html"><i class="fa fa-check"></i><b>7</b> Help files and packages</a><ul>
<li class="chapter" data-level="7.1" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html#using-the-help-files"><i class="fa fa-check"></i><b>7.1</b> Using the help files</a></li>
<li class="chapter" data-level="7.2" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html#packages"><i class="fa fa-check"></i><b>7.2</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>8</b> Importing Data</a><ul>
<li class="chapter" data-level="8.1" data-path="importing-data.html"><a href="importing-data.html#the-rules"><i class="fa fa-check"></i><b>8.1</b> The Rules</a></li>
<li class="chapter" data-level="8.2" data-path="importing-data.html"><a href="importing-data.html#importing-your-text-file"><i class="fa fa-check"></i><b>8.2</b> Importing your Text File</a><ul>
<li class="chapter" data-level="8.2.1" data-path="importing-data.html"><a href="importing-data.html#the-simple-way"><i class="fa fa-check"></i><b>8.2.1</b> The simple way</a></li>
<li class="chapter" data-level="8.2.2" data-path="importing-data.html"><a href="importing-data.html#the-less-simple-way"><i class="fa fa-check"></i><b>8.2.2</b> The less simple way</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="importing-data.html"><a href="importing-data.html#importing-character-data"><i class="fa fa-check"></i><b>8.3</b> Importing character data</a></li>
<li class="chapter" data-level="8.4" data-path="importing-data.html"><a href="importing-data.html#data-on-the-web"><i class="fa fa-check"></i><b>8.4</b> Data on the web</a></li>
<li class="chapter" data-level="8.5" data-path="importing-data.html"><a href="importing-data.html#using-read.table"><i class="fa fa-check"></i><b>8.5</b> Using <code>read.table()</code></a></li>
<li class="chapter" data-level="8.6" data-path="importing-data.html"><a href="importing-data.html#what-to-do-once-youve-managed-to-import-your-data."><i class="fa fa-check"></i><b>8.6</b> What to do once you’ve managed to import your data.</a></li>
<li class="chapter" data-level="8.7" data-path="importing-data.html"><a href="importing-data.html#importing-data-directly-from-excel"><i class="fa fa-check"></i><b>8.7</b> Importing data directly from Excel</a></li>
<li class="chapter" data-level="8.8" data-path="importing-data.html"><a href="importing-data.html#other-data-formats"><i class="fa fa-check"></i><b>8.8</b> Other data formats</a></li>
<li class="chapter" data-level="8.9" data-path="importing-data.html"><a href="importing-data.html#importing-data-into-rstudio"><i class="fa fa-check"></i><b>8.9</b> Importing data into RStudio</a></li>
<li class="chapter" data-level="8.10" data-path="importing-data.html"><a href="importing-data.html#to-attach-or-not-to-attach"><i class="fa fa-check"></i><b>8.10</b> To attach or not to attach?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><i class="fa fa-check"></i><b>9</b> R graphics I — drawing graphs and changing plot symbols and colours using the base graphics system</a><ul>
<li class="chapter" data-level="9.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#base-graphics-versus-ggplot2-versus-lattice-versus-whaaat"><i class="fa fa-check"></i><b>9.1</b> Base graphics versus ggplot2 versus lattice versus whaaat???</a></li>
<li class="chapter" data-level="9.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#base-graphics-example-ufo-reports-again"><i class="fa fa-check"></i><b>9.2</b> Base graphics example: UFO reports again</a></li>
<li class="chapter" data-level="9.3" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#scatterplots"><i class="fa fa-check"></i><b>9.3</b> Scatterplots</a></li>
<li class="chapter" data-level="9.4" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#plot-symbols"><i class="fa fa-check"></i><b>9.4</b> Plot symbols</a></li>
<li class="chapter" data-level="9.5" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#colours"><i class="fa fa-check"></i><b>9.5</b> Colours</a></li>
<li class="chapter" data-level="9.6" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#plotting-multiple-symbols-or-colours"><i class="fa fa-check"></i><b>9.6</b> Plotting multiple symbols or colours</a></li>
<li class="chapter" data-level="9.7" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#colour-palettes-in-r"><i class="fa fa-check"></i><b>9.7</b> Colour palettes in R</a></li>
<li class="chapter" data-level="9.8" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#using-transparency-in-your-graphs"><i class="fa fa-check"></i><b>9.8</b> Using transparency in your graphs</a></li>
<li class="chapter" data-level="9.9" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#histograms-and-multiple-plots-in-the-same-window"><i class="fa fa-check"></i><b>9.9</b> Histograms and multiple plots in the same window</a></li>
<li class="chapter" data-level="9.10" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#boxplots"><i class="fa fa-check"></i><b>9.10</b> Boxplots</a></li>
<li class="chapter" data-level="9.11" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#bar-charts"><i class="fa fa-check"></i><b>9.11</b> Bar charts</a><ul>
<li class="chapter" data-level="9.11.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#more-complex-barplots"><i class="fa fa-check"></i><b>9.11.1</b> More complex barplots</a></li>
</ul></li>
<li class="chapter" data-level="9.12" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#other-types-of-plot"><i class="fa fa-check"></i><b>9.12</b> Other types of plot</a><ul>
<li class="chapter" data-level="9.12.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#histogram-with-overlaid-probability-density-estimate"><i class="fa fa-check"></i><b>9.12.1</b> Histogram with overlaid probability density estimate</a></li>
<li class="chapter" data-level="9.12.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#pie-graph"><i class="fa fa-check"></i><b>9.12.2</b> Pie graph</a></li>
<li class="chapter" data-level="9.12.3" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#d-scatterplot"><i class="fa fa-check"></i><b>9.12.3</b> 3D scatterplot</a></li>
<li class="chapter" data-level="9.12.4" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#contour-plot"><i class="fa fa-check"></i><b>9.12.4</b> Contour plot</a></li>
</ul></li>
<li class="chapter" data-level="9.13" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#exporting-graphics"><i class="fa fa-check"></i><b>9.13</b> Exporting Graphics</a><ul>
<li class="chapter" data-level="9.13.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#the-easy-way"><i class="fa fa-check"></i><b>9.13.1</b> The easy way</a></li>
<li class="chapter" data-level="9.13.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#the-hard-way"><i class="fa fa-check"></i><b>9.13.2</b> The hard way</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html"><i class="fa fa-check"></i><b>10</b> R graphics II — Adding elements to an existing graph</a><ul>
<li class="chapter" data-level="10.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#simple-regression-lines"><i class="fa fa-check"></i><b>10.1</b> Simple regression lines</a></li>
<li class="chapter" data-level="10.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#multiple-regression-lines"><i class="fa fa-check"></i><b>10.2</b> Multiple regression lines</a></li>
<li class="chapter" data-level="10.3" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#legends"><i class="fa fa-check"></i><b>10.3</b> Legends</a></li>
<li class="chapter" data-level="10.4" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#curves"><i class="fa fa-check"></i><b>10.4</b> Curves</a><ul>
<li class="chapter" data-level="10.4.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-a-curve-using-curve"><i class="fa fa-check"></i><b>10.4.1</b> Adding a curve using <code>curve()</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-a-curve-using-lines-or-points."><i class="fa fa-check"></i><b>10.4.2</b> Adding a curve using <code>lines()</code> or <code>points()</code>.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#text-and-arrows"><i class="fa fa-check"></i><b>10.5</b> Text and arrows</a></li>
<li class="chapter" data-level="10.6" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#confidence-bands-for-fitted-lines"><i class="fa fa-check"></i><b>10.6</b> Confidence bands for fitted lines</a><ul>
<li class="chapter" data-level="10.6.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-confidence-bands-using-lines"><i class="fa fa-check"></i><b>10.6.1</b> Adding confidence bands using <code>lines()</code></a></li>
<li class="chapter" data-level="10.6.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-confidence-intervals-to-fitted-lines-using-polygon"><i class="fa fa-check"></i><b>10.6.2</b> Adding confidence intervals to fitted lines using <code>polygon()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#error-bars"><i class="fa fa-check"></i><b>10.7</b> Error bars</a><ul>
<li class="chapter" data-level="10.7.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-error-bars-using-arrows"><i class="fa fa-check"></i><b>10.7.1</b> Adding error bars using <code>arrows()</code></a></li>
<li class="chapter" data-level="10.7.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#plotting-means-and-error-bars-using-plotmeans"><i class="fa fa-check"></i><b>10.7.2</b> Plotting means and error bars using <code>plotmeans()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>11</b> Graphics with ggplot2</a><ul>
<li class="chapter" data-level="11.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#ggplot2-introduced"><i class="fa fa-check"></i><b>11.1</b> ggplot2 introduced</a></li>
<li class="chapter" data-level="11.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#scaling-axes-and-varying-colour-or-shapes-by-factor-levels"><i class="fa fa-check"></i><b>11.2</b> Scaling axes and varying colour or shapes by factor levels</a></li>
<li class="chapter" data-level="11.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>11.3</b> Facets</a></li>
<li class="chapter" data-level="11.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>11.4</b> Histograms</a></li>
<li class="chapter" data-level="11.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#boxplots-1"><i class="fa fa-check"></i><b>11.5</b> Boxplots</a></li>
<li class="chapter" data-level="11.6" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#final-word"><i class="fa fa-check"></i><b>11.6</b> Final word</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html"><i class="fa fa-check"></i><b>12</b> Basic Statistical Concepts</a><ul>
<li class="chapter" data-level="12.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#populations-and-samples"><i class="fa fa-check"></i><b>12.1</b> Populations and Samples</a></li>
<li class="chapter" data-level="12.2" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#descriptive-and-exploratory-statistics"><i class="fa fa-check"></i><b>12.2</b> Descriptive and exploratory statistics</a><ul>
<li class="chapter" data-level="12.2.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#maximum-and-minimum"><i class="fa fa-check"></i><b>12.2.1</b> Maximum and minimum</a></li>
<li class="chapter" data-level="12.2.2" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#frequency-distribution"><i class="fa fa-check"></i><b>12.2.2</b> Frequency distribution</a></li>
<li class="chapter" data-level="12.2.3" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#kinds-of-frequency-distribution"><i class="fa fa-check"></i><b>12.2.3</b> Kinds of frequency distribution</a></li>
<li class="chapter" data-level="12.2.4" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>12.2.4</b> Measures of central tendency</a></li>
<li class="chapter" data-level="12.2.5" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#measures-of-dispersion"><i class="fa fa-check"></i><b>12.2.5</b> Measures of dispersion</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#standard-errors-and-confidence-intervals"><i class="fa fa-check"></i><b>12.3</b> Standard errors and confidence intervals</a><ul>
<li class="chapter" data-level="12.3.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#code-used-to-draw-figure-6"><i class="fa fa-check"></i><b>12.3.1</b> Code used to draw figure 6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html"><i class="fa fa-check"></i><b>13</b> What is statistical testing?</a><ul>
<li class="chapter" data-level="13.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#the-problem"><i class="fa fa-check"></i><b>13.1</b> The problem</a></li>
<li class="chapter" data-level="13.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#statistical-testing-in-a-nutshell"><i class="fa fa-check"></i><b>13.2</b> Statistical testing in a nutshell</a><ul>
<li class="chapter" data-level="13.2.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#decide-on-the-null-and-alternative-hypotheses."><i class="fa fa-check"></i><b>13.2.1</b> Decide on the null and alternative hypotheses.</a></li>
<li class="chapter" data-level="13.2.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#calculate-the-size-of-the-effect."><i class="fa fa-check"></i><b>13.2.2</b> Calculate the size of the effect.</a></li>
<li class="chapter" data-level="13.2.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#transform-the-effect-size-so-that-we-can-compare-it-to-an-expected-distribution."><i class="fa fa-check"></i><b>13.2.3</b> Transform the effect size so that we can compare it to an expected distribution.</a></li>
<li class="chapter" data-level="13.2.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#ask-what-the-probability-is-of-observing-an-effect-as-big-or-bigger-than-the-one-we-have-seen-assuming-the-null-hypothesis-to-be-true."><i class="fa fa-check"></i><b>13.2.4</b> Ask what the probability is of observing an effect as big, or bigger than the one we have seen, assuming the null hypothesis to be true.</a></li>
<li class="chapter" data-level="13.2.5" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#think-about-what-the-result-means."><i class="fa fa-check"></i><b>13.2.5</b> Think about what the result means.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#how-a-statistical-test-works"><i class="fa fa-check"></i><b>13.3</b> How a statistical test works</a><ul>
<li class="chapter" data-level="13.3.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-1-generating-our-null-and-alternative-hypotheses."><i class="fa fa-check"></i><b>13.3.1</b> Step 1 generating our null and alternative hypotheses.</a></li>
<li class="chapter" data-level="13.3.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-2-calculating-the-size-of-the-effect"><i class="fa fa-check"></i><b>13.3.2</b> Step 2 calculating the size of the effect</a></li>
<li class="chapter" data-level="13.3.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-3-transforming-the-effect-size-so-that-we-can-compare-it-to-an-expected-distribution."><i class="fa fa-check"></i><b>13.3.3</b> Step 3 Transforming the effect size so that we can compare it to an expected distribution.</a></li>
<li class="chapter" data-level="13.3.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-4-what-is-the-probability-is-of-observing-an-effect-as-big-or-bigger-than-the-one-we-have-seen-assuming-the-null-hypothesis-to-be-true"><i class="fa fa-check"></i><b>13.3.4</b> Step 4 What is the probability is of observing an effect as big, or bigger than the one we have seen, assuming the null hypothesis to be true?</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#what-statistical-testing-does-and-doesnt-tell-us"><i class="fa fa-check"></i><b>13.4</b> What statistical testing does and doesn’t tell us</a></li>
<li class="chapter" data-level="13.5" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#code-used-to-draw-figure-5"><i class="fa fa-check"></i><b>13.5</b> Code used to draw figure 5</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><i class="fa fa-check"></i><b>14</b> The Chi-squared Test and a Classic Dataset on Smoking and Cancer</a><ul>
<li class="chapter" data-level="14.1" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#are-lung-cancer-patients-who-smoke-more-likely-to-be-heavy-smokers"><i class="fa fa-check"></i><b>14.1</b> Are lung cancer patients who smoke more likely to be heavy smokers?</a></li>
<li class="chapter" data-level="14.2" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#the-chi-squared-test"><i class="fa fa-check"></i><b>14.2</b> The Chi-squared test</a></li>
<li class="chapter" data-level="14.3" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#chi-squared-test-with-contingency-tables"><i class="fa fa-check"></i><b>14.3</b> Chi-squared test with contingency tables</a></li>
<li class="chapter" data-level="14.4" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#assumptions-and-limitations-of-the-chi-squared-test"><i class="fa fa-check"></i><b>14.4</b> Assumptions and limitations of the chi-squared test</a></li>
<li class="chapter" data-level="14.5" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#are-lung-cancer-patients-more-likely-to-be-smokers-than-controls"><i class="fa fa-check"></i><b>14.5</b> Are lung cancer patients more likely to be smokers than controls?</a></li>
<li class="chapter" data-level="14.6" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#fishers-exact-test"><i class="fa fa-check"></i><b>14.6</b> Fisher’s exact test</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><i class="fa fa-check"></i><b>15</b> Comparing immune responses between two caterpillar species using a t-test</a><ul>
<li class="chapter" data-level="15.1" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#assumptions-and-limitations-of-standard-parametric-statistics"><i class="fa fa-check"></i><b>15.1</b> Assumptions and limitations of standard parametric statistics</a><ul>
<li class="chapter" data-level="15.1.1" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#normal-errors."><i class="fa fa-check"></i><b>15.1.1</b> Normal errors.</a></li>
<li class="chapter" data-level="15.1.2" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#independence-of-data-points."><i class="fa fa-check"></i><b>15.1.2</b> Independence of data points.</a></li>
<li class="chapter" data-level="15.1.3" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#equal-variances."><i class="fa fa-check"></i><b>15.1.3</b> Equal variances.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#importing-the-data"><i class="fa fa-check"></i><b>15.2</b> Importing the Data</a></li>
<li class="chapter" data-level="15.3" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#descriptives-and-initial-exploration"><i class="fa fa-check"></i><b>15.3</b> Descriptives and Initial Exploration</a></li>
<li class="chapter" data-level="15.4" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#comparing-two-means-with-a-t-test"><i class="fa fa-check"></i><b>15.4</b> Comparing Two Means With a t-test</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="correlation-analysis.html"><a href="correlation-analysis.html"><i class="fa fa-check"></i><b>16</b> Correlation analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#calculating-the-correlation-coefficient"><i class="fa fa-check"></i><b>16.1</b> Calculating the correlation coefficient</a><ul>
<li class="chapter" data-level="16.1.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#interpreting-our-correlation-coefficient."><i class="fa fa-check"></i><b>16.1.1</b> Interpreting our correlation coefficient.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="correlation-analysis.html"><a href="correlation-analysis.html#statistical-significance-of-r"><i class="fa fa-check"></i><b>16.2</b> Statistical significance of <em>r</em></a></li>
<li class="chapter" data-level="16.3" data-path="correlation-analysis.html"><a href="correlation-analysis.html#assumptions-of-correlation-analysis"><i class="fa fa-check"></i><b>16.3</b> Assumptions of correlation analysis</a><ul>
<li class="chapter" data-level="16.3.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#comparing-correlations-between-swim-run-and-bike-splits"><i class="fa fa-check"></i><b>16.3.1</b> Comparing correlations between swim, run and bike splits</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="correlation-analysis.html"><a href="correlation-analysis.html#correlation-causality-sample-size-and-significance."><i class="fa fa-check"></i><b>16.4</b> Correlation, causality, sample size and significance.</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><i class="fa fa-check"></i><b>17</b> Using Linear Regression to Analyse TB trends in the UK</a><ul>
<li class="chapter" data-level="17.0.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#least-squares-line-fitting"><i class="fa fa-check"></i><b>17.0.1</b> Least squares line fitting</a></li>
<li class="chapter" data-level="17.0.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#significance-tests-for-linear-regression"><i class="fa fa-check"></i><b>17.0.2</b> Significance tests for linear regression</a></li>
<li class="chapter" data-level="17.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#bovine-tb"><i class="fa fa-check"></i><b>17.1</b> Bovine TB</a></li>
<li class="chapter" data-level="17.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#assumptions-of-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Assumptions of linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#diagnostic-plots"><i class="fa fa-check"></i><b>17.2.1</b> Diagnostic plots</a></li>
<li class="chapter" data-level="17.2.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#diagnostic-plots-for-our-m.bovis-regression"><i class="fa fa-check"></i><b>17.2.2</b> Diagnostic plots for our <em>M.bovis</em> regression</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#interpreting-our-regression-and-predicting-future-cases"><i class="fa fa-check"></i><b>17.3</b> Interpreting our regression and predicting future cases</a></li>
<li class="chapter" data-level="17.4" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#multi-drug-resistant-tb"><i class="fa fa-check"></i><b>17.4</b> Multi-drug resistant TB</a></li>
<li class="chapter" data-level="17.5" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#fitting-a-quadratic-model"><i class="fa fa-check"></i><b>17.5</b> Fitting a quadratic model</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="anova-and-football.html"><a href="anova-and-football.html"><i class="fa fa-check"></i><b>18</b> ANOVA and Football</a><ul>
<li class="chapter" data-level="18.1" data-path="anova-and-football.html"><a href="anova-and-football.html#analysis-of-variance"><i class="fa fa-check"></i><b>18.1</b> Analysis of Variance</a></li>
<li class="chapter" data-level="18.2" data-path="anova-and-football.html"><a href="anova-and-football.html#interpreting-anova-results"><i class="fa fa-check"></i><b>18.2</b> Interpreting ANOVA results</a></li>
<li class="chapter" data-level="18.3" data-path="anova-and-football.html"><a href="anova-and-football.html#what-makes-a-professional-footballer"><i class="fa fa-check"></i><b>18.3</b> What makes a professional footballer?</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html"><i class="fa fa-check"></i><b>19</b> Yeast sex and two factor ANOVA.</a><ul>
<li class="chapter" data-level="19.1" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#yeast-sexual-selection"><i class="fa fa-check"></i><b>19.1</b> Yeast sexual selection</a></li>
<li class="chapter" data-level="19.2" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#understanding-the-coefficients-table"><i class="fa fa-check"></i><b>19.2</b> Understanding the coefficients table</a></li>
<li class="chapter" data-level="19.3" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#which-statistical-tests-to-use-with-lm"><i class="fa fa-check"></i><b>19.3</b> Which statistical tests to use with <code>lm()</code>?</a></li>
<li class="chapter" data-level="19.4" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#diagnostics"><i class="fa fa-check"></i><b>19.4</b> Diagnostics</a></li>
<li class="chapter" data-level="19.5" data-path="yeast-sex-and-two-factor-anova-.html"><a href="yeast-sex-and-two-factor-anova-.html#visualising-the-data"><i class="fa fa-check"></i><b>19.5</b> Visualising the data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer" class="section level1">
<h1><span class="header-section-number">Chapter 14</span> The Chi-squared Test and a Classic Dataset on Smoking and Cancer</h1>
<p>When it comes to crucial studies in public health, it’s hard to find one more important than a paper that was published in the British Medical Journal in 1950 by Richard Doll and A. Bradford Hill, entitled “Smoking and Carcinoma of the Lung: a Preliminary Report”. Doctors had been noticing a huge rise in the incidence of an unpleasant and lethal disease, lung cancer, for a number of years: the figures quoted in the Doll and Hill paper are that in 1922 there were 612 deaths from the disease in the UK, but in 1947 there were 9,287, a roughly 15 times increase in a 25 year period. The two possible explanations that most people considered likely were firstly that a general increase in atmospheric pollution was the cause, and secondly that smoking, and especially cigarette smoking, was causing the increase in lung cancer. Doll and Hill carried out a survey of people diagnosed with lung cancer in hospitals in London. Each time a patient in a hospital in London was diagnosed with lung cancer the investigators were notified, and the patient was interviewed and asked a series of questions, including details of his or her smoking history. The interviewer then found a second patient in the same hospital who didn’t have lung cancer but who matched the original patient in terms of sex and age, and asked them the same questions. Each lung cancer patient was therefore matched with a second patient who didn’t have lung cancer but who was hopefully similar to the first patient in most important aspects - what we would nowadays call a case-control study.
Using these data we can look at two of the questions that Doll and Hill addressed in their publication. Firstly, if we just consider the smokers in the sample, are cancer patients more likely to be heavy smokers than controls? Secondly, are patients with lung cancer more likely to be smokers than patients without?</p>
<div id="are-lung-cancer-patients-who-smoke-more-likely-to-be-heavy-smokers" class="section level2">
<h2><span class="header-section-number">14.1</span> Are lung cancer patients who smoke more likely to be heavy smokers?</h2>
<p>Here is part of one of the tables of data from the Doll and Hill paper.</p>
<p><img src="Images/Doll%20and%20Hill%20table%201.png" width="75%" height="75%"/></p>
<p>This table reports the amount of tobacco consumed daily before the onset of the current disease in male smokers both with and without lung cancer. Tobacco smoked in ways other than cigarettes has been converted to cigarette equivalents. One thing to notice is that the total number of patients is not the same in each group - there are more cancer patients than controls, a consequence of there being more controls who were classified as non-smokers and not included in this particular analysis.
Looking at these data as a table we can see some differences between groups, but it will be easier to visualise it if we draw a graph. To do this we need to enter these data into R, and the best way to input the data is as a matrix.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb415-1"></a>cancer &lt;-</span>
<span id="cb415-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb415-2"></a><span class="st">  </span><span class="kw">matrix</span>(</span>
<span id="cb415-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb415-3"></a>    <span class="dt">data =</span> <span class="kw">c</span>(<span class="dv">33</span>, <span class="dv">250</span>, <span class="dv">196</span>, <span class="dv">136</span>, <span class="dv">32</span>, <span class="dv">55</span>, <span class="dv">293</span>, <span class="dv">190</span>, <span class="dv">71</span>, <span class="dv">13</span>),</span>
<span id="cb415-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb415-4"></a>    <span class="dt">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb415-5"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb415-5"></a>    <span class="dt">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb415-6"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb415-6"></a>    <span class="dt">byrow =</span> T</span>
<span id="cb415-7"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb415-7"></a>  )</span></code></pre></div>
<p>Let’s break that instruction down so that we know what’s going on.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb416-1"></a>cancer&lt;-</span></code></pre></div>
<p>Make a new object called “cancer”. It should be whatever is on the other side of the allocation symbol.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb417-1"></a><span class="kw">matrix</span>(</span>
<span id="cb417-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb417-2"></a>  <span class="dt">data=</span><span class="kw">c</span>(<span class="dv">33</span>,<span class="dv">250</span>,<span class="dv">196</span>,<span class="dv">136</span>,<span class="dv">32</span>,<span class="dv">55</span>,<span class="dv">293</span>,<span class="dv">190</span>,<span class="dv">71</span>,<span class="dv">13</span>)…</span></code></pre></div>
<p>What goes into the object “cancer” is a matrix, containing ten data points which I have just read off the table in the Doll and Hill paper.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb418-1"></a>  …,nrow=<span class="dv">2</span>, </span>
<span id="cb418-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb418-2"></a>    ncol=<span class="dv">5</span>, </span>
<span id="cb418-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb418-3"></a>    byrow=<span class="ot">TRUE</span><span class="er">)</span></span></code></pre></div>
<p>After the “data” argument for the matrix function we have three more. nrow= tells R how many rows the matrix should have and ncol= gives the number of columns. byrow=TRUE tells R to read the data into the matrix by filling up the first row with numbers and then the second row. If byrow was set to FALSE it would fill it up starting with the first column.</p>
<p>The whole instruction therefore tells R the following:
Set up a new object called “cancer”. It should be a matrix with two rows and five columns, filled with the following data. Read the data in by row, rather than by column, please.
We can check whether it’s worked by just typing the name of the object and pressing enter.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb419-1"></a>cancer</span></code></pre></div>
<!-- html table generated in R 4.0.0 by xtable 1.8-4 package -->
<!-- Wed Jul 29 15:48:25 2020 -->
<table border="1">
<tr>
<th>
</th>
<th>
1
</th>
<th>
2
</th>
<th>
3
</th>
<th>
4
</th>
<th>
5
</th>
</tr>
<tr>
<td align="right">
1
</td>
<td align="right">
33.00
</td>
<td align="right">
250.00
</td>
<td align="right">
196.00
</td>
<td align="right">
136.00
</td>
<td align="right">
32.00
</td>
</tr>
<tr>
<td align="right">
2
</td>
<td align="right">
55.00
</td>
<td align="right">
293.00
</td>
<td align="right">
190.00
</td>
<td align="right">
71.00
</td>
<td align="right">
13.00
</td>
</tr>
</table>
<p>There’s our data. It would be nice to have proper names for our rows and columns, and we can do this with the dimnames() (think “dimension names”) function.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb420-1"></a><span class="kw">dimnames</span>(cancer) &lt;-</span>
<span id="cb420-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb420-2"></a><span class="st">  </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;Lung cancer&quot;</span>, <span class="st">&quot;Control&quot;</span>),</span>
<span id="cb420-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb420-3"></a>       <span class="kw">c</span>(<span class="st">&quot;1 to 4&quot;</span>, <span class="st">&quot;5 to 14&quot;</span>, <span class="st">&quot;15 to 24&quot;</span>, <span class="st">&quot;25 to 49&quot;</span>, <span class="st">&quot;50+&quot;</span>))</span></code></pre></div>
<p>The reason we’re using a list here is that we are giving the function two vectors of character information. Lists are a way of putting together sets of any sort of object in R: in this case one vector of row names (“Lung cancer” and “Control”) and one vector of column names. Let’s check that worked properly.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb421-1"></a>cancer</span>
<span id="cb421-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb421-2"></a>            <span class="dv">1</span> to <span class="dv">4</span> <span class="dv">5</span> to <span class="dv">14</span> <span class="dv">15</span> to <span class="dv">24</span> <span class="dv">25</span> to <span class="dv">49</span> <span class="dv">50</span><span class="op">+</span></span>
<span id="cb421-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb421-3"></a>Lung cancer     <span class="dv">33</span>     <span class="dv">250</span>      <span class="dv">196</span>      <span class="dv">136</span>  <span class="dv">32</span></span>
<span id="cb421-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb421-4"></a>Control         <span class="dv">55</span>     <span class="dv">293</span>      <span class="dv">190</span>       <span class="dv">71</span>  <span class="dv">13</span></span></code></pre></div>
<p>Let’s draw ourselves a graph so that we can see any patterns in the data. A bar graph is the best way to represent frequencies like these, and we can use the barplot() function.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb422-1"></a><span class="kw">barplot</span>(cancer, <span class="dt">beside=</span>T)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-429"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-429-1.png" alt="Barplot showing the tobacco consumption in cigarette equivalents per day for lung cancer patients and controls" width="672" />
<p class="caption">
Figure 14.1: Barplot showing the tobacco consumption in cigarette equivalents per day for lung cancer patients and controls
</p>
</div>
<p>The barplot() function is happy to take our matrix and if we tell it to plot the two rows beside each other (beside=T) it will draw us a nice graph.</p>
<p>It would be nice to have a legend and some axis labels just to make everything really clear. The barplot() function will automatically add a legend if you ask it to (legend.text=TRUE) and the xlab= and ylab= arguments let us specify the labels for the x- and y-axes.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb423-1"></a><span class="kw">barplot</span>(cancer, <span class="dt">beside=</span>T, <span class="dt">legend.text=</span>T, <span class="dt">xlab=</span><span class="st">&quot;Number of cigarettes smoked&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Number of cases&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-430"></span>
<img src="3rd_Edition_files/figure-html/unnamed-chunk-430-1.png" alt="Barplot showing the tobacco consumption in cigarette equivalents per day for lung cancer patients and controls, now with axis labels and a legend" width="672" />
<p class="caption">
Figure 14.2: Barplot showing the tobacco consumption in cigarette equivalents per day for lung cancer patients and controls, now with axis labels and a legend
</p>
</div>
<p>Looking at the graph we can see some differences between the frequencies of cancer patients and controls in the different groups: more controls reported smoking fewer than 15 cigarettes per day, whereas more lung cancer patients reported smoking more than 25 - in other words, lung cancer patients were more likely to be heavy smokers. The question we need to answer now is whether that apparent difference is likely simply to be the result of random error during sampling, or whether it’s likely to reflect a genuine difference between the lung cancer patients and the controls. In other words, we want to know the probability of seeing a pattern like this if we were to sample at random from two populations where the distribution of smoking was actually the same. We can answer this question by carrying out a chi-square test on our data using the chisq.test() function.</p>
</div>
<div id="the-chi-squared-test" class="section level2">
<h2><span class="header-section-number">14.2</span> The Chi-squared test</h2>
<p>The Chi-squared distribution is a statistical probability distribution which is widely used in a large number of statistical tests, all of which are technically chi-squared tests. The most common of these is the <em>Pearson’s Chi-Squared test</em>, and when people refer to a chi-squared test they are usually talking about the Pearson’s version.</p>
<p>One of the main uses of Pearson’s chi-squared test (hereafter just the chi-squared test) is to compare observed frequencies with the frequencies expected under some null hypothesis, and since this is the simplest way to use it we’ll look at this first. As an example, consider an experiment on the genetics of flower colour in snapdragons. You know that the flowers can be red, pink or white and you suspect that flower colour is controlled by a single locus (a single gene for non-biologists) with two varieties, or alleles, which code for red and white respectively. You also think that the pink flowers are heterozygotes, with one copy of each allele, and the red and white flowers are homozygotes, with two copies of the same allele. You have a supply of pink flowering plants and you cross them and grow 500 of the seeds into flowering plants and score them for flower colour. If the colour of the flowers is controlled in the way you suspect then you’d expect 25% of the offspring to have white flowers, 50% to have pink, and 25% to have red, so your <em>expected frequencies</em> are 125 white, 250 pink and 125 white. In fact, what you get when you do your experiment - your <em>observed frequencies</em> - are 106 white, 252 pink and 142 white. That’s different from what was expected in that there are rather fewer white flowers and rather more red flowers than we expected to see. Could this just be a consequence of random chance? This is where the chi-squared test can be used.</p>
<p>The test statistic for a chi-square test is calculated as:</p>
<p><span class="math display">\[\Large \chi^{2} = \sum{ \frac{(O - E)^2}{E}}\]</span></p>
<p>where O is the frequency that is observed and E is the expected frequency under the null hypothesis. This is calculated for each set of values and then they’re all added together (which is what the capital sigma means).</p>
<p>In the case of our snapdragons, here is our calculation of the test statistic.</p>
<table>
<thead>
<tr class="header">
<th align="center">Flower colour</th>
<th align="center">Expected</th>
<th align="center">Observed</th>
<th align="center">(E - O)^2</th>
<th align="center">(E - O)^2 /E</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>White</strong></td>
<td align="center">125</td>
<td align="center">106</td>
<td align="center">361</td>
<td align="center">2.888</td>
</tr>
<tr class="even">
<td align="center"><strong>Pink</strong></td>
<td align="center">250</td>
<td align="center">252</td>
<td align="center">4</td>
<td align="center">0.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>Red</strong></td>
<td align="center">125</td>
<td align="center">142</td>
<td align="center">289</td>
<td align="center">2.312</td>
</tr>
<tr class="even">
<td align="center">Sum</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><strong>5.216</strong></td>
</tr>
</tbody>
</table>
<p>This gives us a test statistic of 5.216, and we can now ask the question of how likely we are to see this value or greater given the null hypothesis. We can do this by using the <code>pchisq()</code> function in R. Since this returns the probability of a value less than or equal to the number give we have to subtract it from one. The <em>degrees of freedom</em> we need to use is the number of categories that we have counts for minus 1: in this case 3-1=2.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb424-1"></a><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(<span class="fl">5.216</span>,<span class="dv">2</span>)</span>
<span id="cb424-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb424-2"></a>[<span class="dv">1</span>] <span class="fl">0.073682</span></span></code></pre></div>
<p>This gives us a p-value which is slightly greater than the p=0.05 cutoff for statistical significance. This is therefore a non-significant result, and we do not have grounds to reject the null hypothesis. The p-value is close to significance, however, so all we can really say is that there is a lot of uncertainty about the genetics of flower colour in snapdragons. If we want to get a more definitive answer we should probably repeat the experiment with more snapdragons<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>. Back to the greenhouse.</p>
<p>To do the same test in R without having to do the calculations yourself use the <code>chisq.test()</code> function. For a chisquared test for <em>goodness of fit</em>, which is what this example is, you need to give the function a vector of observed counts and a vector of the probabilities for each count.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb425-1"></a>observed&lt;-<span class="kw">c</span>(<span class="dv">106</span>,<span class="dv">252</span>,<span class="dv">142</span>)</span>
<span id="cb425-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb425-2"></a>expected&lt;-<span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.25</span>)</span>
<span id="cb425-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb425-3"></a><span class="kw">chisq.test</span>(observed, <span class="dt">p=</span>expected)</span>
<span id="cb425-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb425-4"></a></span>
<span id="cb425-5"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb425-5"></a>    Chi<span class="op">-</span>squared test <span class="cf">for</span> given probabilities</span>
<span id="cb425-6"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb425-6"></a></span>
<span id="cb425-7"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb425-7"></a>data<span class="op">:</span><span class="st">  </span>observed</span>
<span id="cb425-8"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb425-8"></a>X<span class="op">-</span>squared =<span class="st"> </span><span class="fl">5.22</span>, df =<span class="st"> </span><span class="dv">2</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.074</span></span></code></pre></div>
</div>
<div id="chi-squared-test-with-contingency-tables" class="section level2">
<h2><span class="header-section-number">14.3</span> Chi-squared test with contingency tables</h2>
<p>The other main way that Pearson’s chi-squared test is used is as a test of <em>independence</em> when you have counts related to two or more variables. The basics of how this works are exactly the same way as the previous version, but the details are slightly more complicated. The first analysis we carried out above, where we compared the numbers of patients smoking different numbers of cigarettes a day between lung cancer sufferers and controls, is an exmaple of this type of analysis. When we have counts related to more than one variable the data are traditionally presented in a <em>contingency table</em>, with the counts related to each variable presented as a separate row or column - in the example above the variables were whether or not the patient had lung cancer (presented as a row) and the number of cigarettes smoked per day (presented as a column). Once we have our contingency table then we can calculate the expected values for each <em>cell</em> in the table as the row total (the sum of all the values in the row that the cell is in) times the column total divided by the overall total: the sum of all the cells in the table, and the test statistic is then calculated as before.</p>
<p>Here’s the table for the Doll and Hill data, with the row and column totals.</p>
<table>
<thead>
<tr class="header">
<th align="center">Number of cigs</th>
<th align="center">1-4</th>
<th align="center">5-14</th>
<th align="center">15-24</th>
<th align="center">25-49</th>
<th align="center">50+</th>
<th align="center">Row total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Lung cancer</strong></td>
<td align="center">33</td>
<td align="center">250</td>
<td align="center">196</td>
<td align="center">136</td>
<td align="center">32</td>
<td align="center">647</td>
</tr>
<tr class="even">
<td align="center"><strong>Control</strong></td>
<td align="center">55</td>
<td align="center">293</td>
<td align="center">190</td>
<td align="center">71</td>
<td align="center">13</td>
<td align="center">622</td>
</tr>
<tr class="odd">
<td align="center"><strong>Column totals</strong></td>
<td align="center">88</td>
<td align="center">543</td>
<td align="center">386</td>
<td align="center">207</td>
<td align="center">45</td>
<td align="center">1269</td>
</tr>
</tbody>
</table>
<p>So the expected value for the top left cell is (647 x 88) / 1269 = 44.87</p>
<p>The (O - E)^2 /E for this cell is therefore (33-44.87)^2 /44.87 = 3.14</p>
<p>If we repeat this for each cell in the table and sum them we get we get 36.95 as our test statistic. The degrees of freedom for a chi-squared test for independence is (R-1) x (C-1) where R and C are the number of rows and columns in the table respectively (excluding the row and column for the totals if you’ve included them, so we have (5-1) x (2-1) or 4 df.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb426-1"></a><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(<span class="fl">36.95</span>,<span class="dv">4</span>)</span>
<span id="cb426-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb426-2"></a>[<span class="dv">1</span>] <span class="fl">1.8445e-07</span></span></code></pre></div>
<p>The number that R returns for our p-value is given in the notation that R uses for very big or very small numbers: this is the equivalent of writing 1.842x10^-7, so our p-value is 0.0000001845. This is a very small number, indicating that we would be very unlikely to see a test statistic with a value as great, or greater than this if the patterns in our data had arisen by random chance. On this basis we would reject the null hypothesis, that the distribution of counts of people smoking different numbers of cigarettes is independent of whether they are a lung cancer patient or a control, and cautiously accept the alternative, that the distribution of counts of numbers of cigarettes smoked is different between lung cancer patients and controls.</p>
<p>Of course, the whole point of using R is so that you don’t have to do your chisquared tests from first principles every time so it’s quicker to use the <code>chisq.test()</code> function. If you feed this a matrix as its first argument it will assume that you want to carry out a chisquared test for independence on the values in the matrix.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb427-1"></a><span class="kw">chisq.test</span>(cancer)</span>
<span id="cb427-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb427-2"></a></span>
<span id="cb427-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb427-3"></a>    Pearson<span class="st">&#39;s Chi-squared test</span></span>
<span id="cb427-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb427-4"></a></span>
<span id="cb427-5"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb427-5"></a><span class="st">data:  cancer</span></span>
<span id="cb427-6"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb427-6"></a><span class="st">X-squared = 37, df = 4, p-value = 1.8e-07</span></span></code></pre></div>
<p>This gives us our calculated test statistic, the degrees of freedom for the test and the p-value. The latter is very similar to the one we calculated before, with a slight difference in th last significant figure only which arises from R doing its calculations to rather more significant figures than we have done.</p>
<p>If we want to look at the output of the analysis in a bit more detail then we can save an object containing the results of the chi-squared test.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb428-1"></a>cancer.chisq&lt;-<span class="kw">chisq.test</span>(cancer)</span></code></pre></div>
<p>If we do this then when we press enter we don’t get any output, but if we type the name of the object we get the same output that we had before:</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb429-1"></a>cancer.chisq</span>
<span id="cb429-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb429-2"></a></span>
<span id="cb429-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb429-3"></a>    Pearson<span class="st">&#39;s Chi-squared test</span></span>
<span id="cb429-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb429-4"></a></span>
<span id="cb429-5"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb429-5"></a><span class="st">data:  cancer</span></span>
<span id="cb429-6"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb429-6"></a><span class="st">X-squared = 37, df = 4, p-value = 1.8e-07</span></span></code></pre></div>
<p>That doesn’t give us any new information, but there is quite a bit of information summarised in the cancer.chisq object that we can ask to see. Our object (cancer.chisq) is in fact stored as a list of several different pieces of information with different names:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb430-1"></a><span class="kw">names</span>(cancer.chisq)</span>
<span id="cb430-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb430-2"></a>[<span class="dv">1</span>] <span class="st">&quot;statistic&quot;</span> <span class="st">&quot;parameter&quot;</span> <span class="st">&quot;p.value&quot;</span>   <span class="st">&quot;method&quot;</span>    <span class="st">&quot;data.name&quot;</span> <span class="st">&quot;observed&quot;</span> </span>
<span id="cb430-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb430-3"></a>[<span class="dv">7</span>] <span class="st">&quot;expected&quot;</span>  <span class="st">&quot;residuals&quot;</span> <span class="st">&quot;stdres&quot;</span>   </span></code></pre></div>
<p>If we just type the name of the object it tells us the method (“method”), the dataset used (“data.name”), the calculated test statistic (“statistic”), the df (“parameter”) and the p-value (“p-value”). These have been selected as the pieces of information that someone doing a test like this is likely to want to see, and if you have a stored object with the results of a different sort of analysis you might be given a different set of information by default. The bits of information that we don’t automatically get for a chi-squared test are “observed” - the observed data, “expected” - the expected values if there’s no difference between groups, “residuals” - the Pearson’s residuals for each value in our matrix, calculated as (observed-expected)/√(expected) and “stdres” - the standardised residuals. The residuals will tell us how far each cell in the matrix was from the expected value if the null hypothesis were true.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb431-1"></a>cancer.chisq<span class="op">$</span>residuals</span>
<span id="cb431-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb431-2"></a>             <span class="dv">1</span> to <span class="dv">4</span> <span class="dv">5</span> to <span class="dv">14</span>  <span class="dv">15</span> to <span class="dv">24</span> <span class="dv">25</span> to <span class="dv">49</span>     <span class="dv">50</span><span class="op">+</span></span>
<span id="cb431-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb431-3"></a>Lung cancer <span class="fl">-1.7716</span> <span class="fl">-1.6136</span> <span class="fl">-0.057184</span>   <span class="fl">2.9651</span>  <span class="fl">1.8908</span></span>
<span id="cb431-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb431-4"></a>Control      <span class="fl">1.8069</span>  <span class="fl">1.6457</span>  <span class="fl">0.058321</span>  <span class="fl">-3.0241</span> <span class="fl">-1.9284</span></span></code></pre></div>
<p>These correspond to what we’ve already seen from the barplot. When we look at the light smokers (fewer than 15 cigarettes per day) the lung cancer patients have negative residual values and the controls have positive ones - in other words, there are fewer lung cancer patients and more controls reporting relatively light smoking habits. For the 15-24 cigarettes per day group the residuals are close to zero for both groups, but then for the heavy smokers we have positive residuals for the lung cancer patients and negative residuals for the controls, telling us that there are more lung cancer patients reporting heavy smoking habits than expected.</p>
</div>
<div id="assumptions-and-limitations-of-the-chi-squared-test" class="section level2">
<h2><span class="header-section-number">14.4</span> Assumptions and limitations of the chi-squared test</h2>
<p>Like most statistical tests, the chi-squared test assumes that each data point is <em>independent</em>, meaning that the probability of getting a particular value for one data point is not affected by the values of any other data points. An example of non-independence would be when there are multiple counts from the same individual: if we reared 100 snapdragon plants in the first example, and scored five flowers on each for colour, then the colour of one flower on a plant would be correlated with the colour of the other flowers, meaning that the assumption of independence would be violated and the “real” sample size would be 100, not 500.</p>
<p>A limitation of the chi-squared test is that when the counts in some of the cells of a contongency table start getting small it becomes less reliable. A rule of thumb is that if any of the cells have counts less than 5 you shouldn’t really rely on a chi-squared test and it’s advisable to use a <em>Fisher’s exact test</em> instead.</p>
</div>
<div id="are-lung-cancer-patients-more-likely-to-be-smokers-than-controls" class="section level2">
<h2><span class="header-section-number">14.5</span> Are lung cancer patients more likely to be smokers than controls?</h2>
<p>At first glance this seems to be the more obvious analysis of the two, and so looking at these data second might be thought of as a little strange, but in fact these data are rather less straightforwards to analyse. This is because, to our 21st Century eyes, there is an astonishingly low number of patients classified as non-smokers in this study. Doll and Hill defined a smoker as being someone who at some point in their life had smoked at least one cigarette a day for a period of at least a year, and of the 1298 male patients included in this study only 29, or 2.2%, were classed as non-smokers. The smokers and non-smokers were not evenly spread between lung cancer patients and controls: as can be seen from this data table from the paper, only two of the lung cancer patients were non-smokers, whereas 27 of the controls were identified as being in this group.</p>
<p><img src="Images/Doll%20and%20Hill%20table%202.png" width="75%" height="75%"/></p>
<p>We can, therefore, see a possible pattern in these data, with lung cancer patients being less likely than controls to be non-smokers. What we don’t know is how likely this pattern is to have arisen by chance. The counts of non-smokers are only a small fraction of the overall counts, and it’s difficult to know whether we might be likely to get such a pattern just by drawing at random from two similar populations with similar, low percentages of smokers.</p>
<p>We could analyse these data using another chi-squared test, but the chi-squared test is not really suitable when we have a contingency table with low values in one or more cell, as is the case here. Fortunately we have the option of using a test that takes this into account, namely Fisher’s exact test.</p>
</div>
<div id="fishers-exact-test" class="section level2">
<h2><span class="header-section-number">14.6</span> Fisher’s exact test</h2>
<p>Fisher’s exact test is an alternative to the chi-squared test which can be used for contingency tables when there are counts below 5 or even of zero in some of the cells in the table. It relies on some fairly complex calculations which we won’t go into detail about, and with large counts the test becomes difficult to calculate and may be unreliable, so when the frequencies you’re dealing with are fairly large use a chi-squared test and when they’re small use a Fisher’s exact test. The R function you want is <code>fisher.test()</code> which takes a matrix as an argument in just the same way that <code>chisq.test()</code> does.</p>
<p>First we need to set up a matrix of our data:</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb432-1"></a>smokers &lt;-<span class="st"> </span><span class="kw">matrix</span>(</span>
<span id="cb432-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb432-2"></a>  <span class="dt">data =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">647</span>, <span class="dv">27</span>, <span class="dv">622</span>),</span>
<span id="cb432-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb432-3"></a>  <span class="dt">byrow =</span> T,</span>
<span id="cb432-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb432-4"></a>  <span class="dt">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb432-5"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb432-5"></a>  <span class="dt">ncol =</span> <span class="dv">2</span></span>
<span id="cb432-6"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb432-6"></a>)</span>
<span id="cb432-7"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb432-7"></a><span class="kw">dimnames</span>(smokers) &lt;-</span>
<span id="cb432-8"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb432-8"></a><span class="st">  </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;Lung Cancer&quot;</span>, <span class="st">&quot;Control&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;Non smoker&quot;</span>, <span class="st">&quot;Smoker&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb433-1"></a>smokers</span>
<span id="cb433-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb433-2"></a>            Non smoker Smoker</span>
<span id="cb433-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb433-3"></a>Lung Cancer          <span class="dv">2</span>    <span class="dv">647</span></span>
<span id="cb433-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb433-4"></a>Control             <span class="dv">27</span>    <span class="dv">622</span></span></code></pre></div>
<p>Now we can test whether smoking is distributed homogeneously across lung cancer patients and controls.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-1"></a><span class="kw">fisher.test</span>(smokers)</span>
<span id="cb434-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-2"></a></span>
<span id="cb434-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-3"></a>    Fisher<span class="st">&#39;s Exact Test for Count Data</span></span>
<span id="cb434-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-4"></a></span>
<span id="cb434-5"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-5"></a><span class="st">data:  smokers</span></span>
<span id="cb434-6"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-6"></a><span class="st">p-value = 1.3e-06</span></span>
<span id="cb434-7"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-7"></a><span class="st">alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span id="cb434-8"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-8"></a><span class="st">95 percent confidence interval:</span></span>
<span id="cb434-9"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-9"></a><span class="st"> 0.0081734 0.2857879</span></span>
<span id="cb434-10"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-10"></a><span class="st">sample estimates:</span></span>
<span id="cb434-11"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-11"></a><span class="st">odds ratio </span></span>
<span id="cb434-12"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb434-12"></a><span class="st">  0.071287 </span></span></code></pre></div>
<p>We get a little more in the output for the Fisher’s exact test than for the chi-square test. Most of our extra information centres around the “odds ratio” - this is ratio of the odds of a patient being a non-smoker in the lung cancer group to the odds of a patient being a non-smoker in the control group. The estimated value from the Fisher’s exact test (0.07128) is very close to what we get if we just calculate an odds ratio ourselves.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb435-1"></a>(<span class="dv">2</span><span class="op">/</span><span class="dv">647</span>)<span class="op">/</span>(<span class="dv">27</span><span class="op">/</span><span class="dv">622</span>)</span>
<span id="cb435-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb435-2"></a>[<span class="dv">1</span>] <span class="fl">0.071212</span></span></code></pre></div>
<p>The question that Fisher’s exact test is asking is whether the odds ratio is significantly different from one, and you can see that the p-value of 1.281e-06, or 0.000001281 indicates that we should discard our null hypothesis and accept the alternative. In other words, we can be confident that the differences in the frequencies of smokers and non-smokers in the two groups are unlikely to have arisen by random sampling error.</p>
<p>If we look at the analysis in the original Doll and Hill paper, they seem to have arrived at a slightly different answer. Here is the table we saw earlier with the analysis result as well.</p>
<p><img src="Images/Doll%20and%20Hill%20table%203.png" width="75%" height="75%"/></p>
<p>You can see that their p-value is different from ours. Why is this? One thing you can immediately notice when you compare their p-value with ours is that theirs is exactly half of ours. To the experienced statistical detective this is a complete give-away and tells us that while we have used a two-tailed test (alternative hypothesis is that the odds-ratio is not equal to 1), Doll and Hill used a one-tailed test (alternative hypothesis that the odds-ratio is less than one). Nowadays we would regard this as being a bit naughty without good justification, and something that should certainly be explained properly in the paper, but given how long ago it was, and that history has proven Doll and Hill to have been spectacularly right, I think we can let them off the hook and not get the knighthoods posthumously withdrawn. Rest easy guys.</p>
<p>We can do a one-tailed test just to check using the “alternative=” argument in fisher.test().</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-1"></a><span class="kw">fisher.test</span>(smokers,<span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)</span>
<span id="cb436-2"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-2"></a></span>
<span id="cb436-3"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-3"></a>    Fisher<span class="st">&#39;s Exact Test for Count Data</span></span>
<span id="cb436-4"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-4"></a></span>
<span id="cb436-5"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-5"></a><span class="st">data:  smokers</span></span>
<span id="cb436-6"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-6"></a><span class="st">p-value = 6.4e-07</span></span>
<span id="cb436-7"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-7"></a><span class="st">alternative hypothesis: true odds ratio is less than 1</span></span>
<span id="cb436-8"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-8"></a><span class="st">95 percent confidence interval:</span></span>
<span id="cb436-9"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-9"></a><span class="st"> 0.00000 0.24447</span></span>
<span id="cb436-10"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-10"></a><span class="st">sample estimates:</span></span>
<span id="cb436-11"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-11"></a><span class="st">odds ratio </span></span>
<span id="cb436-12"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#cb436-12"></a><span class="st">  0.071287 </span></span></code></pre></div>
<p>Giving us a p-value of 6.403e-07, or 0.00000064, the same as the original paper.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="16">
<li id="fn16"><p>When you get a p-value near 0.05, this is really just about all you can do. It sucks. Please note that just adding more data until you get a significant result is a Really Bad Idea and likely to cause trouble. Rather, you need to do the whole thing again with a bigger sample size.<a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#fnref16" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="what-is-statistical-testing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["3rd_Edition.pdf", "3rd_Edition.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
