<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Yeast sexual selection | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</title>
  <meta name="description" content="null" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Yeast sexual selection | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="null" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Yeast sexual selection | Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R" />
  
  <meta name="twitter:description" content="null" />
  

<meta name="author" content="Rob Knell" />


<meta name="date" content="2020-05-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="yeast-sex-and-anova.html"/>
<link rel="next" href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introductory R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i><b>1.1</b> Why this book?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.2</b> How to use this book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-first-r-session.html"><a href="a-first-r-session.html"><i class="fa fa-check"></i><b>2</b> A first R session</a><ul>
<li class="chapter" data-level="2.1" data-path="a-first-r-session.html"><a href="a-first-r-session.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="a-first-r-session.html"><a href="a-first-r-session.html#a-first-r-session-1"><i class="fa fa-check"></i><b>2.2</b> A first R session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html"><i class="fa fa-check"></i><b>3</b> Basics: arithmetic, objects and functions</a><ul>
<li class="chapter" data-level="3.0.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#arithmetic"><i class="fa fa-check"></i><b>3.0.1</b> Arithmetic</a></li>
<li class="chapter" data-level="3.0.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#logical-operations"><i class="fa fa-check"></i><b>3.0.2</b> Logical operations</a></li>
<li class="chapter" data-level="3.0.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects"><i class="fa fa-check"></i><b>3.0.3</b> Objects</a></li>
<li class="chapter" data-level="3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#kinds-of-data"><i class="fa fa-check"></i><b>3.1</b> Kinds of data</a></li>
<li class="chapter" data-level="3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#whats-in-my-workspace"><i class="fa fa-check"></i><b>3.2</b> What’s in my workspace?</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations"><i class="fa fa-check"></i><b>3.3.1</b> Calculations</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-1"><i class="fa fa-check"></i><b>3.3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-1"><i class="fa fa-check"></i><b>3.3.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#answers-to-exercises"><i class="fa fa-check"></i><b>3.4</b> Answers to exercises</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#calculations-1"><i class="fa fa-check"></i><b>3.4.1</b> Calculations</a></li>
<li class="chapter" data-level="3.4.2" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#objects-2"><i class="fa fa-check"></i><b>3.4.2</b> Objects</a></li>
<li class="chapter" data-level="3.4.3" data-path="basics-arithmetic-objects-and-functions.html"><a href="basics-arithmetic-objects-and-functions.html#functions-2"><i class="fa fa-check"></i><b>3.4.3</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html"><i class="fa fa-check"></i><b>4</b> Data: Vectors, Matrices and Data Frames</a><ul>
<li class="chapter" data-level="4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices"><i class="fa fa-check"></i><b>4.2</b> Matrices</a></li>
<li class="chapter" data-level="4.3" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#factors-and-data-frames"><i class="fa fa-check"></i><b>4.3</b> Factors and Data frames</a></li>
<li class="chapter" data-level="4.4" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-1"><i class="fa fa-check"></i><b>4.4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-1"><i class="fa fa-check"></i><b>4.4.2</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#answers-to-exercises-1"><i class="fa fa-check"></i><b>4.5</b> Answers to exercises</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#vectors-2"><i class="fa fa-check"></i><b>4.5.1</b> Vectors</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-vectors-matrices-and-data-frames.html"><a href="data-vectors-matrices-and-data-frames.html#matrices-2"><i class="fa fa-check"></i><b>4.5.2</b> Matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html"><i class="fa fa-check"></i><b>5</b> Choosing data: subscripts and subsetting</a><ul>
<li class="chapter" data-level="5.0.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts"><i class="fa fa-check"></i><b>5.0.1</b> Subscripts</a></li>
<li class="chapter" data-level="5.0.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-in-matrices-and-data-frames"><i class="fa fa-check"></i><b>5.0.2</b> Subscripts in matrices and data frames</a></li>
<li class="chapter" data-level="5.0.3" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subset"><i class="fa fa-check"></i><b>5.0.3</b> Subset</a></li>
<li class="chapter" data-level="5.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#exercises-2"><i class="fa fa-check"></i><b>5.1</b> Exercises</a><ul>
<li class="chapter" data-level="5.1.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors"><i class="fa fa-check"></i><b>5.1.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.1.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices"><i class="fa fa-check"></i><b>5.1.2</b> Subscripts and matrices</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#answers-to-exercises-2"><i class="fa fa-check"></i><b>5.2</b> Answers to exercises</a><ul>
<li class="chapter" data-level="5.2.1" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-vectors-1"><i class="fa fa-check"></i><b>5.2.1</b> Subscripts and vectors</a></li>
<li class="chapter" data-level="5.2.2" data-path="choosing-data-subscripts-and-subsetting.html"><a href="choosing-data-subscripts-and-subsetting.html#subscripts-and-matrices-1"><i class="fa fa-check"></i><b>5.2.2</b> Subscripts and matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html"><i class="fa fa-check"></i><b>6</b> R scripts and your R workflow</a><ul>
<li class="chapter" data-level="6.1" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#writing-and-using-r-scripts"><i class="fa fa-check"></i><b>6.1</b> Writing and using R scripts</a></li>
<li class="chapter" data-level="6.2" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-an-r-script-window"><i class="fa fa-check"></i><b>6.2</b> Running code from an R script window</a></li>
<li class="chapter" data-level="6.3" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#running-code-from-files-using-source"><i class="fa fa-check"></i><b>6.3</b> Running code from files using <code>source()</code></a></li>
<li class="chapter" data-level="6.4" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#workflow-structure-or-what-should-i-put-in-my-script"><i class="fa fa-check"></i><b>6.4</b> Workflow structure, or what should I put in my script?</a></li>
<li class="chapter" data-level="6.5" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#keep-it-neat-making-your-script-easy-to-read"><i class="fa fa-check"></i><b>6.5</b> Keep it neat — making your script easy to read</a></li>
<li class="chapter" data-level="6.6" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#i-wish-i-hadnt-commented-my-code-so-much-said-no-one-ever-4."><i class="fa fa-check"></i><b>6.6</b> “I wish I hadn’t commented my code so much”, said no-one, ever [^4].</a></li>
<li class="chapter" data-level="6.7" data-path="r-scripts-and-your-r-workflow.html"><a href="r-scripts-and-your-r-workflow.html#using-rstudio-to-write-scripts"><i class="fa fa-check"></i><b>6.7</b> Using RStudio to write scripts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html"><i class="fa fa-check"></i><b>7</b> Help files and packages</a><ul>
<li class="chapter" data-level="7.1" data-path="help-files-and-packages.html"><a href="help-files-and-packages.html#using-the-help-files"><i class="fa fa-check"></i><b>7.1</b> Using the help files</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>8</b> Importing Data</a><ul>
<li class="chapter" data-level="8.1" data-path="importing-data.html"><a href="importing-data.html#the-rules"><i class="fa fa-check"></i><b>8.1</b> The Rules</a></li>
<li class="chapter" data-level="8.2" data-path="importing-data.html"><a href="importing-data.html#importing-your-text-file"><i class="fa fa-check"></i><b>8.2</b> Importing your Text File</a><ul>
<li class="chapter" data-level="8.2.1" data-path="importing-data.html"><a href="importing-data.html#the-simple-way"><i class="fa fa-check"></i><b>8.2.1</b> The simple way</a></li>
<li class="chapter" data-level="8.2.2" data-path="importing-data.html"><a href="importing-data.html#the-less-simple-way"><i class="fa fa-check"></i><b>8.2.2</b> The less simple way</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="importing-data.html"><a href="importing-data.html#importing-character-data"><i class="fa fa-check"></i><b>8.3</b> Importing character data</a></li>
<li class="chapter" data-level="8.4" data-path="importing-data.html"><a href="importing-data.html#data-on-the-web"><i class="fa fa-check"></i><b>8.4</b> Data on the web</a></li>
<li class="chapter" data-level="8.5" data-path="importing-data.html"><a href="importing-data.html#using-read.table"><i class="fa fa-check"></i><b>8.5</b> Using <code>read.table()</code></a></li>
<li class="chapter" data-level="8.6" data-path="importing-data.html"><a href="importing-data.html#what-to-do-once-youve-managed-to-import-your-data."><i class="fa fa-check"></i><b>8.6</b> What to do once you’ve managed to import your data.</a></li>
<li class="chapter" data-level="8.7" data-path="importing-data.html"><a href="importing-data.html#importing-data-directly-from-excel"><i class="fa fa-check"></i><b>8.7</b> Importing data directly from Excel</a></li>
<li class="chapter" data-level="8.8" data-path="importing-data.html"><a href="importing-data.html#other-data-formats"><i class="fa fa-check"></i><b>8.8</b> Other data formats</a></li>
<li class="chapter" data-level="8.9" data-path="importing-data.html"><a href="importing-data.html#importing-data-into-rstudio"><i class="fa fa-check"></i><b>8.9</b> Importing data into RStudio</a></li>
<li class="chapter" data-level="8.10" data-path="importing-data.html"><a href="importing-data.html#to-attach-or-not-to-attach"><i class="fa fa-check"></i><b>8.10</b> To attach or not to attach?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><i class="fa fa-check"></i><b>9</b> R graphics I — drawing graphs and changing plot symbols and colours using the base graphics system</a><ul>
<li class="chapter" data-level="9.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#base-graphics-versus-ggplot2-versus-lattice-versus-whaaat"><i class="fa fa-check"></i><b>9.1</b> Base graphics versus ggplot2 versus lattice versus whaaat???</a></li>
<li class="chapter" data-level="9.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#base-graphics-example-ufo-reports-again"><i class="fa fa-check"></i><b>9.2</b> Base graphics example: UFO reports again</a></li>
<li class="chapter" data-level="9.3" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#plot-symbols"><i class="fa fa-check"></i><b>9.3</b> Plot symbols</a></li>
<li class="chapter" data-level="9.4" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#colours"><i class="fa fa-check"></i><b>9.4</b> Colours</a></li>
<li class="chapter" data-level="9.5" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#plotting-multiple-symbols-or-colours"><i class="fa fa-check"></i><b>9.5</b> Plotting multiple symbols or colours</a></li>
<li class="chapter" data-level="9.6" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#colour-palettes-in-r"><i class="fa fa-check"></i><b>9.6</b> Colour palettes in R</a></li>
<li class="chapter" data-level="9.7" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#using-transparency-in-your-graphs"><i class="fa fa-check"></i><b>9.7</b> Using transparency in your graphs</a></li>
<li class="chapter" data-level="9.8" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#histograms-and-multiple-plots-in-the-same-window"><i class="fa fa-check"></i><b>9.8</b> Histograms and multiple plots in the same window</a></li>
<li class="chapter" data-level="9.9" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#boxplots"><i class="fa fa-check"></i><b>9.9</b> Boxplots</a></li>
<li class="chapter" data-level="9.10" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#bar-charts"><i class="fa fa-check"></i><b>9.10</b> Bar charts</a><ul>
<li class="chapter" data-level="9.10.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#more-complex-barplots"><i class="fa fa-check"></i><b>9.10.1</b> More complex barplots</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#other-types-of-plot"><i class="fa fa-check"></i><b>9.11</b> Other types of plot</a><ul>
<li class="chapter" data-level="9.11.1" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#histogram-with-overlaid-probability-density-estimate"><i class="fa fa-check"></i><b>9.11.1</b> Histogram with overlaid probability density estimate</a></li>
<li class="chapter" data-level="9.11.2" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#pie-graph"><i class="fa fa-check"></i><b>9.11.2</b> Pie graph</a></li>
<li class="chapter" data-level="9.11.3" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#d-scatterplot"><i class="fa fa-check"></i><b>9.11.3</b> 3D scatterplot</a></li>
<li class="chapter" data-level="9.11.4" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#contour-plot"><i class="fa fa-check"></i><b>9.11.4</b> Contour plot</a></li>
<li class="chapter" data-level="9.11.5" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#the-easy-way"><i class="fa fa-check"></i><b>9.11.5</b> The easy way</a></li>
<li class="chapter" data-level="9.11.6" data-path="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html"><a href="r-graphics-i-drawing-graphs-and-changing-plot-symbols-and-colours-using-the-base-graphics-system.html#the-hard-way"><i class="fa fa-check"></i><b>9.11.6</b> The hard way</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html"><i class="fa fa-check"></i><b>10</b> R graphics II — Adding elements to an existing graph</a><ul>
<li class="chapter" data-level="10.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#simple-regression-lines"><i class="fa fa-check"></i><b>10.1</b> Simple regression lines</a></li>
<li class="chapter" data-level="10.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#multiple-regression-lines"><i class="fa fa-check"></i><b>10.2</b> Multiple regression lines</a></li>
<li class="chapter" data-level="10.3" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#legends"><i class="fa fa-check"></i><b>10.3</b> Legends</a></li>
<li class="chapter" data-level="10.4" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#curves"><i class="fa fa-check"></i><b>10.4</b> Curves</a><ul>
<li class="chapter" data-level="10.4.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-a-curve-using-curve"><i class="fa fa-check"></i><b>10.4.1</b> Adding a curve using <code>curve()</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-a-curve-using-lines-or-points."><i class="fa fa-check"></i><b>10.4.2</b> Adding a curve using <code>lines()</code> or <code>points()</code>.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#text-and-arrows"><i class="fa fa-check"></i><b>10.5</b> Text and arrows</a></li>
<li class="chapter" data-level="10.6" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#confidence-bands-for-fitted-lines"><i class="fa fa-check"></i><b>10.6</b> Confidence bands for fitted lines</a><ul>
<li class="chapter" data-level="10.6.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-confidence-bands-using-lines"><i class="fa fa-check"></i><b>10.6.1</b> Adding confidence bands using <code>lines()</code></a></li>
<li class="chapter" data-level="10.6.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-confidence-intervals-to-fitted-lines-using-polygon"><i class="fa fa-check"></i><b>10.6.2</b> Adding confidence intervals to fitted lines using <code>polygon()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#error-bars"><i class="fa fa-check"></i><b>10.7</b> Error bars</a><ul>
<li class="chapter" data-level="10.7.1" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#adding-error-bars-using-arrows"><i class="fa fa-check"></i><b>10.7.1</b> Adding error bars using <code>arrows()</code></a></li>
<li class="chapter" data-level="10.7.2" data-path="r-graphics-ii-adding-elements-to-an-existing-graph.html"><a href="r-graphics-ii-adding-elements-to-an-existing-graph.html#plotting-means-and-error-bars-using-plotmeans"><i class="fa fa-check"></i><b>10.7.2</b> Plotting means and error bars using <code>plotmeans()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html"><i class="fa fa-check"></i><b>11</b> Basic Statistical Concepts</a><ul>
<li class="chapter" data-level="11.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#populations-and-samples"><i class="fa fa-check"></i><b>11.1</b> Populations and Samples</a></li>
<li class="chapter" data-level="11.2" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#descriptive-and-exploratory-statistics"><i class="fa fa-check"></i><b>11.2</b> Descriptive and exploratory statistics</a><ul>
<li class="chapter" data-level="11.2.1" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#maximum-and-minimum"><i class="fa fa-check"></i><b>11.2.1</b> Maximum and minimum</a></li>
<li class="chapter" data-level="11.2.2" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#frequency-distribution"><i class="fa fa-check"></i><b>11.2.2</b> Frequency distribution</a></li>
<li class="chapter" data-level="11.2.3" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#kinds-of-frequency-distribution"><i class="fa fa-check"></i><b>11.2.3</b> Kinds of frequency distribution</a></li>
<li class="chapter" data-level="11.2.4" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>11.2.4</b> Measures of central tendency</a></li>
<li class="chapter" data-level="11.2.5" data-path="basic-statistical-concepts.html"><a href="basic-statistical-concepts.html#measures-of-dispersion"><i class="fa fa-check"></i><b>11.2.5</b> Measures of dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html"><i class="fa fa-check"></i><b>12</b> What is statistical testing?</a><ul>
<li class="chapter" data-level="12.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#the-problem"><i class="fa fa-check"></i><b>12.1</b> The problem</a></li>
<li class="chapter" data-level="12.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#statistical-testing-in-a-nutshell"><i class="fa fa-check"></i><b>12.2</b> Statistical testing in a nutshell</a><ul>
<li class="chapter" data-level="12.2.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#decide-on-the-null-and-alternative-hypotheses."><i class="fa fa-check"></i><b>12.2.1</b> Decide on the null and alternative hypotheses.</a></li>
<li class="chapter" data-level="12.2.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#calculate-the-size-of-the-effect."><i class="fa fa-check"></i><b>12.2.2</b> Calculate the size of the effect.</a></li>
<li class="chapter" data-level="12.2.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#transform-the-effect-size-so-that-we-can-compare-it-to-an-expected-distribution."><i class="fa fa-check"></i><b>12.2.3</b> Transform the effect size so that we can compare it to an expected distribution.</a></li>
<li class="chapter" data-level="12.2.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#ask-what-the-probability-is-of-observing-an-effect-as-big-or-bigger-than-the-one-we-have-seen-assuming-the-null-hypothesis-to-be-true."><i class="fa fa-check"></i><b>12.2.4</b> Ask what the probability is of observing an effect as big, or bigger than the one we have seen, assuming the null hypothesis to be true.</a></li>
<li class="chapter" data-level="12.2.5" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#think-about-what-the-result-means."><i class="fa fa-check"></i><b>12.2.5</b> Think about what the result means.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#how-a-statistical-test-works"><i class="fa fa-check"></i><b>12.3</b> How a statistical test works</a><ul>
<li class="chapter" data-level="12.3.1" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-1-generating-our-null-and-alternative-hypotheses."><i class="fa fa-check"></i><b>12.3.1</b> Step 1 generating our null and alternative hypotheses.</a></li>
<li class="chapter" data-level="12.3.2" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-2-calculating-the-size-of-the-effect"><i class="fa fa-check"></i><b>12.3.2</b> Step 2 calculating the size of the effect</a></li>
<li class="chapter" data-level="12.3.3" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-3-transforming-the-effect-size-so-that-we-can-compare-it-to-an-expected-distribution."><i class="fa fa-check"></i><b>12.3.3</b> Step 3 Transforming the effect size so that we can compare it to an expected distribution.</a></li>
<li class="chapter" data-level="12.3.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#step-4-what-is-the-probability-is-of-observing-an-effect-as-big-or-bigger-than-the-one-we-have-seen-assuming-the-null-hypothesis-to-be-true"><i class="fa fa-check"></i><b>12.3.4</b> Step 4 What is the probability is of observing an effect as big, or bigger than the one we have seen, assuming the null hypothesis to be true?</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#what-statistical-testing-does-and-doesnt-tell-us"><i class="fa fa-check"></i><b>12.4</b> What statistical testing does and doesn’t tell us</a></li>
<li class="chapter" data-level="12.5" data-path="what-is-statistical-testing.html"><a href="what-is-statistical-testing.html#code-used-to-draw-figure-5"><i class="fa fa-check"></i><b>12.5</b> Code used to draw figure 5</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><i class="fa fa-check"></i><b>13</b> The Chi-squared Test and a Classic Dataset on Smoking and Cancer</a><ul>
<li class="chapter" data-level="13.1" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#are-lung-cancer-patients-who-smoke-more-likely-to-be-heavy-smokers"><i class="fa fa-check"></i><b>13.1</b> Are lung cancer patients who smoke more likely to be heavy smokers?</a></li>
<li class="chapter" data-level="13.2" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#the-chi-squared-test"><i class="fa fa-check"></i><b>13.2</b> The Chi-squared test</a></li>
<li class="chapter" data-level="13.3" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#chi-squared-test-with-contingency-tables"><i class="fa fa-check"></i><b>13.3</b> Chi-squared test with contingency tables</a></li>
<li class="chapter" data-level="13.4" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#assumptions-and-limitations-of-the-chi-squared-test"><i class="fa fa-check"></i><b>13.4</b> Assumptions and limitations of the chi-squared test</a></li>
<li class="chapter" data-level="13.5" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#are-lung-cancer-patients-more-likely-to-be-smokers-than-controls"><i class="fa fa-check"></i><b>13.5</b> Are lung cancer patients more likely to be smokers than controls?</a></li>
<li class="chapter" data-level="13.6" data-path="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html"><a href="the-chi-squared-test-and-a-classic-dataset-on-smoking-and-cancer.html#fishers-exact-test"><i class="fa fa-check"></i><b>13.6</b> Fisher’s exact test</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><i class="fa fa-check"></i><b>14</b> Comparing immune responses between two caterpillar species using a t-test</a><ul>
<li class="chapter" data-level="14.1" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#assumptions-and-limitations-of-standard-parametric-statistics"><i class="fa fa-check"></i><b>14.1</b> Assumptions and limitations of standard parametric statistics</a><ul>
<li class="chapter" data-level="14.1.1" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#normal-errors."><i class="fa fa-check"></i><b>14.1.1</b> Normal errors.</a></li>
<li class="chapter" data-level="14.1.2" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#independence-of-data-points."><i class="fa fa-check"></i><b>14.1.2</b> Independence of data points.</a></li>
<li class="chapter" data-level="14.1.3" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#equal-variances."><i class="fa fa-check"></i><b>14.1.3</b> Equal variances.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#importing-the-data"><i class="fa fa-check"></i><b>14.2</b> Importing the Data</a></li>
<li class="chapter" data-level="14.3" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#descriptives-and-initial-exploration"><i class="fa fa-check"></i><b>14.3</b> Descriptives and Initial Exploration</a></li>
<li class="chapter" data-level="14.4" data-path="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html"><a href="comparing-immune-responses-between-two-caterpillar-species-using-a-t-test.html#comparing-two-means-with-a-t-test"><i class="fa fa-check"></i><b>14.4</b> Comparing Two Means With a t-test</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlation-analysis.html"><a href="correlation-analysis.html"><i class="fa fa-check"></i><b>15</b> Correlation analysis</a><ul>
<li class="chapter" data-level="15.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#calculating-the-correlation-coefficient"><i class="fa fa-check"></i><b>15.1</b> Calculating the correlation coefficient</a><ul>
<li class="chapter" data-level="15.1.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#interpreting-our-correlation-coefficient."><i class="fa fa-check"></i><b>15.1.1</b> Interpreting our correlation coefficient.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="correlation-analysis.html"><a href="correlation-analysis.html#statistical-significance-of-r"><i class="fa fa-check"></i><b>15.2</b> Statistical significance of <em>r</em></a></li>
<li class="chapter" data-level="15.3" data-path="correlation-analysis.html"><a href="correlation-analysis.html#assumptions-of-correlation-analysis"><i class="fa fa-check"></i><b>15.3</b> Assumptions of correlation analysis</a><ul>
<li class="chapter" data-level="15.3.1" data-path="correlation-analysis.html"><a href="correlation-analysis.html#comparing-correlations-between-swim-run-and-bike-splits"><i class="fa fa-check"></i><b>15.3.1</b> Comparing correlations between swim, run and bike splits</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="correlation-analysis.html"><a href="correlation-analysis.html#correlation-causality-sample-size-and-significance."><i class="fa fa-check"></i><b>15.4</b> Correlation, causality, sample size and significance.</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="yeast-sex-and-anova.html"><a href="yeast-sex-and-anova.html"><i class="fa fa-check"></i><b>16</b> Yeast Sex and ANOVA</a><ul>
<li class="chapter" data-level="16.1" data-path="yeast-sex-and-anova.html"><a href="yeast-sex-and-anova.html#analysis-of-variance"><i class="fa fa-check"></i><b>16.1</b> Analysis of Variance</a></li>
<li class="chapter" data-level="16.2" data-path="yeast-sex-and-anova.html"><a href="yeast-sex-and-anova.html#anova-with-more-than-one-factor-and-interactions"><i class="fa fa-check"></i><b>16.2</b> ANOVA with more than one factor and interactions</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="yeast-sexual-selection.html"><a href="yeast-sexual-selection.html"><i class="fa fa-check"></i><b>17</b> Yeast sexual selection</a><ul>
<li class="chapter" data-level="17.1" data-path="yeast-sexual-selection.html"><a href="yeast-sexual-selection.html#understanding-the-coefficients-table"><i class="fa fa-check"></i><b>17.1</b> Understanding the coefficients table</a></li>
<li class="chapter" data-level="17.2" data-path="yeast-sexual-selection.html"><a href="yeast-sexual-selection.html#which-statistical-tests-to-use-with-lm"><i class="fa fa-check"></i><b>17.2</b> Which statistical tests to use with <code>lm()</code>?</a></li>
<li class="chapter" data-level="17.3" data-path="yeast-sexual-selection.html"><a href="yeast-sexual-selection.html#diagnostics"><i class="fa fa-check"></i><b>17.3</b> Diagnostics</a></li>
<li class="chapter" data-level="17.4" data-path="yeast-sexual-selection.html"><a href="yeast-sexual-selection.html#visualising-the-data"><i class="fa fa-check"></i><b>17.4</b> Visualising the data</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><i class="fa fa-check"></i><b>18</b> Using Linear Regression to Analyse TB trends in the UK</a><ul>
<li class="chapter" data-level="18.0.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#least-squares-line-fitting"><i class="fa fa-check"></i><b>18.0.1</b> Least squares line fitting</a></li>
<li class="chapter" data-level="18.0.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#significance-tests-for-linear-regression"><i class="fa fa-check"></i><b>18.0.2</b> Significance tests for linear regression</a></li>
<li class="chapter" data-level="18.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#bovine-tb"><i class="fa fa-check"></i><b>18.1</b> Bovine TB</a></li>
<li class="chapter" data-level="18.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#assumptions-of-linear-regression"><i class="fa fa-check"></i><b>18.2</b> Assumptions of linear regression</a><ul>
<li class="chapter" data-level="18.2.1" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#diagnostic-plots"><i class="fa fa-check"></i><b>18.2.1</b> Diagnostic plots</a></li>
<li class="chapter" data-level="18.2.2" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#diagnostic-plots-for-our-m.bovis-regression"><i class="fa fa-check"></i><b>18.2.2</b> Diagnostic plots for our <em>M.bovis</em> regression</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#interpreting-our-regression-and-predicting-future-cases"><i class="fa fa-check"></i><b>18.3</b> Interpreting our regression and predicting future cases</a></li>
<li class="chapter" data-level="18.4" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#multi-drug-resistant-tb"><i class="fa fa-check"></i><b>18.4</b> Multi-drug resistant TB</a></li>
<li class="chapter" data-level="18.5" data-path="using-linear-regression-to-analyse-tb-trends-in-the-uk.html"><a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html#fitting-a-quadratic-model"><i class="fa fa-check"></i><b>18.5</b> Fitting a quadratic model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory R: A beginner’s guide to programming, data visualisation and statistical analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="yeast-sexual-selection" class="section level1">
<h1><span class="header-section-number">Chapter 17</span> Yeast sexual selection</h1>
<p>For the rest of this chapter we’re going to make a detailed look at how to carry out and interpret a 2-factor ANOVA in R. Firstly we need to run through some background. A fundamental component of the theories underlying our understanding of sexual selection is the assumption that sexual signalling is costly. If the expression of sexual signals like peacock’s tails, stag beetle mandibles or cricket song imposes a cost on the organism producing the signal then “honest signalling”, whereby the signaller does not attempt to pass himself (usually himself anyway) off as being of a higher quality than he actually is, can be maintained. The assumption that these signals are costly has rarely been tested, but in 2010 Carl Smith and Duncan Grieg<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> published a paper describing the effects of sexual signalling on fitness in yeast, <em>Saccharomyces cerevisiae</em>.</p>
<p>Yeast usually reproduces asexually as a diploid organism but occasionally produces haploid offspring by meiosis, and these haploid yeast cells can then either carry on reproducing asexually or fuse with another haploid yeast cell (this is the equivalent of mating) to produce a diploid daughter cell. The haploid yeast cells come in two types, MATa and MATα, which can be thought of as analogous to sexes. Each is attracted towards cells from the other mating type by pheromones which differ between mating types, and each pheromone is encoded by two separate genes which are only expressed in one or the other mating type. The α pheromone, for example, is encoded by genes called MFα1 and MFα2, which are only expressed in MATα cells. Smith and Grieg measured the fitness effects of producing these pheromones by producing yeast strains of both mating types that had either one or both pheromone genes deleted and then allowing them to compete with similar yeast strains that were still expressing both genes. Their results are shown in the following table, which the authors were kind enough to upload to the Dryad Digital Repository (Smith C, Greig D (2010) [Data from: The cost of sexual signalling in yeast.]<a href="http://datadryad.org/resource/doi:10.5061/dryad.1647" class="uri">http://datadryad.org/resource/doi:10.5061/dryad.1647</a> Dryad Digital Repository. <a href="doi:10.5061/dryad.1647" class="uri">doi:10.5061/dryad.1647</a>). This dataframe can also be downloaded from <a href="http://www.introductoryr.co.uk" class="uri">http://www.introductoryr.co.uk</a>.</p>
<!-- html table generated in R 3.6.1 by xtable 1.8-4 package -->
<!-- Sun May  3 06:05:26 2020 -->
<table border="1">
<tr>
<th>
fitness
</th>
<th>
mat
</th>
<th>
knockouts
</th>
</tr>
<tr>
<td align="right">
1.16
</td>
<td>
alpha
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.17
</td>
<td>
alpha
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.39
</td>
<td>
alpha
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.33
</td>
<td>
alpha
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.29
</td>
<td>
alpha
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.41
</td>
<td>
alpha
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.39
</td>
<td>
alpha
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.68
</td>
<td>
alpha
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.31
</td>
<td>
alpha
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.51
</td>
<td>
alpha
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.19
</td>
<td>
a
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.13
</td>
<td>
a
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.08
</td>
<td>
a
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.14
</td>
<td>
a
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.14
</td>
<td>
a
</td>
<td>
one
</td>
</tr>
<tr>
<td align="right">
1.24
</td>
<td>
a
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.24
</td>
<td>
a
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.23
</td>
<td>
a
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.34
</td>
<td>
a
</td>
<td>
two
</td>
</tr>
<tr>
<td align="right">
1.21
</td>
<td>
a
</td>
<td>
two
</td>
</tr>
</table>
<p>Results of viability assays for strains of yeast with one or two pheromone genes knocked out in yeast from Smith and Greig (2010). “Fitness” is the growth rate of the knockout strain divided by the growth rate of a control strain with both pheromone genes expressed, “mat” is the mating type and “knockouts” is the number of pheromone genes knocked out. NB these are the numbers reported by Smith and Greig - you might think about cutting the number of decimal places fitness is reported to if you were doing a similar experiment.</p>
<p>In order to understand the patterns in the yeast data we need to understand how mating type and the number of knockouts affects relative fitness, and we also need to know whether the effect of knocking out the pheromone genes depends on the mating type: in other words, we would like to know if there is an interaction between our two explanatory variables. Both explanatory variables are categorical rather than continuous, so the appropriate analysis here is a two-factor ANOVA. Before we leap straight into analysis, however, we should have a look at our data to give us an idea of what sort of patterns we’re looking at, and also so that we can pick up on any obvious problematic data points.</p>
<p>When we have more than one factor we can draw a useful boxplot by specifying that we want to look at an interaction, like this.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="yeast-sexual-selection.html#cb13-1"></a><span class="kw">boxplot</span>(fitness<span class="op">~</span><span class="kw">interaction</span>(mat,knockouts), <span class="dt">xlab=</span><span class="st">&quot;Strain&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Relative fitness&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:anova6"></span>
<img src="3rd_Edition_files/figure-html/anova6-1.png" alt="Boxplots of fitness for the two mating types with one or two pheromone genes knocked out." width="672" />
<p class="caption">
Figure 17.1: Boxplots of fitness for the two mating types with one or two pheromone genes knocked out.
</p>
</div>
<p>This gives us boxplots for the two one-gene knockout treatments first, and then the two-gene knockouts. We can immediately see that both the number of knockouts and the mating type seem to have an effect on fitness: the two-gene knockout strains have higher relative fitness than one-gene knockout strains, and the MATα strains have a greater response to the knockouts than the MATa strains. There aren’t any obvious serious outlying data points that might cause problems, and given that we only have a sample size of five the shape of the frequency distribution of the data for each treatment combination is fine - the individual boxplots are roughly symmetrical, and that’s about as good as we’re likely to get given the sample size.</p>
<p>One noticeable pattern that is a bit of a worry is that the variances seem to be different between the two mating types: the spread of the data is much greater for the two MATα treatments than for the two MATa ones. We can confirm this by calculating the variances.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="yeast-sexual-selection.html#cb14-1"></a><span class="kw">tapply</span>(fitness, mat, var)</span>
<span id="cb14-2"><a href="yeast-sexual-selection.html#cb14-2"></a>        a     alpha </span>
<span id="cb14-3"><a href="yeast-sexual-selection.html#cb14-3"></a><span class="fl">0.0053685</span> <span class="fl">0.0234588</span> </span></code></pre></div>
<p>As everyone learns in their undergraduate statistics course, one of the assumptions of ANOVA is that variances are equal between treatments, but here they’re not. Do we need to worry about this? Well, one thing we also know is that ANOVA is generally quite robust to violations of these assumptions, especially if the other assumptions of the analysis are met. Given that we have equal sample sizes for all treatments and that the error distribution looks OK my thinking here is that we should go ahead with the analysis anyway, and then decide whether we have a problem on the basis of how the diagnostic plots for the analysis look and also how marginal the results are.</p>
<p>If we want to carry out an ANOVA in R then we have a couple of options. There is a dedicated function called <code>aov()</code>, which does ANOVA and nothing else, or we can use the <code>lm()</code> function which, as we’ve seen, fits a linear model. In fact, the <code>aov()</code> function carries out exactly the same calculations as the <code>lm()</code> function and the main difference between the two is the way the output is displayed. Let’s start with <code>aov()</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="yeast-sexual-selection.html#cb15-1"></a>yeast.aov&lt;-<span class="kw">aov</span>(fitness <span class="op">~</span><span class="st"> </span>mat<span class="op">*</span>knockouts)</span></code></pre></div>
<p>We’ve set up an object called yeast.aov which contains the output from the <code>aov()</code> function specified. To tell <code>aov()</code> exactly what we want it to analyse we’ve used a formula in the same way as we did for the t-test and linear regression examples earlier, with a response variable on the left, then a tilda (~) and then our predictor variables. Because we’re doing a two-factor ANOVA this time we’ve specified two predictor variables and we’ve used an asterisk to connect them. We could instead have written “fitness~mat+knockouts” but that would only have carried out an ANOVA with the main effects of mat and knockouts: the asterisk tells R to fit the main effects and all the interaction terms between the predictor variables specified.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="yeast-sexual-selection.html#cb16-1"></a><span class="kw">summary</span>(yeast.aov)</span>
<span id="cb16-2"><a href="yeast-sexual-selection.html#cb16-2"></a>              Df Sum Sq Mean Sq F value  <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </span>
<span id="cb16-3"><a href="yeast-sexual-selection.html#cb16-3"></a>mat            <span class="dv">1</span> <span class="fl">0.1451</span>  <span class="fl">0.1451</span>   <span class="fl">17.34</span> <span class="fl">0.00073</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb16-4"><a href="yeast-sexual-selection.html#cb16-4"></a>knockouts      <span class="dv">1</span> <span class="fl">0.1179</span>  <span class="fl">0.1179</span>   <span class="fl">14.09</span> <span class="fl">0.00173</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb16-5"><a href="yeast-sexual-selection.html#cb16-5"></a>mat<span class="op">:</span>knockouts  <span class="dv">1</span> <span class="fl">0.0077</span>  <span class="fl">0.0077</span>    <span class="fl">0.93</span> <span class="fl">0.35030</span>    </span>
<span id="cb16-6"><a href="yeast-sexual-selection.html#cb16-6"></a>Residuals     <span class="dv">16</span> <span class="fl">0.1338</span>  <span class="fl">0.0084</span>                    </span>
<span id="cb16-7"><a href="yeast-sexual-selection.html#cb16-7"></a><span class="op">---</span></span>
<span id="cb16-8"><a href="yeast-sexual-selection.html#cb16-8"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span></code></pre></div>
<p>Using the <code>summary()</code> function then gives us a traditional ANOVA table, and we have significant effects of both mating type and the number of pheromone genes knocked out, but no significant interaction term: the effect of the number of knockouts doesn’t depend on the mating type.
Let’s repeat the analysis but this time using <code>lm()</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="yeast-sexual-selection.html#cb17-1"></a>yeast.lm&lt;-<span class="kw">lm</span>(fitness <span class="op">~</span><span class="st"> </span>mat<span class="op">*</span>knockouts)</span></code></pre></div>
<p>This is exactly the same as for the <code>aov()</code> call, except the name of the function is different.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="yeast-sexual-selection.html#cb18-1"></a><span class="kw">summary</span>(yeast.lm)</span>
<span id="cb18-2"><a href="yeast-sexual-selection.html#cb18-2"></a></span>
<span id="cb18-3"><a href="yeast-sexual-selection.html#cb18-3"></a>Call<span class="op">:</span></span>
<span id="cb18-4"><a href="yeast-sexual-selection.html#cb18-4"></a><span class="kw">lm</span>(<span class="dt">formula =</span> fitness <span class="op">~</span><span class="st"> </span>mat <span class="op">*</span><span class="st"> </span>knockouts)</span>
<span id="cb18-5"><a href="yeast-sexual-selection.html#cb18-5"></a></span>
<span id="cb18-6"><a href="yeast-sexual-selection.html#cb18-6"></a>Residuals<span class="op">:</span></span>
<span id="cb18-7"><a href="yeast-sexual-selection.html#cb18-7"></a><span class="st">     </span>Min       1Q   Median       3Q      Max </span>
<span id="cb18-8"><a href="yeast-sexual-selection.html#cb18-8"></a><span class="fl">-0.14737</span> <span class="fl">-0.05416</span> <span class="fl">-0.00805</span>  <span class="fl">0.05052</span>  <span class="fl">0.21830</span> </span>
<span id="cb18-9"><a href="yeast-sexual-selection.html#cb18-9"></a></span>
<span id="cb18-10"><a href="yeast-sexual-selection.html#cb18-10"></a>Coefficients<span class="op">:</span></span>
<span id="cb18-11"><a href="yeast-sexual-selection.html#cb18-11"></a><span class="st">                      </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb18-12"><a href="yeast-sexual-selection.html#cb18-12"></a>(Intercept)             <span class="fl">1.1367</span>     <span class="fl">0.0409</span>   <span class="fl">27.79</span>  <span class="fl">5.7e-15</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb18-13"><a href="yeast-sexual-selection.html#cb18-13"></a>matalpha                <span class="fl">0.1310</span>     <span class="fl">0.0578</span>    <span class="fl">2.26</span>    <span class="fl">0.038</span> <span class="op">*</span><span class="st">  </span></span>
<span id="cb18-14"><a href="yeast-sexual-selection.html#cb18-14"></a>knockoutstwo            <span class="fl">0.1142</span>     <span class="fl">0.0578</span>    <span class="fl">1.97</span>    <span class="fl">0.066</span> .  </span>
<span id="cb18-15"><a href="yeast-sexual-selection.html#cb18-15"></a>matalpha<span class="op">:</span>knockoutstwo   <span class="fl">0.0787</span>     <span class="fl">0.0818</span>    <span class="fl">0.96</span>    <span class="fl">0.350</span>    </span>
<span id="cb18-16"><a href="yeast-sexual-selection.html#cb18-16"></a><span class="op">---</span></span>
<span id="cb18-17"><a href="yeast-sexual-selection.html#cb18-17"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb18-18"><a href="yeast-sexual-selection.html#cb18-18"></a></span>
<span id="cb18-19"><a href="yeast-sexual-selection.html#cb18-19"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.0915</span> on <span class="dv">16</span> degrees of freedom</span>
<span id="cb18-20"><a href="yeast-sexual-selection.html#cb18-20"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.669</span>, Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.607</span> </span>
<span id="cb18-21"><a href="yeast-sexual-selection.html#cb18-21"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">10.8</span> on <span class="dv">3</span> and <span class="dv">16</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">0.000402</span></span></code></pre></div>
<p>The summary function gives us a lot more output with <code>lm()</code> than with <code>aov()</code>, and the output is rather different. We don’t get an ANOVA table: instead we get a table of estimated coefficients with a p-value calculated for each one. This table is quite complicated to interpret and the p-values are not the same as the p-values we get from <code>aov()</code>. If you recall the the chapter on analysing TB data we have already seen a similar difference in p-values when comparing the output from <code>summary()</code> with the output from anova().</p>
<div id="understanding-the-coefficients-table" class="section level2">
<h2><span class="header-section-number">17.1</span> Understanding the coefficients table</h2>
<p>Looking back at the table we get from the <code>summary()</code> function, you might have noticed that there isn’t a traditional ANOVA table there, but there is a rather different and somewhat cryptic table labelled “coefficients”. This is one of the most important things to understand, but also not simple to master. I’ll try to explain how it works here.</p>
<p>The names of the rows associated with each coefficient might look a bit strange to you. We have an intercept, which you will be familiar with from regression but you might not have encountered in the context of an ANOVA before. Then we have a row called “matalpha”, which is the name of one of our factors and the name of one of its levels stuck together, then “knockoutstwo”: again a factor name and the name of one of its levels. Finally we get “matalpha:knockoutstwo”, both of the previous row names separated by a colon. Understanding where these names come from and what they mean is crucial to understanding this table and it is important if you want to go on to fit other models using R. They represent something called “treatment contrasts”, which are a way of showing the how the fitted model describes the patterns in the data. If you have the estimates from the treatment contrasts it’s possible to work out the predicted value for any combination of factors, continuous predictors and interactions. This is how they work.</p>
<p>Firstly, the intercept. In a simple linear regression this is exactly what it says on the tin. In the case of this ANOVA there’s not a y-intercept in the same sense as you get when there is a fitted line, and this intercept is in fact an estimated mean, or predicted value, for one of the combinations of factor levels in the analysis. More specifically, when you have a model that has one or more categorical factors but no continuous variable as predictors then the intercept is the estimated mean for the combination of factor levels that are assigned the lowest values by R. This is now getting even more confusing because these factor levels aren’t numbers, they’re “a” and “alpha” for factor “mat” and “one” and “two” for factor “knockouts”, so how can one have a lower value than the other, especially the first two?</p>
<p>What you need to know to understand what’s going on here is that R does in fact assign numbers to each level of a factor, and it assigns them in alphabetical order within each factor, so the factor level that comes first in alphabetical order is assigned “1”, the second “2” and so on. You don’t see these answers unless you ask but they’re there all the same.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="yeast-sexual-selection.html#cb19-1"></a><span class="kw">as.numeric</span>(mat)</span>
<span id="cb19-2"><a href="yeast-sexual-selection.html#cb19-2"></a> [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span></span>
<span id="cb19-3"><a href="yeast-sexual-selection.html#cb19-3"></a><span class="kw">as.numeric</span>(knockouts)</span>
<span id="cb19-4"><a href="yeast-sexual-selection.html#cb19-4"></a> [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span></span></code></pre></div>
<p>You can see that the first 10 data points for “mat” have been given the number 2. These are the ones that are in the data frame as “alpha”, which comes after “a” in the alphabet. The second 10 data points correspond to “a” and have been given number 1. In the case of “knockouts”, the factor level “one” has had the number 1 assigned and the factor level “two” has the value 2. This is purely because of where the words come in alphabetical order and the assignment of the correct number to each word is merely serendipity.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="yeast-sexual-selection.html#cb20-1"></a>temp1&lt;-<span class="kw">c</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;three&quot;</span>)</span>
<span id="cb20-2"><a href="yeast-sexual-selection.html#cb20-2"></a>temp1&lt;-<span class="kw">factor</span>(temp1)</span>
<span id="cb20-3"><a href="yeast-sexual-selection.html#cb20-3"></a><span class="kw">as.numeric</span>(temp1)</span>
<span id="cb20-4"><a href="yeast-sexual-selection.html#cb20-4"></a>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span></span></code></pre></div>
<p>In this example the word “two” has been assigned the number 3 because it comes after the word “three” in alphabetical order. “Three” has been assigned the number “two”. It’s alphabetical order and nothing else. Hopefully that’s clarified everything.</p>
<p>Back to the coefficients table. The intercept in this case is the estimated mean from the fitted anova for the combination of factor levels where both factors have the lowest assigned value. In this case that’s “a” (=1) for factor “mat” and “one” (=1) for factor “knockout”, so the row of the table called “intercept” gives us the estimated mean value for replicates with mating type a and one knockout. This is the “predicted value” for this combination of factor levels, in other words the value that we would predict from the model for a data point with these factor levels.</p>
<p>Here’s the coefficients table again</p>
<pre><code>                      Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept)           1.136688   0.040900 27.79171 5.7034e-15
matalpha              0.130987   0.057842  2.26458 3.7781e-02
knockoutstwo          0.114191   0.057842  1.97420 6.5880e-02
matalpha:knockoutstwo 0.078702   0.081801  0.96212 3.5030e-01</code></pre>
<p>Because we’re fitting a full model including an interaction term the predicted value for the Intercept is the same as the mean value for that combination of factor levels (mat=a and knockout=one)if we calculate it directly.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="yeast-sexual-selection.html#cb22-1"></a><span class="kw">mean</span>(fitness[mat<span class="op">==</span><span class="st">&quot;a&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knockouts<span class="op">==</span><span class="st">&quot;one&quot;</span>])</span>
<span id="cb22-2"><a href="yeast-sexual-selection.html#cb22-2"></a>[<span class="dv">1</span>] <span class="fl">1.1367</span></span></code></pre></div>
<p>The t value calculated for this particular predicted value is simply calculated by dividing the estimate by the standard error, and the p-value associated with it gives us the helpful information that our mean fitness for this combination of factor levels is significantly different from zero.</p>
<p>Now that we know what the “intercept” row means, what about the next row?</p>
<p>The name of the row is “matalpha”, so it’s referring to the “alpha” level of the factor “mat”. No information about the level of “knockouts” it’s referring to though - it’s simply assumed that you know how these tables work. What this row tells us is the change in predicted value relative to the intercept that is a consequence of changing from the “a” factor level to the “alpha” factor level. In other words the value of the estimate here is a measure of the size of the main effect associated with the “mat” factor, so when we change from mating type a to mating type alpha the relative fitness increases, on average, by 0.13. We can work out the predicted value for the one knockout, mating type alpha combination of factors by adding this estimate to that of the intercept.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="yeast-sexual-selection.html#cb23-1"></a><span class="fl">1.13669+0.13099</span></span>
<span id="cb23-2"><a href="yeast-sexual-selection.html#cb23-2"></a>[<span class="dv">1</span>] <span class="fl">1.2677</span></span></code></pre></div>
<p>We can check this by comparing it with the mean calculated just from these data for the measurements made on yeast with mating type alpha and one knockout:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="yeast-sexual-selection.html#cb24-1"></a><span class="kw">mean</span>(fitness[mat<span class="op">==</span><span class="st">&quot;alpha&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knockouts<span class="op">==</span><span class="st">&quot;one&quot;</span>])</span>
<span id="cb24-2"><a href="yeast-sexual-selection.html#cb24-2"></a>[<span class="dv">1</span>] <span class="fl">1.2677</span></span></code></pre></div>
<p>We saw earlier that the p-value for the intercept tells us if the predicted value for the specific combination of factor levels that is defined as the intercept is different from zero. Because what we’ve estimated here is the change in predicted value, rather than the absolute predicted value, the t-test that we get for this row tells us not if the predicted value for one knockout and mating type alpha is different from zero, but rather whether the change in predicted value associated with changing from mating type a to mating type alpha is significantly different from zero. Looking at it another way, <em>it tells us if the predicted mean value for this factor level combination is significantly different from the intercept</em>. This is a bit more useful than the p-value for the intercept because it gives us a rough test of whether the effect of the change in factor levels is significant, but I emphasise that it’s a rough test and you should only use it as a guide. There’s more to come on which statistical tests should actually be used after we’ve finished deciphering the coefficients table.</p>
<p>Now let’s go on to the next row. This row is called “knockoutstwo”, and in the same way that the “matalpha” row gives us the estimate of the main effect of mating type, this gives us an estimate of the main effect of the number of knockouts - in other words, as we change from one knockout to two knockouts, we estimate that the relative fitness increases by 0.11. As before we can work out the predicted value, which is the mean for mating type a and two knockouts by adding this estimate to the intercept.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="yeast-sexual-selection.html#cb25-1"></a><span class="fl">1.13669+0.11419</span></span>
<span id="cb25-2"><a href="yeast-sexual-selection.html#cb25-2"></a>[<span class="dv">1</span>] <span class="fl">1.2509</span></span></code></pre></div>
<p>This is once again the same as the estimate for the simple mean for this factor combination.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="yeast-sexual-selection.html#cb26-1"></a><span class="kw">mean</span>(fitness[mat<span class="op">==</span><span class="st">&quot;a&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knockouts<span class="op">==</span><span class="st">&quot;two&quot;</span>])</span>
<span id="cb26-2"><a href="yeast-sexual-selection.html#cb26-2"></a>[<span class="dv">1</span>] <span class="fl">1.2509</span></span></code></pre></div>
<p>We now know what the effects of both mating type and the number of knockouts is, so what’s the last row of the summary table there for? Here is the table again:</p>
<pre><code>                      Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept)           1.136688   0.040900 27.79171 5.7034e-15
matalpha              0.130987   0.057842  2.26458 3.7781e-02
knockoutstwo          0.114191   0.057842  1.97420 6.5880e-02
matalpha:knockoutstwo 0.078702   0.081801  0.96212 3.5030e-01</code></pre>
<p>The last row, which is called “matalpha:knockoutstwo” is the effect of the interaction between the two factors. If you recall, we specified a model with interaction terms, and this is the estimate of the extra change in relative fitness that arises when we have mating type alpha and two knockouts, over and above the change in relative fitness form the main effects of the two factors. To calculate the estimated mean (in other words, the predicted value from the model) for this last factor combination we need to add the intercept, the main effects of both factors and the extra from the interaction term together.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="yeast-sexual-selection.html#cb28-1"></a><span class="fl">1.13669+0.13099+0.11419+0.07870</span></span>
<span id="cb28-2"><a href="yeast-sexual-selection.html#cb28-2"></a>[<span class="dv">1</span>] <span class="fl">1.4606</span></span></code></pre></div>
<p>Which is the same as the mean for that factor combination calculated separately.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="yeast-sexual-selection.html#cb29-1"></a><span class="kw">mean</span>(fitness[mat<span class="op">==</span><span class="st">&quot;alpha&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knockouts<span class="op">==</span><span class="st">&quot;two&quot;</span>])</span>
<span id="cb29-2"><a href="yeast-sexual-selection.html#cb29-2"></a>[<span class="dv">1</span>] <span class="fl">1.4606</span></span></code></pre></div>
<p>Now you hopefully have an idea of how these tables of coefficients work. The intercept is the estimated value for the first factor level for each factor, then you get the main effects and then the interaction terms, and you can calculate a predicted value for each combination. One thing to note is that the predicted values will only tally with the directly calculated mean values if you have a fully factorial model - otherwise the estimates will differ somewhat. Here’s that summary table again with everything annotated.</p>
<div class="figure">
<img src="Yeast.coefficients.png" alt="" />
<p class="caption">Annotated coefficients table</p>
</div>
<hr />
</div>
<div id="which-statistical-tests-to-use-with-lm" class="section level2">
<h2><span class="header-section-number">17.2</span> Which statistical tests to use with <code>lm()</code>?</h2>
<p>We’ve seen earlier in this chapter that when we use the <code>summary()</code> function on an object that was the results of an analysis carried out with the <code>aov()</code> function we get a traditional ANOVA table, but when we use <code>summary()</code> on an object that is the output from a fitted model made using <code>lm()</code> we get p-values that are calculated for the effects estimated in the coefficients table. As I suggested earlier, there are a variety of reasons why you shouldn’t use these as a guide to which explanatory variables are significant: they are a useful indication of where the important effects can be found in the model but they are not reliable indicators of whether a variable is significant. If nothing else, when you have a factor with more than two levels you’ll get more than one separate p-value, one for each of the factor levels that isn’t included in the intercept. If you want to know the statistical significance of an explanatory variable and you’ve done an analysis of variance using <code>lm()</code>, you can get a nice ANOVA table from the fitted <code>lm()</code> model by using the anova() function^2.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="yeast-sexual-selection.html#cb30-1"></a><span class="kw">anova</span>(yeast.lm)</span>
<span id="cb30-2"><a href="yeast-sexual-selection.html#cb30-2"></a>Analysis of Variance Table</span>
<span id="cb30-3"><a href="yeast-sexual-selection.html#cb30-3"></a></span>
<span id="cb30-4"><a href="yeast-sexual-selection.html#cb30-4"></a>Response<span class="op">:</span><span class="st"> </span>fitness</span>
<span id="cb30-5"><a href="yeast-sexual-selection.html#cb30-5"></a>              Df Sum Sq Mean Sq F value  <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </span>
<span id="cb30-6"><a href="yeast-sexual-selection.html#cb30-6"></a>mat            <span class="dv">1</span> <span class="fl">0.1451</span>  <span class="fl">0.1451</span>   <span class="fl">17.34</span> <span class="fl">0.00073</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb30-7"><a href="yeast-sexual-selection.html#cb30-7"></a>knockouts      <span class="dv">1</span> <span class="fl">0.1179</span>  <span class="fl">0.1179</span>   <span class="fl">14.09</span> <span class="fl">0.00173</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb30-8"><a href="yeast-sexual-selection.html#cb30-8"></a>mat<span class="op">:</span>knockouts  <span class="dv">1</span> <span class="fl">0.0077</span>  <span class="fl">0.0077</span>    <span class="fl">0.93</span> <span class="fl">0.35030</span>    </span>
<span id="cb30-9"><a href="yeast-sexual-selection.html#cb30-9"></a>Residuals     <span class="dv">16</span> <span class="fl">0.1338</span>  <span class="fl">0.0084</span>                    </span>
<span id="cb30-10"><a href="yeast-sexual-selection.html#cb30-10"></a><span class="op">---</span></span>
<span id="cb30-11"><a href="yeast-sexual-selection.html#cb30-11"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span></code></pre></div>
<p>That is identical to the table we got from the <code>aov()</code> function except some of the numbers are reported to more decimal places. Which function, then, should you use to carry out a straightforward ANOVA? I would recommend using <code>lm()</code> for the simple reason that an ANOVA really is just a small subset of the general linear model, and thinking about it as a model fitting exercise is probably a better way to approach the analysis than thinking about ANOVA as a separate, special kind of statistical test. The only thing that I know of that you can do if you use <code>aov()</code> that you can’t do if you use <code>lm()</code> is post-hoc testing using something like a Tukey’s HSD test (use the <code>TukeyHSD()</code> function on your fitted <code>aov()</code> object). Post-hoc testing is a very blunt instrument, however, and I think that most people nowadays would recommend looking at effect sizes and estimates of coefficients to help you interpret your data in most cases, and this is easier to do with an <code>lm()</code> fit.</p>
</div>
<div id="diagnostics" class="section level2">
<h2><span class="header-section-number">17.3</span> Diagnostics</h2>
<p>We met the concept of diagnostic plots in chapter 11. The assumptions we make about our data are the same for ANOVA and as they are for regression (independence of data points, normal errors, homogeneous variances) with the exception of linearity which isn’t an issue here because we’re dealing with means rather than lines. We can bring up a set of diagnostic plots using the <code>plot()</code> function in the samw way that we did for our regression models earlier: as we’ve seen earlier the output of <code>plot()</code> depends on what you put into it, and if we ask it to plot a model fitted with <code>aov()</code> or <code>lm()</code> it brings us a nice set of four diagnostic plots. Once again, the ones that we really need to look at here are the first two: a plot of fitted values vs residuals and a qq-plot.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="yeast-sexual-selection.html#cb31-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb31-2"><a href="yeast-sexual-selection.html#cb31-2"></a><span class="kw">plot</span>(yeast.lm, <span class="dt">which=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</span></code></pre></div>
<div class="figure"><span id="fig:anova8"></span>
<img src="3rd_Edition_files/figure-html/anova8-1.png" alt="Diagnostic plots for our fitted ANOVA. Fitted values versus residuals on the left and a qq-plot on the right." width="768" />
<p class="caption">
Figure 17.2: Diagnostic plots for our fitted ANOVA. Fitted values versus residuals on the left and a qq-plot on the right.
</p>
</div>
<p>￼
On the right, our qq-plot which lets us assess whether our errors are normally distributed. The straightforward answer is “yes” - the points are almost all on the line. Point 8 is a little far from it but not a huge distance and it’s the only one, so I wouldn’t worry too much about that. On the left, however, our plot of residual values vs fitted values is a bit of a worry. It’s showing the classical fan shape that you get when your data are (that big word again) heteroscedastic: the variance is increasing with the fitted values, which in this case are the four estimated means. This is because of the differences in variance we noted earlier. Can we do anything about this? Well, the traditional thing to do when you have a pattern like this is to beat your data with a log-transformation in the hope of making things look nicer. What happens when we do that?</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="yeast-sexual-selection.html#cb32-1"></a>yeast.lm.log&lt;-<span class="kw">lm</span>(<span class="kw">log</span>(fitness) <span class="op">~</span><span class="st"> </span>mat<span class="op">*</span>knockouts)</span></code></pre></div>
<p>Sets up a new object with the analysis carried out on log-transformed data.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="yeast-sexual-selection.html#cb33-1"></a><span class="kw">anova</span>(yeast.lm.log)</span>
<span id="cb33-2"><a href="yeast-sexual-selection.html#cb33-2"></a>Analysis of Variance Table</span>
<span id="cb33-3"><a href="yeast-sexual-selection.html#cb33-3"></a></span>
<span id="cb33-4"><a href="yeast-sexual-selection.html#cb33-4"></a>Response<span class="op">:</span><span class="st"> </span><span class="kw">log</span>(fitness)</span>
<span id="cb33-5"><a href="yeast-sexual-selection.html#cb33-5"></a>              Df Sum Sq Mean Sq F value  <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </span>
<span id="cb33-6"><a href="yeast-sexual-selection.html#cb33-6"></a>mat            <span class="dv">1</span> <span class="fl">0.0839</span>  <span class="fl">0.0839</span>   <span class="fl">19.06</span> <span class="fl">0.00048</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb33-7"><a href="yeast-sexual-selection.html#cb33-7"></a>knockouts      <span class="dv">1</span> <span class="fl">0.0697</span>  <span class="fl">0.0697</span>   <span class="fl">15.83</span> <span class="fl">0.00108</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb33-8"><a href="yeast-sexual-selection.html#cb33-8"></a>mat<span class="op">:</span>knockouts  <span class="dv">1</span> <span class="fl">0.0025</span>  <span class="fl">0.0025</span>    <span class="fl">0.57</span> <span class="fl">0.46076</span>    </span>
<span id="cb33-9"><a href="yeast-sexual-selection.html#cb33-9"></a>Residuals     <span class="dv">16</span> <span class="fl">0.0705</span>  <span class="fl">0.0044</span>                    </span>
<span id="cb33-10"><a href="yeast-sexual-selection.html#cb33-10"></a><span class="op">---</span></span>
<span id="cb33-11"><a href="yeast-sexual-selection.html#cb33-11"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span></code></pre></div>
<p>Looking at the ANOVA table there’s no real change when we use log-transformed data. The two main effects are still highly significant, and the interaction term is nowhere near significance. What about the diagnostic plots?</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="yeast-sexual-selection.html#cb34-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb34-2"><a href="yeast-sexual-selection.html#cb34-2"></a><span class="kw">plot</span>(yeast.lm.log, <span class="dt">which=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</span></code></pre></div>
<div class="figure"><span id="fig:anova9"></span>
<img src="3rd_Edition_files/figure-html/anova9-1.png" alt="Diagnostic plots for the ANOVA performed on log-transformed data." width="768" />
<p class="caption">
Figure 17.3: Diagnostic plots for the ANOVA performed on log-transformed data.
</p>
</div>
<p>The residuals vs fitted values plot is maybe a bit better but the problem’s still there. Since the log transformation hasn’t fixed the problem, what are our options? There are several things we can do here.</p>
<ol style="list-style-type: decimal">
<li>We could use a different transformation: perhaps we could try an inverse transformation, or a Box-Cox transformation, or something, until we found a way of bashing our data into conforming.</li>
<li>We could use a non-parametric analysis that makes no assumptions about the distribution of the data - perhaps something like a Kruskal-Wallis test. Not ideal because the sample size is small and non-parametric tests aren’t as powerful as parametric ones.</li>
<li>We could use a model that makes different assumptions about the error distribution and that works well with heteroscedastic data. Maybe a generalized linear model with something like gamma errors would be OK. This is arguably the best option but it could get quite complicated quite quickly.</li>
<li>We can remember that, as we noted before, ANOVA is quite robust to violations of its assumptions, we can note that the results of the analysis are clear and neither complicated nor marginal, and we can stick with the original ANOVA.</li>
</ol>
<p>In this case, my vote would go for the fourth option. We always have to remember that the purpose of statistical analysis is to help us understand the patterns in the data: the analysis is a means to an end, and not an end in itself. We could spend a while fitting a generalized linear model with the right error distribution, but would it tell us anything different from the ANOVA? Almost certainly not, so let’s stick with the simpler option.</p>
<hr />
</div>
<div id="visualising-the-data" class="section level2">
<h2><span class="header-section-number">17.4</span> Visualising the data</h2>
<p>What’s left? We could do with drawing a publication-standard graph illustrating the results, and summarising what we’ve found out. A bar plot with 95% confidence intervals is the sort of plot that you’d expect to see in a conference talk or a research paper describing these data. We need to start by setting up a matrix of means.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="yeast-sexual-selection.html#cb35-1"></a>yeast.mat&lt;-<span class="kw">tapply</span>(fitness, <span class="kw">list</span>(mat, knockouts), mean)</span>
<span id="cb35-2"><a href="yeast-sexual-selection.html#cb35-2"></a>yeast.mat</span>
<span id="cb35-3"><a href="yeast-sexual-selection.html#cb35-3"></a>         one    two</span>
<span id="cb35-4"><a href="yeast-sexual-selection.html#cb35-4"></a>a     <span class="fl">1.1367</span> <span class="fl">1.2509</span></span>
<span id="cb35-5"><a href="yeast-sexual-selection.html#cb35-5"></a>alpha <span class="fl">1.2677</span> <span class="fl">1.4606</span></span></code></pre></div>
<p>Now we need to know the 95% confidence intervals. These are calculated as:</p>
<p><img src="Ch12eqn2.png" width="15%" height="15%" /></p>
<p>Where <em>x̄</em> is the mean, <em>σ</em> is the sample standard deviation, <em>N</em> is the sample size and <em>t</em> is the critical value of <em>t</em> at <em>N-1</em> degrees of freedom.</p>
<p>We can start with a matrix of standard deviations.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="yeast-sexual-selection.html#cb36-1"></a>yeast.sd&lt;-<span class="kw">tapply</span>(fitness, <span class="kw">list</span>(mat, knockouts), sd)</span>
<span id="cb36-2"><a href="yeast-sexual-selection.html#cb36-2"></a>yeast.sd</span>
<span id="cb36-3"><a href="yeast-sexual-selection.html#cb36-3"></a>           one      two</span>
<span id="cb36-4"><a href="yeast-sexual-selection.html#cb36-4"></a>a     <span class="fl">0.039542</span> <span class="fl">0.048639</span></span>
<span id="cb36-5"><a href="yeast-sexual-selection.html#cb36-5"></a>alpha <span class="fl">0.098654</span> <span class="fl">0.140694</span></span></code></pre></div>
<p>We can multiply the matrix by the square root of 5, which will give us the standard errors for each mean.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="yeast-sexual-selection.html#cb37-1"></a>yeast.se&lt;-yeast.sd<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb37-2"><a href="yeast-sexual-selection.html#cb37-2"></a>yeast.se</span>
<span id="cb37-3"><a href="yeast-sexual-selection.html#cb37-3"></a>           one      two</span>
<span id="cb37-4"><a href="yeast-sexual-selection.html#cb37-4"></a>a     <span class="fl">0.017684</span> <span class="fl">0.021752</span></span>
<span id="cb37-5"><a href="yeast-sexual-selection.html#cb37-5"></a>alpha <span class="fl">0.044119</span> <span class="fl">0.062920</span></span></code></pre></div>
<p>Now we need to know the critical value of t at 4df. R will tell us this if we ask it nicely.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="yeast-sexual-selection.html#cb38-1"></a><span class="kw">qt</span>(<span class="fl">0.025</span>,<span class="dv">4</span>)</span>
<span id="cb38-2"><a href="yeast-sexual-selection.html#cb38-2"></a>[<span class="dv">1</span>] <span class="fl">-2.7764</span></span></code></pre></div>
<p>To get the 95% confidence intervals now we just need to multiply the standard errors by 2.776.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="yeast-sexual-selection.html#cb39-1"></a>yeast<span class="fl">.95</span>s&lt;-yeast.se<span class="op">*</span><span class="fl">2.776</span></span>
<span id="cb39-2"><a href="yeast-sexual-selection.html#cb39-2"></a>yeast<span class="fl">.95</span>s</span>
<span id="cb39-3"><a href="yeast-sexual-selection.html#cb39-3"></a>          one      two</span>
<span id="cb39-4"><a href="yeast-sexual-selection.html#cb39-4"></a>a     <span class="fl">0.04909</span> <span class="fl">0.060383</span></span>
<span id="cb39-5"><a href="yeast-sexual-selection.html#cb39-5"></a>alpha <span class="fl">0.12248</span> <span class="fl">0.174666</span></span></code></pre></div>
<p>Now we can draw our bar plot using the same approach that you saw in the graphs section. We’ll need to use arrows() to draw in the confidence intervals. Here’s the script I used:</p>
<p>First of all, set up a matrix with the locations of the centres of the bars for use in drawing the error bars.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="yeast-sexual-selection.html#cb40-1"></a>locations&lt;-<span class="kw">barplot</span>(yeast.mat,<span class="dt">beside=</span>T)</span></code></pre></div>
<p>Now draw the barplot. Note that I’ve specified the colours of the columns because the default options are a bit dark and make it hard to see the error bars. I’ve used “expression()” and “paste()” in the legend.text argument to put a greek letter in the mating type name, and I’ve used the args.legend= argument to put the legend in the top left corner without a box around it. I’ve cancelled the x-axis so that I can put in a new one with labels with capital letters, and I’ve made the axis labels and the text. on the axes bold (font=2)</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="yeast-sexual-selection.html#cb41-1"></a><span class="kw">barplot</span>(yeast.mat,<span class="dt">beside=</span>T,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;white&quot;</span>),<span class="dt">legend.text=</span><span class="kw">c</span>(<span class="st">&quot;MATa&quot;</span>,<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;MAT&quot;</span>,alpha))),<span class="dt">args.legend=</span><span class="kw">list</span>(<span class="dt">x=</span><span class="st">&quot;topleft&quot;</span>,<span class="dt">bty=</span><span class="st">&quot;n&quot;</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.8</span>),<span class="dt">ylab=</span><span class="st">&quot;Relative fitness&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Number of pheromone gene knockouts&quot;</span>,<span class="dt">font.lab=</span><span class="dv">2</span>,<span class="dt">font.axis=</span><span class="dv">2</span>,<span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p>Next draw the x-axis in with capitalised labels using the <code>axis()</code> function. How did I know where to put the labels (at=c(2,5))? I’m afraid I guessed on the basis of past experience…</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="yeast-sexual-selection.html#cb42-1"></a><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>),<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;One&quot;</span>,<span class="st">&quot;Two&quot;</span>),<span class="dt">font=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Finally use <code>arrows()</code> to draw the positive and negative error bars</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="yeast-sexual-selection.html#cb43-1"></a><span class="kw">arrows</span>(locations,yeast.mat,locations,yeast.mat<span class="op">+</span>yeast<span class="fl">.95</span>s,<span class="dt">angle=</span><span class="dv">90</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb43-2"><a href="yeast-sexual-selection.html#cb43-2"></a></span>
<span id="cb43-3"><a href="yeast-sexual-selection.html#cb43-3"></a><span class="kw">arrows</span>(locations,yeast.mat,locations,yeast.mat<span class="op">-</span>yeast<span class="fl">.95</span>s,<span class="dt">angle=</span><span class="dv">90</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure"><span id="fig:anova10"></span>
<img src="3rd_Edition_files/figure-html/anova10-1.png" alt="Barplot showing means and 95% confidence intervals of fitness for each of the four yeast strains." width="672" />
<p class="caption">
Figure 17.4: Barplot showing means and 95% confidence intervals of fitness for each of the four yeast strains.
</p>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Smith, C. and Greig, D., (2010) The Cost of Sexual Signalling in Yeast, Evolution 64, 3114-3122<a href="yeast-sexual-selection.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="yeast-sex-and-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-linear-regression-to-analyse-tb-trends-in-the-uk.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["3rd_Edition.pdf", "3rd_Edition.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
